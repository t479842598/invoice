import{ai as b,aT as c,aF as A,c as y,a as C,W as o,bD as s,bF as I,H as M,aX as u,aY as L,o as m,bi as w,U as z,b9 as D,I as W}from"./_@vue-5ba92de9.js";const X={class:"roadui_page"},J=["onClick"],K={key:1},Q={class:"roadui_pagerdiv"},ae={__name:"read",setup(Z){const V=b("ajax"),n=b("utils"),x=b("qs"),U=b("index_openmenu"),r=c(!1),h=c(!1),i=c({}),p=c([]);let _=[];const S=c([]),N=c({prop:"groupid",order:"descending"}),a=c(n.getPager(N.value));A(()=>{g(!1)});const j=e=>{_=e},B=e=>{a.value.size=e,g(!1)},Y=e=>{a.value.number=e,g(!1)},P=e=>{a.value.order=n.getOrder(e),g(!1)},g=e=>{e&&(a.value.number=1),h.value=!0,r.value=!0,i.value.size=a.value.size,i.value.number=a.value.number,i.value.order=a.value.order,i.value.date1=n.length(p.value)>0?p.value[0]:"",i.value.date2=n.length(p.value)>1?p.value[1]:"",V.post("/Message/GetReadList",x.stringify(i.value)).then(t=>{S.value=t.data.rows,a.value.total=t.data.total,r.value=!1,h.value=!1}).catch(()=>{r.value=!1})},R=e=>{if(n.length(e.url)>0){let t="",v="",d="";switch(e.type){case 1:t=e.sourceTitle||"流程任务",v="message_task_"+e.id,d="Edit";break;default:t=n.length(e.sourceTitle)>0?e.sourceTitle:e.contents,v="message_task_"+n.createGuid(!1),d="";break}const k={title:t,id:v,url:e.url,ico:d,openMode:0};U(k)}},O=()=>{if(_.length===0){n.msg("您没有选择要删除的消息！",!1);return}n.confirm("您确定要删除所选消息吗？",()=>{r.value=!0,V.post("Message/Delete?type=1",x.stringify({ids:n.getArrayValues(_,"id").join(",")})).then(e=>{let t=e.msg;n.length(t)===0&&(t=e.success?"删除成功！":"删除失败！"),n.msg(t,e.success),r.value=!1,e.success&&(_=[],g(!1))}).catch(()=>{r.value=!1})})};return(e,t)=>{const v=u("el-input"),d=u("el-form-item"),k=u("el-date-picker"),T=u("el-button"),$=u("el-form"),f=u("el-table-column"),q=u("el-tag"),E=u("el-tooltip"),F=u("el-table"),G=u("el-pagination"),H=L("loading");return m(),y("div",X,[C("div",null,[o($,{inline:!0},{default:s(()=>[o(d,{label:"内容"},{default:s(()=>[o(v,{modelValue:i.value.contents,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value.contents=l),style:{width:"200px"},placeholder:"消息内容",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"日期"},{default:s(()=>[o(k,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l),style:{width:"220px"},type:"daterange","value-format":"YYYY-MM-DD","unlink-panels":"","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:w(n).dateShortucts},null,8,["modelValue","shortcuts"])]),_:1}),o(d,null,{default:s(()=>[o(T,{type:"primary",disabled:r.value,onClick:t[2]||(t[2]=l=>g(!0))},{default:s(()=>[z("查询")]),_:1},8,["disabled"]),o(T,{type:"danger",disabled:r.value,onClick:t[3]||(t[3]=l=>O())},{default:s(()=>[z("删除")]),_:1},8,["disabled"])]),_:1})]),_:1})]),C("div",null,[I((m(),M(F,{data:S.value,stripe:a.value.tableStripe,border:a.value.tableBorder,style:{width:"100%"},"highlight-current-row":a.value.tableHighlightCurrentRow,"default-sort":N.value,onSortChange:P,onSelectionChange:j},{default:s(()=>[o(f,{type:"selection",width:"45"}),o(f,{prop:"contents",label:"消息内容",sortable:"custom"},{default:s(l=>[w(n).length(l.row.url)>0?(m(),y("a",{key:0,class:"roaduia",href:"javascript:;",onClick:ee=>R(l.row)},D(l.row.contents),9,J)):(m(),y("span",K,D(l.row.contents),1))]),_:1}),o(f,{prop:"sendTime",label:"接收时间",sortable:"custom",width:"150"}),o(f,{prop:"senderName",label:"发送人",sortable:"custom",width:"120"},{default:s(l=>[w(n).length(l.row.senderName)>0?(m(),M(E,{key:0,placement:"left",content:l.row.senderOrganize},{default:s(()=>[o(q,null,{default:s(()=>[z(D(l.row.senderName),1)]),_:2},1024)]),_:2},1032,["content"])):W("",!0)]),_:1})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[H,h.value]]),C("div",Q,[o(G,{currentPage:a.value.number,"onUpdate:currentPage":t[4]||(t[4]=l=>a.value.number=l),"page-size":a.value.size,"onUpdate:pageSize":t[5]||(t[5]=l=>a.value.size=l),"page-sizes":a.value.sizes,background:a.value.background,layout:a.value.layout,total:a.value.total,disabled:r.value,onSizeChange:B,onCurrentChange:Y},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])])])])}}};export{ae as default};
