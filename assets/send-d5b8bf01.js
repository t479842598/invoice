import{ai as d,aT as i,c as w,W as e,bD as a,aX as u,o as q,bi as j,U as p}from"./_@vue-5ba92de9.js";const D={style:{margin:"20px 0 0 20px"}},C={__name:"send",setup(R){const b=d("ajax"),f=d("utils"),g=d("qs"),y=d("ElSelectorg"),c=i(!1),l=i({receiver:"",sendType:[0]}),_=i(null),v=i(null),x={receiver:[{required:!0,message:"请选择接收人",trigger:"blur"}],sendType:[{required:!0,message:"请选择发送方式",trigger:"change"}],contents:[{required:!0,message:"请输入消息内容",trigger:"blur"}]},k=async m=>{m&&await m.validate(t=>{if(t){c.value=!0;const n={receiver:l.value.receiver,sendType:l.value.sendType.join(","),contents:l.value.contents};b.post("/Message/Send",g.stringify(n)).then(o=>{let s=o.msg;if(f.length(s)===0)switch(o.code){case 1:s="消息内容不能为空！";break;case 2:s="消息接收人员不能为空！";break;default:s=o.success?"发送成功！":"发送失败！";break}f.msg(s,o.success),o.success&&(l.value={receiver:"",sendType:[0]},v.value.initTitle("")),c.value=!1}).catch(()=>{c.value=!1})}})};return(m,t)=>{const n=u("el-form-item"),o=u("el-checkbox"),s=u("el-checkbox-group"),T=u("el-input"),V=u("el-button"),h=u("el-form");return q(),w("div",D,[e(h,{model:l.value,ref_key:"ruleFormRef",ref:_,rules:x,"label-width":"80px"},{default:a(()=>[e(n,{label:"接收人员",prop:"receiver"},{default:a(()=>[e(j(y),{ref_key:"receiverRef",ref:v,modelValue:l.value.receiver,"onUpdate:modelValue":t[0]||(t[0]=r=>l.value.receiver=r),style:{width:"100%"},clearable:""},null,8,["modelValue"])]),_:1}),e(n,{label:"发送方式",prop:"sendType"},{default:a(()=>[e(s,{modelValue:l.value.sendType,"onUpdate:modelValue":t[1]||(t[1]=r=>l.value.sendType=r)},{default:a(()=>[e(o,{label:0},{default:a(()=>[p("站内消息")]),_:1}),e(o,{label:1},{default:a(()=>[p("手机短信")]),_:1}),e(o,{label:2},{default:a(()=>[p("企业微信")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"消息内容",prop:"contents"},{default:a(()=>[e(T,{type:"textarea",modelValue:l.value.contents,"onUpdate:modelValue":t[2]||(t[2]=r=>l.value.contents=r),style:{width:"100%"},rows:5,clearable:""},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(V,{type:"primary",disabled:c.value,onClick:t[3]||(t[3]=r=>k(_.value))},{default:a(()=>[p("发送")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}};export{C as default};
