import{ai as v,aT as y,aF as G,c as Q,W as e,bD as l,a as g,aX as u,o as R,U as d}from"./_@vue-5ba92de9.js";const L={style:{"margin-left":"20px"}},O={style:{"margin-left":"12px"}},P={style:{"text-align":"center",width:"100%"}},X={__name:"subjectadd",props:{query:{type:String,default:()=>""}},setup(S){const j=v("ajax"),n=v("utils"),T=v("qs"),M=v("questionnaire_subject"),_=S,k=n.query("questionnaireid",_.query),w=n.query("subjectid",_.query),p=y(!1),o=y({subjectTitle:"",subjectMode:1,options:[],sort:parseInt(n.query("sort",_.query))||5}),q=y(null),C={subjectTitle:[{required:!0,message:"请输入选题标题",trigger:"blur"}]},x=y(n.getPager({}));G(()=>{D()});const D=()=>{n.length(w)>0&&(p.value=!0,j.post("/Questionnaire/GetSubject?subjectid="+w).then(i=>{if(i.code==1){n.msg("加载选题错误！",i.success);return}o.value=i.data,p.value=!1}).catch(()=>{p.value=!1}))},B=()=>{o.value.options.push({id:n.createGuid(!1),optionTitle:"",optionMode:0,optionStyle:"",sort:n.getArrayMax(o.value.options,"sort")+5})},$=i=>{n.removeArrayObj(o.value.options,i.id,"id")},z=async i=>{i&&await i.validate(a=>{a&&(p.value=!0,j.post("/Questionnaire/SaveSubject"+_.query+"&optionsize="+o.value.options.length,T.stringify(o.value)).then(s=>{p.value=!1;let r=s.msg;n.length(r)===0&&(s.success?r="保存成功！":s.code==1?r="数据验证错误！":r="保存失败！"),n.msg(r,s.success),s.success&&h()}).catch(()=>{p.value=!1}))})},h=()=>{M({id:k})};return(i,a)=>{const s=u("el-input"),r=u("el-form-item"),b=u("el-radio"),A=u("el-radio-group"),U=u("el-input-number"),c=u("el-table-column"),V=u("el-option"),F=u("el-select"),f=u("el-button"),I=u("el-table"),N=u("el-form");return R(),Q("div",null,[e(N,{model:o.value,ref_key:"ruleFormRef",ref:q,rules:C,"label-width":"80px"},{default:l(()=>[e(r,{label:"选题标题",prop:"subjectTitle"},{default:l(()=>[e(s,{modelValue:o.value.subjectTitle,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value.subjectTitle=t),clearable:""},null,8,["modelValue"])]),_:1}),e(r,{label:"选择方式",prop:"subjectMode"},{default:l(()=>[e(A,{modelValue:o.value.subjectMode,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.subjectMode=t)},{default:l(()=>[e(b,{label:1},{default:l(()=>[d("单选")]),_:1}),e(b,{label:2},{default:l(()=>[d("多选")]),_:1}),e(b,{label:3},{default:l(()=>[d("文本框")]),_:1}),e(b,{label:4},{default:l(()=>[d("文本域")]),_:1})]),_:1},8,["modelValue"]),g("span",L,[d(" 样式"),e(s,{placeholder:"选题样式",modelValue:o.value.subjectStyle,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.subjectStyle=t),style:{width:"351px","margin-left":"12px"}},null,8,["modelValue"])]),g("span",O,[d(" 排序"),e(U,{step:5,min:0,modelValue:o.value.sort,"onUpdate:modelValue":a[3]||(a[3]=t=>o.value.sort=t),style:{width:"120px","margin-left":"12px"}},null,8,["modelValue"])])]),_:1}),e(r,{"label-width":"0"},{default:l(()=>[e(I,{data:o.value.options,stripe:x.value.tableStripe,border:x.value.tableBorder,style:{width:"100%"}},{default:l(()=>[e(c,{prop:"optionTitle",label:"选项标题"},{default:l(t=>[e(s,{modelValue:t.row.optionTitle,"onUpdate:modelValue":m=>t.row.optionTitle=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{prop:"optionMode",label:"输入",width:"130"},{default:l(t=>[e(F,{modelValue:t.row.optionMode,"onUpdate:modelValue":m=>t.row.optionMode=m,style:{width:"100%"}},{default:l(()=>[e(V,{value:0,label:"无"}),e(V,{value:1,label:"文本框"}),e(V,{value:2,label:"文本域"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{prop:"optionStyle",label:"样式",width:"190"},{default:l(t=>[e(s,{modelValue:t.row.optionStyle,"onUpdate:modelValue":m=>t.row.optionStyle=m},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{prop:"sort",label:"排序",width:"120"},{default:l(t=>[e(U,{step:5,min:0,"controls-position":"right",modelValue:t.row.sort,"onUpdate:modelValue":m=>t.row.sort=m,style:{width:"100%"}},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(c,{width:"75"},{header:l(()=>[e(f,{size:"small",type:"primary",onClick:a[4]||(a[4]=t=>B())},{default:l(()=>[d("添加")]),_:1})]),default:l(t=>[e(f,{size:"small",type:"primary",onClick:m=>$(t.row)},{default:l(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","stripe","border"])]),_:1})]),_:1},8,["model"]),g("div",P,[e(f,{disabled:p.value,type:"primary",onClick:a[5]||(a[5]=t=>z(q.value))},{default:l(()=>[d("保存")]),_:1},8,["disabled"]),e(f,{disabled:p.value,onClick:a[6]||(a[6]=t=>h())},{default:l(()=>[d("返回")]),_:1},8,["disabled"])])])}}};export{X as default};
