import{E as y}from"./_element-plus-8c7ce171.js";import{d as $,ai as d,aT as p,aF as K,c as b,W as e,bD as o,bF as Q,H as D,A as Z,aX as s,aY as ee,o as c,U as v,F as S,aV as T,b9 as te}from"./_@vue-5ba92de9.js";import{_ as le}from"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_@popperjs-c75af06c.js";import"./_crypto-js-0812dcff.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";const ae=$({__name:"MaintenanceAdd",props:{query:{type:String,default:()=>""},modelValue:{type:Boolean,default:!1},id:{type:String,default:""}},emits:["update:id"],setup(A,{emit:F}){const m=d("ajax"),V=d("utils");d("config");const _=d("qs"),g=p("账套信息"),M=p(!1),x=p([]);d("index_openmenu"),d("index_removetab");const B=d("index_refreshtab"),E=F,N=A;function j(n){return Z({get:()=>N[n],set:t=>{E(`update:${n}`,t)}})}const w=j("id");K(async()=>{await I(),await G()});const a=p({accountcode:"",accountname:"",taxno:"",address:"",phone:"",openbank:"",bankaccount:"",type:"",remarks:"",url:"",status:"",erptype:""}),q=[{label:"单位名称",model:"accountname",type:"",auto:!1},{label:"纳税人识别号",model:"taxno",type:"",auto:!1},{label:"开户银行",model:"openbank",type:"",auto:!1},{label:"银行账号",model:"bankaccount",type:"",auto:!1},{label:"单位地址",model:"address",type:"textarea",auto:!0},{label:"联系电话",model:"phone",type:"",auto:!1},{label:"联系邮箱",model:"email",type:"",auto:!1}],z={},G=()=>{m.post("/DbConnection/GetDbConnTypeOptions").then(n=>{x.value=n.data}).catch(()=>{})},k=p(),O=()=>{k.value=a.value.url,R(k.value)},R=n=>{m.post("/cn_account/TestConn",_.stringify({connid:w.value,type:a.value.type,url:n})).then(t=>{t.success?y.success(t.msg):y.error(t.msg)}).catch(t=>{y.error(t.msg)})},I=async()=>{try{const n=await m.post("/SystemAccount/Get",_.stringify({id:w.value}));a.value=n.data.customer}catch{}},J=async()=>{try{const n=await m.post("/SystemAccount/Save",_.stringify({customerJSON:JSON.stringify(a.value)})),t=n.success?"success":"error";V.msg(n.msg,t,!1),n.success&&B()}catch{V.msg("保存数据时出现错误","error",!1)}};return(n,t)=>{const U=s("el-button"),u=s("el-form-item"),f=s("el-form"),r=s("el-input"),P=s("el-radio"),H=s("el-radio-group"),i=s("el-option"),h=s("el-select"),C=s("el-tab-pane"),L=s("el-tabs"),W=ee("loading");return c(),b("div",null,[e(f,{ref:"formbutton",class:"formbutton",inline:""},{default:o(()=>[e(u,null,{default:o(()=>[e(U,{type:"primary",onClick:J},{default:o(()=>[v("保存")]),_:1})]),_:1})]),_:1},512),Q((c(),D(L,{modelValue:g.value,"onUpdate:modelValue":t[7]||(t[7]=l=>g.value=l),type:"card","element-loading-text":"正在保存，请稍等..."},{default:o(()=>[e(C,{label:"账套信息",name:"账套信息"},{default:o(()=>[e(f,{model:a.value,ref:"ruleFormRef",rules:z,"label-width":"100px"},{default:o(()=>[e(u,{label:"账套编号",prop:"accountcode"},{default:o(()=>[e(r,{modelValue:a.value.accountcode,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.accountcode=l),clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(u,{label:"账套名称",prop:"accountname"},{default:o(()=>[e(r,{modelValue:a.value.accountname,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.accountname=l),clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(u,{label:"连接类型",prop:"type"},{default:o(()=>[e(H,{modelValue:a.value.type,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.type=l)},{default:o(()=>[(c(!0),b(S,null,T(x.value,l=>(c(),D(P,{key:l.value,label:l.title},{default:o(()=>[v(te(l.title),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{class:"url",label:"连接字符串",prop:"url"},{default:o(()=>[e(r,{modelValue:a.value.url,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.url=l),autosize:{minRows:2},type:"textarea",clearable:""},null,8,["modelValue"]),e(U,{type:"primary",onClick:O},{default:o(()=>[v("测试连接")]),_:1})]),_:1}),e(u,{label:"状态",prop:"status",style:{width:"100%"}},{default:o(()=>[e(h,{modelValue:a.value.status,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.status=l),placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[e(i,{label:"未启用",value:"未启用"}),e(i,{label:"启用",value:"启用"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"ERP类型",prop:"erptype",style:{width:"100%"}},{default:o(()=>[e(h,{modelValue:a.value.erptype,"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.erptype=l),placeholder:"请选择",style:{width:"100%"}},{default:o(()=>[e(i,{label:"T3",value:"T3"}),e(i,{label:"U8",value:"U8"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"备注",prop:"remarks"},{default:o(()=>[e(r,{modelValue:a.value.remarks,"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.remarks=l),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(C,{label:"基本信息",name:"基本信息"},{default:o(()=>[e(f,{model:a.value,class:"inline","label-width":"140px"},{default:o(()=>[(c(),b(S,null,T(q,(l,X)=>e(u,{key:X,label:l.label},{default:o(()=>[e(r,{autosize:l.auto,type:l.type,style:{width:"300px"},modelValue:a.value[l.model],"onUpdate:modelValue":Y=>a.value[l.model]=Y},null,8,["autosize","type","modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])),64))]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])),[[W,M.value]])])}}});const _e=le(ae,[["__scopeId","data-v-0a42d176"]]);export{_e as default};
