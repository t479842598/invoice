import{ai as a,aT as q,aF as w,c as B,a as u,W as c,bD as p,bi as v,aX as y,o as D,U as S}from"./_@vue-5ba92de9.js";const N={style:{padding:"10px 0"}},V={cellpadding:"0",cellspacing:"0",border:"0",style:{width:"100%"}},k={style:{"padding-top":"40px"}},M={__name:"sign",props:{query:{type:String,default:()=>""}},setup(x){const f=a("ajax"),e=a("utils"),m=a("qs"),b=a("config"),j=a("ElUsersign"),o=a("index_userinfo"),r=q(""),E=x,t=e.query("userid",E.query),g=e.length(t)>0?a("user_info"):null,_=e.length(t)>0?a("user_dialogsignshow"):null,h=e.length(t)>0?a("user_loadformdata"):null;w(()=>{d()});const d=()=>{e.length(t)>0?r.value=e.length(g.value.sign)>0?g.value.sign:g.value.name:r.value=e.length(o.value.signImg)>0?o.value.signImg:o.value.userName},I=(s,l)=>{const n=new FileReader;n.addEventListener("load",()=>l(n.result)),n.readAsDataURL(s)},R=s=>s.type!=="image/jpeg"&&s.type!=="image/png"&&s.type!=="image/gif"?(e.msg("签章必须是图片格式!",!1),!1):s.size/1024/1024>2?(e.msg("上传的图片文件不能大于2M!",!1),!1):!0,A=(s,l)=>{I(l.raw,n=>{f.post("/User/"+(e.length(t)>0?"SaveSignAdmin":"SaveSign"),m.stringify({img:n,userId:t})).then(i=>{e.msg(i.success?"保存成功！":"保存失败！",i.success),i.success&&(e.length(t)>0?(h(),_.value=!1):(o.value.signImg=n,d()))}).catch(()=>{})})},U=()=>{f.post("/User/"+(e.length(t)>0?"ResetSignAdmin":"ResetSign"),m.stringify({userId:t})).then(s=>{e.msg(s.success?"恢复成功！":"恢复失败！",s.success),s.success&&(e.length(t)>0?(h(),_.value=!1):(o.value.signImg="",d()))}).catch(()=>{})};return(s,l)=>{const n=y("el-button"),i=y("el-upload");return D(),B("div",N,[u("table",V,[u("tr",null,[u("td",null,[c(i,{action:v(b).SERVER_WEBADDRESS+"/Files/SaveFiles","show-file-list":!1,"with-credentials":"",accept:".jpg,.jpeg,.png,.gif",data:{filetype:".jpg,.jpeg,.png,.gif",uploadtype:0},"on-success":A,"before-upload":R},{default:p(()=>[c(n,{type:"primary"},{default:p(()=>[S("上传")]),_:1})]),_:1},8,["action","data"]),c(n,{type:"primary",onClick:l[0]||(l[0]=C=>U()),style:{"margin-left":"14px"}},{default:p(()=>[S("恢复默认")]),_:1})])]),u("tr",null,[u("td",k,[c(v(j),{sign:r.value},null,8,["sign"])])])])])}}};export{M as default};
