import{ai as _,aT as d,aF as O,c as $,a as b,W as o,bD as n,bF as A,H as h,aX as r,aY as E,o as m,bi as V,U as p,ay as G,b9 as L,I as W}from"./_@vue-5ba92de9.js";const X={class:"roadui_page"},J=["onClick"],K={class:"roadui_pagerdiv"},ae={__name:"deleted",setup(Q){const k=_("ajax"),s=_("utils"),D=_("qs"),x=_("index_openmenu"),i=d({}),c=d([]),u=d(!1),y=d(!1),S=d([]);let g=[];const z=d({prop:"id",order:"descending"}),e=d(s.getPager(z.value));O(()=>{v(!1)});const M=a=>{g=a},B=a=>{e.value.size=a,v(!1)},T=a=>{e.value.number=a,v(!1)},U=a=>{e.value.order=s.getOrder(a),v(!1)},v=a=>{a&&(e.value.number=1),y.value=!0,u.value=!0,i.value.size=e.value.size,i.value.number=e.value.number,i.value.order=e.value.order,i.value.date1=s.length(c.value)>0?c.value[0]:"",i.value.date2=s.length(c.value)>1?c.value[1]:"",k.post("/Mail/GetDeletedList",D.stringify(i.value)).then(t=>{S.value=t.data.rows,e.value.total=t.data.total,u.value=!1,y.value=!1}).catch(()=>{u.value=!1})},Y=()=>{if(g.length===0){s.msg("请选择要彻底删除的邮件！","error");return}s.confirm("您确定要彻底删除所选邮件吗？",()=>{u.value=!0,k.post("/Mail/DeleteDeleted",D.stringify({ids:s.getArrayValues(g,"id").join(",")})).then(a=>{let t=a.msg;s.length(t)===0&&(t=a.success?"删除成功！":"删除失败！"),s.msg(t,a.success),u.value=!1,a.success&&(g=[],v(!1))}).catch(()=>{u.value=!1})})},N=a=>{const t={title:a.mailSubject,id:"mail_view_"+a.id,url:"/system/mail/view?id="+a.id+"&source=deleted",ico:"Message",openMode:0};x(t)};return(a,t)=>{const P=r("el-input"),w=r("el-form-item"),R=r("el-date-picker"),j=r("el-button"),q=r("el-form"),f=r("el-table-column"),C=r("el-tag"),F=r("el-table"),H=r("el-pagination"),I=E("loading");return m(),$("div",X,[b("div",null,[o(q,{inline:!0},{default:n(()=>[o(w,{label:"主题"},{default:n(()=>[o(P,{modelValue:i.value.mailSubject,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value.mailSubject=l),style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),o(w,{label:"日期"},{default:n(()=>[o(R,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=l=>c.value=l),style:{width:"220px"},type:"daterange","value-format":"YYYY-MM-DD","unlink-panels":"","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:V(s).dateShortucts},null,8,["modelValue","shortcuts"])]),_:1}),o(w,null,{default:n(()=>[o(j,{type:"primary",disabled:u.value,onClick:t[2]||(t[2]=l=>v(!0))},{default:n(()=>[p("查询")]),_:1},8,["disabled"]),o(j,{type:"danger",disabled:u.value,onClick:Y},{default:n(()=>[p("彻底删除")]),_:1},8,["disabled"])]),_:1})]),_:1})]),b("div",null,[A((m(),h(F,{data:S.value,stripe:e.value.tableStripe,border:e.value.tableBorder,style:{width:"100%"},"highlight-current-row":e.value.tableHighlightCurrentRow,"default-sort":z.value,onSortChange:U,onSelectionChange:M},{default:n(()=>[o(f,{type:"selection",width:"45"}),o(f,{prop:"mailSubject",label:"主题",sortable:"custom","show-overflow-tooltip":""},{default:n(l=>[b("a",{class:"roaduia",href:"javascript:;",onClick:Z=>N(l.row),style:G(V(s).length(l.row.subjectColor)>0?"color:"+l.row.subjectColor:"")},L(l.row.mailSubject),13,J)]),_:1}),o(f,{prop:"senderId",label:"来源",width:"100",sortable:"custom"},{default:n(l=>[l.row.type===1?(m(),h(C,{key:0,effect:"dark"},{default:n(()=>[p("发件箱")]),_:1})):l.row.type===2?(m(),h(C,{key:1,effect:"dark",type:"success"},{default:n(()=>[p("收件箱")]),_:1})):l.row.type===3?(m(),h(C,{key:2,effect:"dark",type:"info"},{default:n(()=>[p("草稿箱")]),_:1})):W("",!0)]),_:1}),o(f,{prop:"mailTime",label:"日期",width:"180",sortable:"custom"})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[I,y.value]])]),b("div",K,[o(H,{currentPage:e.value.number,"onUpdate:currentPage":t[3]||(t[3]=l=>e.value.number=l),"page-size":e.value.size,"onUpdate:pageSize":t[4]||(t[4]=l=>e.value.size=l),"page-sizes":e.value.sizes,background:e.value.background,layout:e.value.layout,total:e.value.total,disabled:u.value,onSizeChange:B,onCurrentChange:T},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])])])}}};export{ae as default};
