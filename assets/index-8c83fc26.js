import _sfc_main$1 from"./signpassword-4eea2da9.js";import _sfc_main$2 from"./send-40a38f7b.js";import _sfc_main$3 from"./back-b4b7187d.js";import _sfc_main$6 from"./sethandler-b58af52c.js";import _sfc_main$b from"./addwrite-c60b3d20.js";import _sfc_main$9 from"./solicitopinions-20dc0a72.js";import _sfc_main$8 from"./copyfor-f407cd89.js";import _sfc_main$a from"./redirect-558725cc.js";import _sfc_main$5 from"./chart-28c2d9ac.js";import _sfc_main$4 from"./process-d4bb3c31.js";import _sfc_main$7 from"./urge-b4867d68.js";import"./_jquery-3a83ed9f.js";import{bP as dayjs}from"./__vendor-5e6ac033.js";import{a as ElMessageBox}from"./_element-plus-8c7ce171.js";import{aT as ref,ai as inject,aF as onMounted,av as nextTick,aK as onUnmounted,b5 as shallowRef,bF as withDirectives,c as createElementBlock,a as createBaseVNode,bi as unref,F as Fragment,aV as renderList,I as createCommentVNode,W as createVNode,bD as withCtx,H as createBlock,b9 as toDisplayString,aZ as resolveDynamicComponent,ay as normalizeStyle,aw as normalizeClass,aN as provide,aX as resolveComponent,aY as resolveDirective,o as openBlock,U as createTextVNode}from"./_@vue-5ba92de9.js";import"./flow-show-9c68805e.js";import"./_raphael-a934d412.js";import"./_@element-plus-ad4c9002.js";import"./_@popperjs-c75af06c.js";const _hoisted_1=["element-loading-text"],_hoisted_2={key:0,class:"roadui_noprint"},_hoisted_3={key:0},_hoisted_4={class:"roadui_toolbar"},_hoisted_5=["onClick","disabled"],_hoisted_6={key:1},_hoisted_7={key:1,style:{margin:"15px 0 0 0"}},_hoisted_8={key:0,class:"roadui_flowrunstepnote"},_hoisted_9={key:1,class:"roadui_flowrunstepnote"},_hoisted_10={style:{"padding-top":"12px"}},_hoisted_11=["src"],_hoisted_12={style:{"margin-top":"20px"}},_hoisted_13={key:0},_hoisted_14={style:{"margin-right":"18px"}},_hoisted_15={style:{"margin-top":"10px"}},_hoisted_16={style:{"margin-top":"10px"}},_hoisted_17={key:1},_hoisted_18={style:{"margin-top":"12px"}},_hoisted_19={style:{"margin-right":"12px"}},_hoisted_20={key:0,style:{"margin-top":"12px"}},_hoisted_21=createBaseVNode("span",{style:{"margin-right":"12px"}},"附件",-1),_hoisted_22={key:0,class:"roadui_noprint",style:{"border-top":"1px solid var(--el-border-color-light)"}},_hoisted_23={key:0,style:{padding:"12px 0 0 0","text-align":"center"}},_hoisted_24={key:1,style:{padding:"12px 0 0 0","text-align":"center","white-space":"nowrap"}},_hoisted_25=createBaseVNode("span",null,null,-1),_hoisted_26={key:1,style:{"text-align":"center","padding-bottom":"8px"}},_sfc_main={__name:"index",props:{query:{type:String,default:()=>""}},emits:["index"],setup(__props,{emit:__emit}){const emits=__emit;ref(!1);const ajax=inject("ajax"),utils=inject("utils"),app=inject("app"),sysConfig=inject("config"),qs=inject("qs");ref(null);const ElSelectdict=inject("ElSelectdict"),ElSelectorg=inject("ElSelectorg"),ElSelectfile=inject("ElSelectfile"),ElCkeditor=inject("ElCkeditor"),ElUsersign=inject("ElUsersign"),ElSelectdiv=inject("ElSelectdiv"),index_openmenu=inject("index_openmenu"),index_removetab=inject("index_removetab"),index_refreshtab=inject("index_refreshtab"),index_dialogshow=inject("index_dialogshow"),index_dialogcomponentId=inject("index_dialogcomponentId"),index_dialogcomponentquery=inject("index_dialogcomponentquery"),index_regcomponent=inject("index_regcomponent"),index_userinfo=inject("index_userinfo"),props=__props,formHeight=ref("500px");var programId=utils.query("programid",props.query),formId=utils.query("formid",props.query),isPreview=utils.query("ispreview",props.query)==="1";const programrun_programcomponentref=utils.length(utils.query("programid",props.query))>0?inject("programrun_programcomponentref"):ref(null);var openMode=utils.query("openmode",props.query)||"0",isMobile=utils.query("ismobile",props.query),isApp=utils.query("isapp",props.query),isMiniProgram=utils.query("isminiprogram",props.query),isEmail=utils.query("isemail",props.query);const indexm_openurl=isMobile=="1"&&isApp!="1"?inject("indexm_openurl"):null,indexm_refreshpage=isMobile=="1"&&isApp!="1"?inject("indexm_refreshpage"):null,indexm_backpage=isMobile=="1"&&isApp!="1"?inject("indexm_backpage"):null,index_themeset=inject("index_themeset"),dropdown_mobilebuttons=ref(null),sobInfo=ref("");localStorage.getItem("sobInfo")!=""&&(sobInfo.value=JSON.parse(localStorage.getItem("sobInfo")));const id=ref("");id.value=localStorage.getItem("formid"),onMounted(()=>{nextTick(()=>{loadRun()})}),onUnmounted(()=>{window.removeEventListener("resize",computeFormHeight,!1)});const istj=ref(""),FristStepId=ref(""),queryString="?"+utils.getQuery(props.query),loading=ref(!1),loadingText=ref(""),butDisabled=ref(!1),flowId=utils.query("flowid",props.query),stepId=utils.query("stepid",props.query),taskId=utils.query("taskid",props.query),groupId=utils.query("groupid",props.query),instanceId=utils.query("instanceid",props.query),roadComponentFormRef=ref(null),buttons=ref([]),buttonsMobile=ref([]),buttonsMobileMore=ref([]),step=ref({}),form=ref({}),formComponentId=ref(null),formComponentQuery=ref(""),formDisplay=utils.query("display",props.query),dialogShow=ref(!1),dialogTitle=ref(""),dialogWidth=ref(""),dialogPage=shallowRef(null),dialogQuery=ref(""),dialogClass=ref(""),dialogCenter=ref(!0),computeFormHeight=()=>{if(utils.length(programId)>0){let l=utils.query("programmodalheight",props.query);formHeight.value=utils.length(l)>0&&l>0?l+"px":"auto";return}let e=isMobile=="1"?105:155;step.value.signType>0&&(step.value.display==0||step.value.display==4)&&(e+=46),isPreview&&(e-=105),index_themeset.value.homeType===1&&(e-=46),formHeight.value=window.document.body.offsetHeight-e+"px"},loadRun=()=>{loading.value=!0,ajax.post("/Flow/GetRun"+queryString).then(e=>{if(e.success){if(FristStepId.value=e.data.FristStepId,utils.length(e.data.form)>0)switch(e.data.form.type){case 0:initFormData(e.data),regFormComponent(e.data);break;case 1:initFormData(e.data);let l=e.data.form.address.split("?"),o=l[0],r=l.length>1?l[1]:"",i="formrun-"+utils.createGuid(!1);index_regcomponent(i,o),formComponentId.value=i,formComponentQuery.value=r;break}if(buttons.value=e.data.buttons,buttonsMobile.value=utils.spliceArrayObj([...e.data.buttons],utils.emptyLong+"","id"),buttonsMobile.value.length>2){for(var t=3;t<buttonsMobile.value.length;t++)buttonsMobileMore.value.push(buttonsMobile.value[t]);buttonsMobile.value=buttonsMobile.value.slice(0,3)}step.value=e.data.step,form.value=e.data.form}else{let l=e.msg;if(utils.length(l)===0)switch(e.code){case 1:l="未找到流程运行时！";break;case 2:l="未找到流程步骤运行时！";break;case 3:l="当前任务正由"+e.data+"处理，请等待！";break;case 4:l="您无权查看当前任务！";break;case 5:l="当前流程"+utils.getFlowStatusTitle(parseInt(e.data))+"不能发起新的实例！";break;case 6:l="未找到用户登录信息！";break;case 7:l="未找到当前任务！";break}utils.alert(l||"加载错误！","","","error",()=>{index_removetab()})}loading.value=!1,computeFormHeight(),window.addEventListener("resize",computeFormHeight,!1)}).catch(()=>{})},execScript=(script,disabledButton)=>{if(utils.length(script)!==0){disabledButton&&(butDisabled.value=!0);try{eval(script),butDisabled.value=!1}catch(e){butDisabled.value=!1}}},initFormData=e=>{for(var t in e.form.formDefaultValues)utils.startWith(t,"subtable_")||(!utils.hasKey(e.form.formData,t)||utils.isUndef(e.form.formData[t]))&&(e.form.formData[t]=e.form.formDefaultValues[t]);e.form.formRules={},e.form.formRulesSubtable={};for(let l in e.step.fieldStatus){const o=e.step.fieldStatus[l].check;if(o>0)if(l.indexOf(".")<0){let r=l;if(e.form.type===1){let i=r.split("-");r=i.length>1?i[1]:i[0]}e.form.formRules[r]=[{required:o===2,message:"不能为空",trigger:"blur"}]}else e.form.formRulesSubtable[l]=[{required:o===2,message:"不能为空",trigger:"blur"}]}},regFormComponent=data=>{if(utils.length(data.form.html)===0)return;const componentId="formrun-"+utils.createGuid(!1),component={components:{"el-selectdict":ElSelectdict,"el-selectorg":ElSelectorg,"el-selectfile":ElSelectfile,"el-ckeditor":ElCkeditor,"el-usersign":ElUsersign,"el-selectdiv":ElSelectdiv},data(){return{formData:data.form.formData,formRules:data.form.formRules,formRulesSubtable:data.form.formRulesSubtable,formSelectOptions:data.form.formSelectOptions,formDefaultValues:data.form.formDefaultValues,formEvents:data.form.fromEvents,formFieldStatus:data.step.fieldStatus,formDisplay:data.step.display,formLabelPosition:"left",formSign:utils.length(data.step.signImg)>0?data.step.signImg:data.step.signName,isMobile:isMobile=="1",utils,roadflowFormRef:ref(null),subTablePagers:{},subTableLoading:!1}},mounted(){this.$nextTick(()=>{utils.length(data.form.script)>0&&eval(data.form.script)})},computed:{getFieldStatus(){return function(e){const t=this.formFieldStatus[e];if(formDisplay=="1"||formDisplay=="2"||this.formDisplay==1||this.formDisplay==2)return utils.isDef(t)&&t.status==2?2:1;if(utils.length(e)===0||utils.length(this.formFieldStatus)===0)return 0;const l=utils.isDef(t)?t.status:0;return(formDisplay>0||this.formDisplay>0)&&l==0?1:l}},getText(){return function(e){if(utils.length(e)===0)return"";const t=this.formData[e];return utils.isDef(t)?t:""}},getSubtableDisabled(){return function(e){if(this.formDisplay>0)return!0;if(utils.length(this.formFieldStatus)===0||utils.length(e)===0)return!1;let t=!1;for(let l in this.formFieldStatus){const o=l.indexOf(".")>0&&l.split(".")[0].toLowerCase()==e.toLowerCase();if(t||(t=o),o&&this.formFieldStatus[l].status==0)return!1}return t}},getSelectTitle(){return function(e,t){const l=this.formSelectOptions[e];if(utils.length(l)===0)return;let o=[],r=utils.isArray(t)?t:[t];for(let i=0;i<r.length;i++)for(let a=0;a<l.length;a++)l[a].value==r[i]&&o.push(l[a].label);return o.join("; ")}},getCascaderTitle(){return function(e,t){if(utils.isUndef(t))return"";const l=utils.getLevelArray(this.formSelectOptions[e],"children");let o=[];for(let r=0;r<t.length;r++){let i=utils.getArrayObj(l,t[r],"value");i!=null&&o.push(i.label)}return o.join(" / ")}},getDateTimeTitle(){return function(e,t,l){if(t==="undefined"&&(t=void 0),l==="undefined"&&(l=" - "),utils.isArray(e)){let o=e.length>0?e[0]:"",r=e.length>1?e[1]:"";return utils.length(t)>0&&(utils.length(o)>0&&(o=dayjs(o).format(t)),utils.length(r)>0&&(r=dayjs(r).format(t))),o+(l||" - ")+r}else return utils.length(t)>0&&utils.length(e)>0&&(e=dayjs(e).format(t)),e}},getSwitchTitle(){return function(e,t,l,o){return e===!0||utils.isDef(o)&&e===o?l||"开":t||"关"}}},methods:{execFormEvent(id,eventName,value,row){const eventObj=utils.getArrayObj(this.formEvents,id,"id");if(utils.isUndef(eventObj))return;const eventObj1=utils.getArrayObj(eventObj.events,eventName,"name");if(!(utils.isUndef(eventObj1)||utils.length(eventObj1.script)===0))try{eval(eventObj1.script)}catch(e){}},linkageAddChilds(e,t,l,o,r,i,a){const n=this.formData[e]||i||"";utils.length(n)!==0&&ajax.post("/Form/GetSelectChildOptions",qs.stringify({value:utils.aes(n),linkageDataSource:l,linkageText:utils.aes(o),sqlConnId:r})).then(u=>{a&&a.key?this.formSelectOptions[t+"_"+a.key]=u.data:this.formSelectOptions[t]=u.data}).catch(()=>{})},addSubtableRow(e,t){utils.isArray(this.formData[e])||(this.formData[e]=new Array);const l=this.formDefaultValues[e];if(utils.isDef(l)){let r={key:utils.createGuid(!1)};for(var o in l)if(utils.isString(l[o])){let i=utils.trim(l[o]);if(i.substr(0,1)=="["&&i.substr(i.length-1)=="]")try{r[o]=JSON.parse(i)}catch{r[o]=i}else r[o]=i}else r[o]=l[o];if(utils.isDef(t)){for(let i=0;i<this.formData[e].length;i++)if(this.formData[e][i].key==t.key){this.formData[e].splice(i+1,0,r);break}}else this.formData[e].push(r)}},insertSubtableRow(e,t){this.addSubtableRow(e,t)},delSubtableRow(e,t){utils.removeArrayObj(this.formData[e],t.key,"key")},getSummaries(e,t){const l=e.columns;let o="";for(let a=0;a<l.length;a++)if(l[a].className=="1"){o=l[a].labelClassName;break}const r=utils.length(o)>0&&utils.isDef(this.formData[o])?this.formData[o]:e.data;if(t){let a=[];if(l.length>0){let n=l[0].className.split(";");for(let u=0;u<n.length;u++){let d=n[u].split(","),f=d[0],m=d.length>1?d[1]:"";if(utils.length(f)===0)continue;let p=0;for(let g=0;g<r.length;g++)p=utils.accAdd(p,parseFloat(r[g][f])||0);a.push(m+": "+p)}}return["合计        "+a.join("        ")]}let i=[];for(let a=0;a<l.length;a++)if(l[a].className=="1"){let n=0;for(let u=0;u<r.length;u++)n=utils.accAdd(n,parseFloat(r[u][l[a].property])||0);i[a]=n}else(a===0||a===1)&&!utils.inArray(i,"合计")&&l[a].type!=="index"?i[a]="合计":i[a]="";return i},getSubtableSummaries(e){return this.getSummaries(e,!0)},handleSizeChange(e,t){let l=!utils.hasKey(this.subTablePagers,t)||utils.isUndef(this.subTablePagers[t])?1:this.subTablePagers[t].number||1;this.handleCurrentChange(l,t,e)},handleCurrentChange(e,t,l){this.subTableLoading=!0,(!utils.hasKey(this.subTablePagers,t)||utils.isUndef(this.subTablePagers[t]))&&(this.subTablePagers[t]={});const o=l||this.subTablePagers[t].size||10;if(this.subTablePagers[t].number=e,this.subTablePagers[t].size=o,e===1){this.subTablePagers[t].start=0,this.subTablePagers[t].end=o,this.subTableLoading=!1;return}this.subTablePagers[t].start=e*o-o,this.subTablePagers[t].end=e*o,this.subTableLoading=!1}},template:"<div>"+data.form.html+"</div>"};app.component(componentId,component),formComponentId.value=componentId},executeAfter=(e,t,l)=>{if(utils.length(programId)>0||utils.length(formId)>0){switch(utils.query("save",props.query).toLowerCase()||"close"){case"close":if(utils.isDef(programrun_programcomponentref)&&utils.isDef(programrun_programcomponentref.value))programrun_programcomponentref.value.dialogShow=!1,programrun_programcomponentref.value.loadData(!1);else switch(openMode){case"0":index_removetab();break;case"1":utils.isDef(index_dialogshow.value)&&(index_dialogshow.value=!1);break;case"2":case"3":window.close();break}break;case"refresh":switch(openMode){case"0":index_refreshtab();break;case"2":case"3":var o=window.location.href;window.location.href=o;break}break}return}if(e.code!=0||t==="Copyfor"||t==="Solicitopinion"||t==="AddWrite"&&utils.length(l.steps)>0&&l.steps[0].addWriteType==0)return;if(utils.isDef(index_refreshtab)&&index_refreshtab("Tab_Home"),utils.isDef(index_refreshtab)&&(index_refreshtab("170346575288606"),t==="Withdraw"&&index_refreshtab("170346576223936")),t==="Save"){if(e.nextTasks.length>0){const i=e.nextTasks[0];if(isMobile=="1"||isEmail=="1"||openMode=="3"||openMode=="2")window.setTimeout(function(){const a="/flow/run/index?flowid="+i.flowId+"&stepid="+i.stepId+"&taskid="+i.id+"&groupid="+i.groupId+"&instanceid="+i.instanceId+"&ismobile="+isMobile+"&isapp="+isApp+"&isemail="+isEmail+"&openmode="+openMode;window.location.href="?loadurl="+encodeURIComponent(a)+"&title="+encodeURIComponent(i.title)},100);else{const a="/flow/run/index?flowid="+i.flowId+"&stepid="+i.stepId+"&taskid="+i.id+"&groupid="+i.groupId+"&instanceid="+i.instanceId+"&ismobile="+isMobile+"&isapp="+isApp+"&isemail="+isEmail+"&openmode="+openMode;refresh(a)}}return}if(isMobile=="1"){if(isMiniProgram=="1"){window.setTimeout(function(){var i=window.location.href;window.location.href=i},100);return}if(isApp=="1"){uni.postMessage({data:{msg:"close"}});return}indexm_openurl(void 0,"/mobile/flow/todo.vue");return}if(isEmail=="1"||openMode=="3"||openMode=="2"){window.setTimeout(function(){var i=window.location.href;window.location.href=i},100);return}if(openMode=="1"){index_dialogshow.value=!1;return}openMode=="0"&&index_removetab();let r=index_userinfo.value.userId;if(utils.length(e.nextTasks)>0){let i=null;for(let a=0;a<e.nextTasks.length;a++)if(e.nextTasks[a].receiverId==r&&e.nextTasks[a].status==0){i=e.nextTasks[a];break}utils.isDef(i)&&index_openmenu({title:i.title,id:"task_"+i.id,url:"/flow/run/index?flowid="+i.flowId+"&stepid="+i.stepId+"&taskid="+i.id+"&groupid="+i.groupId+"&instanceid="+i.instanceId,ico:"Edit",openMode,closable:!0})}},getExecuteMsg=(e,t)=>{const l=e.code;let o="";if(l==0){switch(t.toLowerCase()){case"save":o="已保存！";break;case"saveprogram":o="保存成功！";break;case"submit":case"freesubmit":utils.length(e.sendMessage)>0?o=e.sendMessage:utils.length(e.receiveHandler)>0?o="已发送到："+e.receiveHandler:e.stepPass?e.stepCountersignPass?e.flowCompleted?o="已完成！":o="已发送！":o=e.nextTasks.length==0?"已完成，等待其他步骤处理！":"已发送，等待其他步骤处理！":o=e.nextTasks.length==0?"已完成，等待他人处理！":"已发送，等待他人处理！";break;case"back":utils.length(e.backMessage)>0?o=e.backMessage:utils.length(e.receiveHandler)>0?o="已退回到："+e.receiveHandler:e.backPass?o="已退回！":o="已退回，等待他人处理！";break;case"known":o="已完成！";break;case"postpone":o="已暂缓！";break;case"end":o="已终止！";break;case"copyfor":o=utils.length(e.receiveHandler)>0?"已抄送给："+e.receiveHandler:"已抄送！";break;case"solicitopinion":o=utils.length(e.receiveHandler)>0?"已向："+e.receiveHandler+"征求意见！":"已征求意见！";break;case"reply":o="已回复！";break;case"redirect":o=utils.length(e.receiveHandler)>0?"已转交给："+e.receiveHandler:"已转交！";break;case"addwrite":o=utils.length(e.receiveHandler)>0?"已发送给："+e.receiveHandler+" 加签！":"已加签！";break;case"withdraw":o="已撤回！";break;default:o="处理成功！";break}return o}switch(l){case 1:o="参数错误！";break;case 2:o="流程id错误！";break;case 3:o="未知的处理类型！";break;case 4:o="未找到流程运行时实体！";break;case 5:o="未找到当前步骤运行时实体！";break;case 6:o="您不能处理该任务！";break;case 7:o="当前任务已处理，不能再次处理！";break;case 8:o="处理人为空！";break;case 9:o="当前流程不能发起新的任务！";break;case 10:o="未找到要处理的任务！";break;case 11:o="当前实例组任务为空！";break;case 12:o="保存表单数据时发生了错误！";break;case 1001:o=e.message;break;case 1002:o="发起子流程发生了错误！";break;case 1003:o="子流程对应的任务未完成，不能提交！";break;case 1100:o="未找到要抄送的步骤！";break;case 1101:o="抄送接收人为空！";break;case 1200:o="未找到要征求意见的步骤！";break;case 1201:o="征求意见接收人为空！";break;case 1300:o="未找到要转交的步骤！";break;case 1301:o="转交接收人为空！";break;case 1400:o="未找到要加签的步骤！";break;case 1401:o="加签接收人为空！";break;case 1500:o="不是发起人不能作废流程实例！";break;case 1501:o="作废流程实例发生错误！";break;case 2e3:o="当前步骤设置为不能退回！";break;case 2001:o=e.message;break;case 2002:o="退回没有找到接收人！";break;case 3e3:o="处理流程发生了错误！";break;case 5006:o="任务已处理，不能撤回！";break}return o},formData=ref({formId:"",formCode:"",programId:"0",titleField:"",titleExpression:""}),executeFlow=(e,t)=>{let l=JSON.parse(localStorage.getItem("task"));const o=ref(""),r=ref("");l==null||(o.value=l.formid,r.value=l.formtype),butDisabled.value=!0,loading.value=!0;const i={type:e,flowId,stepId,taskId,groupId,instanceId,isMobile,steps:t||[],comment:step.value.comment,attachment:step.value.attachment,sign:step.value.sign};if(step.value.archive==1&&(form.value.formData.archiveFormSelectOptions=form.value.formSelectOptions),utils.hasKey(form.value.formData,"serialNumber")&&utils.length(form.value.formData.serialNumber)>0)for(let a=0;a<form.value.formData.serialNumber.length;a++){let n=form.value.formData.serialNumber[a],u=[];for(let d=0;d<n.serials.length;d++){let f=n.serials[d].data;if(utils.length(f)===0)continue;new Function("formData",f)(form.value.formData)||u.push(d)}for(let d=0;d<u.length;d++)delete n.serials[u[d]];n.serials=n.serials.filter(d=>d!=="")}ajax.post("/Flow/FlowExecute?srcorgid="+sobInfo.value.id+queryString,qs.stringify({id:o.value,formtype:r.value,json:JSON.stringify(i),formData:JSON.stringify(form.value.formData)})).then(a=>{if(a.success){emits("index",!1);const n=a.data;utils.length(programId)>0?(utils.msg(getExecuteMsg(n,e),n.code==0),executeAfter(n,e,i)):utils.alert(getExecuteMsg(n,e),"","",n.code==0,()=>{executeAfter(n,e,i)})}else utils.msg("执行流程发生了错误！",!1);butDisabled.value=!1,loading.value=!1}).catch(()=>{butDisabled.value=!1,loading.value=!1})};let task=JSON.parse(localStorage.getItem("task"));const localStorageKeys=ref(),jsonObjects=ref(),executeFlows=(e,t)=>{task.taskType=="4"&&task.stepId==FristStepId.value?istj.value="1":istj.value="0";const l=ref(""),o=ref("");task==null||(l.value=task.formid,o.value=task.formtype),butDisabled.value=!0,loading.value=!0;const r={type:e,flowId,stepId,taskId,groupId,instanceId,isMobile,steps:t||[],comment:step.value.comment,attachment:step.value.attachment,sign:step.value.sign};if(step.value.archive==1&&(form.value.formData.archiveFormSelectOptions=form.value.formSelectOptions),utils.hasKey(form.value.formData,"serialNumber")&&utils.length(form.value.formData.serialNumber)>0)for(let i=0;i<form.value.formData.serialNumber.length;i++){let a=form.value.formData.serialNumber[i],n=[];for(let u=0;u<a.serials.length;u++){let d=a.serials[u].data;if(utils.length(d)===0)continue;new Function("formData",d)(form.value.formData)||n.push(u)}for(let u=0;u<n.length;u++)a.serials.splice(n[u],1)}ajax.post("/Flow/FlowExecute?srcorgid="+sobInfo.value.id+queryString,qs.stringify({id:l.value,istj:istj.value,isapply:"1",formtype:o.value,json:JSON.stringify(r),formData:JSON.stringify(formData.value),billJson:JSON.stringify(jsonObjects.value)})).then(i=>{if(i.success){index_refreshtab(),nextTick(()=>{roadComponentFormRef.value.removecontent()});const a=i.data;utils.length(programId)>0?(utils.msg(getExecuteMsg(a,e),a.code==0),index_removetab(),index_refreshtab()):utils.alert(getExecuteMsg(a,e),"","",a.code==0,()=>{index_removetab(),index_refreshtab()})}else utils.msg("执行流程发生了错误！",!1);butDisabled.value=!1,loading.value=!1}).catch(()=>{butDisabled.value=!1,loading.value=!1})},save=async()=>{nextTick(()=>{roadComponentFormRef.value.savecontent()});const e=utils.length(programId)>0||utils.length(formId)>0?"SaveProgram":"Save";if(form.value.type==0){const t=roadComponentFormRef.value.$refs.roadflowFormRef;if(utils.isUndef(t)||utils.isFunction(roadComponentFormRef.value.formValidate)&&!roadComponentFormRef.value.formValidate())return;await t.validate(l=>{l?executeFlow(e):utils.msg("表单验证错误，请检查表单必填项等信息！",!1)})}else form.value.type==1?await roadComponentFormRef.value.$refs.customFormRef.validate(l=>{l?executeFlow(e):utils.msg("表单验证错误，请检查表单必填项等信息！",!1)}):executeFlows(e)},send=async()=>{nextTick(()=>{roadComponentFormRef.value.savecontent()}),sendShow()},sendShow=()=>{if(localStorageKeys.value=Object.keys(localStorage),jsonObjects.value=localStorageKeys.value.filter(e=>e.endsWith("JSON")).reduce((e,t)=>{const l=localStorage.getItem(t),o=JSON.parse(l);return e[t]=o,e},{}),step.value.signType>0&&utils.length(step.value.comment)===0){utils.msg("请填写处理意见！",!1);return}if(step.value.signType>=2&&step.value.sign==0){step.value.signType==3?sign(1):utils.msg("请签章！",!1);return}dialogQuery.value=queryString,dialogPage.value=_sfc_main$2,dialogTitle.value="确认接收步骤",dialogWidth.value=isMobile=="1"?"350px":"600px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},sendOk=e=>{executeFlows("Submit",e)},back=()=>{if(formData.value.formId=localStorage.getItem("formid"),step.value.signType>0&&utils.length(step.value.comment)===0){utils.msg("请填写处理意见！",!1);return}if(step.value.signType>=2&&step.value.sign==0){step.value.signType==3?sign(2):utils.msg("请签章！",!1);return}dialogQuery.value=queryString,dialogPage.value=_sfc_main$3,dialogTitle.value="确认退回步骤",dialogWidth.value=isMobile=="1"?"350px":"600px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},backOk=e=>{executeFlows("Back",e)},process=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$4,dialogTitle.value="处理过程",dialogWidth.value=isMobile=="1"?"350px":"1150px",dialogClass.value="el-dialog__padding",dialogCenter.value=!1,dialogShow.value=!0},flowChart=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$5,dialogTitle.value="流程图",dialogWidth.value=isMobile=="1"?"350px":"1150px",dialogClass.value="el-dialog__padding",dialogCenter.value=!0,dialogShow.value=!0},sign=e=>{if(step.value.signType==3&&step.value.sign==0){dialogQuery.value=queryString+"&signaction="+(e||"0"),dialogPage.value=_sfc_main$1,dialogTitle.value="输入签章密码",dialogWidth.value=isMobile=="1"?"350px":"400px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0;return}step.value.sign=1},known=()=>{executeFlows("Known",[])},setHandler=()=>{if(utils.length(taskId)===0){utils.msg("请先保存再指定处理人！",!1);return}dialogQuery.value=queryString,dialogPage.value=_sfc_main$6,dialogTitle.value="指定后续步骤处理人",dialogWidth.value=isMobile=="1"?"350px":"600px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},refresh=(e,t)=>{if(isMobile=="1")if(isApp=="1"){let l=window.location.href;window.location.href=l}else indexm_refreshpage(t,e);else if(openMode=="2"||openMode=="3"){let l=window.location.href;window.location.href=l}else if(openMode=="1"){utils.length(e)===0&&(e="/flow/run/index"+(props.query.indexOf("?")===0?"":"?")+props.query);const l="task_"+utils.createGuid(!1),o=e.split("?"),r=o[0],i=o.length>1?o[1]:"";index_regcomponent(l,r),index_dialogcomponentId.value=l,index_dialogcomponentquery.value=i}else emits("index",!1),index_refreshtab(t,e)},close1=()=>{if(isMobile=="1"){if(isApp=="1"){if(isMiniProgram=="1"){wx.miniProgram.navigateBack({});return}uni.postMessage({data:{msg:"close"}});return}indexm_backpage();return}if(isEmail=="1"||openMode=="2"||openMode=="3"){window.close();return}if(utils.length(programId)>0||utils.length(formId)>0){if(utils.isDef(programrun_programcomponentref)&&utils.isDef(programrun_programcomponentref.value))programrun_programcomponentref.value.dialogShow=!1;else switch(openMode){case"0":index_removetab();break;case"1":utils.isDef(index_dialogshow)&&utils.isDef(index_dialogshow.value)&&(index_dialogshow.value=!1);break;case"2":case"3":window.close();break}return}else if(openMode=="1"){utils.isDef(index_dialogshow.value)&&(index_dialogshow.value=!1);return}emits("index",!1),index_removetab()},print1=()=>{if(isMobile=="1"){window.print();return}if(form.value.type==0){window.localStorage.setItem("flow_print_selectOptions",JSON.stringify(form.value.formSelectOptions)),window.localStorage.setItem("flow_print_html",form.value.html),window.localStorage.setItem("flow_print_formData",JSON.stringify(form.value.formData)),window.localStorage.setItem("flow_print_fieldStatus",JSON.stringify(step.value.fieldStatus)),window.localStorage.setItem("flow_print_comments",JSON.stringify(form.value.commentStepList));let e=utils.length(programId)>0?0:step.value.showComment,t="?loadurl="+encodeURIComponent("/flow/archive/print?isflowrun=1&showcomment="+e);utils.open(t,1e3,600,"打印")}else if(form.value.type==1){if(utils.query("customformprint",props.query)==="1"){window.print();return}let e="?loadurl="+encodeURIComponent("/flow/run/index.vue?flowid="+flowId+"&stepid="+stepId+"&taskid="+taskId+"&instanceid="+instanceId+"&display=1&openmode=2&customformprint=1");utils.open(e,1e3,600,"打印")}},urge=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$7,dialogTitle.value="任务催办",dialogWidth.value=isMobile=="1"?"350px":"680px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},withdraw=()=>{utils.confirm("您确定要撤回吗？",()=>{executeFlow("Withdraw",[])})},postpone=()=>{utils.confirm("您确定要暂缓吗？",()=>{executeFlow("Postpone",[])})},end=()=>{utils.confirm("您确定要终止吗？",()=>{executeFlow("End",[])})},copyfor=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$8,dialogTitle.value="抄送",dialogWidth.value=isMobile=="1"?"350px":"500px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},copyforOk=e=>{executeFlow("Copyfor",e)},solicitOpinions=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$9,dialogTitle.value="征求意见",dialogWidth.value=isMobile=="1"?"350px":"680px",dialogClass.value="el-dialog__padding",dialogCenter.value=!1,dialogShow.value=!0},solicitOpinionsOk=e=>{executeFlow("Solicitopinion",e)},reply=()=>{if(utils.length(step.value.comment)===0){utils.msg("请填写回复意见！",!1);return}executeFlows("Reply",[])},redirect=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$a,dialogTitle.value="转交",dialogWidth.value=isMobile=="1"?"350px":"500px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},redirectOk=e=>{executeFlows("Redirect",e)},addWrite=()=>{dialogQuery.value=queryString,dialogPage.value=_sfc_main$b,dialogTitle.value="加签",dialogWidth.value=isMobile=="1"?"350px":"650px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},addWriteOk=e=>{executeFlow("AddWrite",e)},freeSend=async()=>{if(form.value.type==0){const e=roadComponentFormRef.value.$refs.roadflowFormRef;if(utils.isUndef(e)||utils.isFunction(roadComponentFormRef.value.formValidate)&&!roadComponentFormRef.value.formValidate())return;await e.validate(t=>{t?freeSendShow():utils.msg("表单验证错误，请检查表单必填项等信息！",!1)})}else form.value.type==1?await roadComponentFormRef.value.$refs.customFormRef.validate(t=>{t?freeSendShow():utils.msg("表单验证错误，请检查表单必填项等信息！",!1)}):freeSendShow()},freeSendShow=()=>{if(step.value.signType>0&&utils.length(step.value.comment)===0){utils.msg("请填写处理意见！",!1);return}if(step.value.signType>=2&&step.value.sign==0){step.value.signType==3?sign(3):utils.msg("请签章！",!1);return}dialogQuery.value=queryString+"&freesend=1",dialogPage.value=_sfc_main$2,dialogTitle.value="步骤内发送",dialogWidth.value=isMobile=="1"?"350px":"600px",dialogClass.value="",dialogCenter.value=!0,dialogShow.value=!0},freeSendOk=e=>{executeFlow("FreeSubmit",e)},completed=async()=>{if(formData.value.formId=localStorage.getItem("formid"),form.value.type==0){const e=roadComponentFormRef.value.$refs.roadflowFormRef;if(utils.isUndef(e)||utils.isFunction(roadComponentFormRef.value.formValidate)&&!roadComponentFormRef.value.formValidate())return;await e.validate(t=>{t?completedOk():utils.msg("表单验证错误，请检查表单必填项等信息！",!1)})}else form.value.type==1?await roadComponentFormRef.value.$refs.customFormRef.validate(t=>{t?completedOk():utils.msg("表单验证错误，请检查表单必填项等信息！",!1)}):completedOk()},completedOk=()=>{if(step.value.signType>0&&utils.length(step.value.comment)===0){utils.msg("请填写处理意见！",!1);return}if(step.value.signType>=2&&step.value.sign==0){step.value.signType==3?sign(4):utils.msg("请签章！",!1);return}utils.confirm("您确定要完成吗？",()=>{executeFlows("Submit",[])})},tasks=JSON.parse(localStorage.getItem("tasks")),dele=()=>{const e=ref({type:"delete",flowId:tasks.flowId,stepId:tasks.stepId,taskId:tasks.id});ElMessageBox.confirm("您确定要作废吗？","操作确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ajax.post("/Flow/FlowExecute?srcorgid="+sobInfo.value.id,qs.stringify({id:tasks.formid,formtype:tasks.formtype,json:JSON.stringify(e.value)})).then(t=>{t.data.code==0?(emits("index",!1),utils.msg("作废成功！",!0),index_removetab()):utils.msg("执行作废发生了错误！",!1)}).catch(()=>{})}).catch(()=>{})};return provide("flowrun_step",step),provide("flowrun_form",form),provide("flowrun_sign",sign),provide("flowrun_send",send),provide("flowrun_sendok",sendOk),provide("flowrun_freesend",freeSend),provide("flowrun_freesendok",freeSendOk),provide("flowrun_back",back),provide("flowrun_backok",backOk),provide("flowrun_addwriteok",addWriteOk),provide("flowrun_solicitopinionsok",solicitOpinionsOk),provide("flowrun_copyforok",copyforOk),provide("flowrun_redirectok",redirectOk),provide("flowrun_dialogshow",dialogShow),provide("flowrun_save",save),provide("flowrun_process",process),provide("flowrun_flowchart",flowChart),provide("flowrun_known",known),provide("flowrun_sethandler",setHandler),provide("flowrun_close1",close1),provide("flowrun_print1",print1),provide("flowrun_withdraw",withdraw),provide("flowrun_postpone",postpone),provide("flowrun_end",end),provide("flowrun_copyfor",copyfor),provide("flowrun_solicitopinions",solicitOpinions),provide("flowrun_reply",reply),provide("flowrun_redirect",redirect),provide("flowrun_addwrite",addWrite),provide("flowrun_urge",urge),provide("flowrun_completed",completed),provide("flowrun_delete",dele),provide("roadcomponentformref",roadComponentFormRef),(e,t)=>{const l=resolveComponent("el-option"),o=resolveComponent("el-select"),r=resolveComponent("el-input"),i=resolveComponent("el-button"),a=resolveComponent("el-space"),n=resolveComponent("el-link"),u=resolveComponent("el-timeline-item"),d=resolveComponent("el-timeline"),f=resolveComponent("ArrowUpBold"),m=resolveComponent("el-icon"),p=resolveComponent("el-button-group"),g=resolveComponent("el-dropdown-item"),h=resolveComponent("el-dropdown-menu"),_=resolveComponent("el-dropdown"),b=resolveComponent("el-dialog"),y=resolveDirective("loading");return withDirectives((openBlock(),createElementBlock("div",{"element-loading-text":loadingText.value},[createBaseVNode("div",null,[buttons.value.length>0&&!unref(isPreview)&&unref(isMobile)!="1"?(openBlock(),createElementBlock("div",_hoisted_2,[unref(utils).length(unref(programId))===0&&unref(utils).length(unref(formId))===0?(openBlock(),createElementBlock("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(buttons.value,s=>(openBlock(),createElementBlock("div",{key:s.id},[s.id!==unref(utils).emptyLong+""?(openBlock(),createElementBlock("button",{key:0,onClick:c=>execScript(s.scripts,!0),disabled:butDisabled.value,type:"button"},[unref(utils).length(s.ico)>0?(openBlock(),createBlock(resolveDynamicComponent(s.ico),{key:0})):createCommentVNode("",!0),createTextVNode(toDisplayString(s.title),1)],8,_hoisted_5)):(openBlock(),createElementBlock("span",_hoisted_6,"|"))]))),128))])])):createCommentVNode("",!0)])):createCommentVNode("",!0),step.value.signType>0&&(step.value.display==0||step.value.display==4)&&unref(isMobile)!="1"?(openBlock(),createElementBlock("div",_hoisted_7,[createBaseVNode("div",null,[createVNode(o,{placeholder:"常用意见",onChange:t[0]||(t[0]=s=>{step.value.comment=s}),style:{width:"180px","margin-right":"12px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(form.value.commentList,(s,c)=>(openBlock(),createBlock(l,{key:c,label:s,value:s},null,8,["label","value"]))),128))]),_:1}),createVNode(r,{modelValue:step.value.comment,"onUpdate:modelValue":t[1]||(t[1]=s=>step.value.comment=s),style:{width:"55%","margin-right":"12px"},placeholder:"请输入意见",clearable:""},null,8,["modelValue"]),step.value.showAttachment==1?(openBlock(),createBlock(unref(ElSelectfile),{key:0,modelValue:step.value.attachment,"onUpdate:modelValue":t[2]||(t[2]=s=>step.value.attachment=s),style:{width:"130px","margin-right":"12px"}},null,8,["modelValue"])):createCommentVNode("",!0),step.value.signType>=2?(openBlock(),createBlock(i,{key:1,onClick:t[3]||(t[3]=s=>sign()),type:"primary",style:{"margin-right":"12px"}},{default:withCtx(()=>[createTextVNode("签章")]),_:1})):createCommentVNode("",!0),step.value.sign==1?(openBlock(),createBlock(unref(ElUsersign),{key:2,sign:unref(utils).length(step.value.signImg)>0?step.value.signImg:step.value.signName,style:{"vertical-align":"-3px"}},null,8,["sign"])):createCommentVNode("",!0)])])):createCommentVNode("",!0)]),createBaseVNode("div",{style:normalizeStyle({height:formHeight.value,overflow:"auto"})},[createBaseVNode("div",null,[unref(utils).length(step.value.note)>0?(openBlock(),createElementBlock("div",_hoisted_8,toDisplayString(step.value.note),1)):createCommentVNode("",!0),unref(utils).length(step.value.solicitOpinion)>0?(openBlock(),createElementBlock("div",_hoisted_9,toDisplayString(step.value.solicitOpinion),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_10,[form.value.type===0||form.value.type===1?(openBlock(),createBlock(resolveDynamicComponent(formComponentId.value),{key:0,ref_key:"roadComponentFormRef",ref:roadComponentFormRef,query:formComponentQuery.value},null,8,["query"])):(openBlock(),createElementBlock("iframe",{key:1,src:form.value.address,style:normalizeStyle(`border:none;width:100%;height:${parseInt(formHeight.value)-20}px;`),frameborder:"0"},null,12,_hoisted_11))]),createBaseVNode("div",_hoisted_12,[createVNode(d,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(form.value.commentStepList,(s,c)=>(openBlock(),createBlock(u,{key:c,type:"primary"},{default:withCtx(()=>[createBaseVNode("div",null,[unref(isMobile)=="1"?(openBlock(),createElementBlock("div",_hoisted_13,[createBaseVNode("div",null,[createBaseVNode("span",_hoisted_14,toDisplayString(s.receiverName),1),createBaseVNode("span",null,toDisplayString(s.stepName),1)]),createBaseVNode("div",_hoisted_15,toDisplayString(s.receiveTime)+" - 接收",1),createBaseVNode("div",_hoisted_16,toDisplayString(s.completedTime)+" - "+toDisplayString(unref(utils).getTaskHadleTitle(s.handleType)),1)])):(openBlock(),createElementBlock("div",_hoisted_17,[createVNode(a,{size:20},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(s.receiverName),1),createBaseVNode("span",null,toDisplayString(s.stepName),1),createBaseVNode("span",null,toDisplayString(s.receiveTime)+" - 接收",1),createBaseVNode("span",null,toDisplayString(s.completedTime)+" - "+toDisplayString(unref(utils).getTaskHadleTitle(s.handleType)),1)]),_:2},1024)]))]),createBaseVNode("div",_hoisted_18,[createBaseVNode("span",_hoisted_19,toDisplayString(s.comment),1),s.isSign===1?(openBlock(),createBlock(unref(ElUsersign),{key:0,sign:s.sign},null,8,["sign"])):createCommentVNode("",!0)]),unref(utils).length(s.attachment)>0?(openBlock(),createElementBlock("div",_hoisted_20,[_hoisted_21,createVNode(a,{size:20,wrap:""},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(s.attachment,(v,k)=>(openBlock(),createBlock(n,{key:v.id,onClick:w=>unref(utils).showFile(unref(index_openmenu),v,unref(sysConfig).SERVER_WEBADDRESS,unref(isMobile)=="1")},{default:withCtx(()=>[createTextVNode(toDisplayString(+ +k)+"、"+toDisplayString(v.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)])):createCommentVNode("",!0)]),_:2},1024))),128))]),_:1})])])],4),unref(isMobile)=="1"?(openBlock(),createElementBlock("div",_hoisted_22,[step.value.signType>0&&(step.value.display==0||step.value.display==4)?(openBlock(),createElementBlock("div",_hoisted_23,[createVNode(o,{placeholder:"常用",onChange:t[4]||(t[4]=s=>{step.value.comment=s}),style:{width:"75px","margin-right":"8px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(form.value.commentList,(s,c)=>(openBlock(),createBlock(l,{key:c,label:s,value:s},null,8,["label","value"]))),128))]),_:1}),createVNode(r,{modelValue:step.value.comment,"onUpdate:modelValue":t[5]||(t[5]=s=>step.value.comment=s),style:normalizeStyle("width:"+(step.value.signType>=2?"35%":"65%")+";margin-right:8px;"),placeholder:"请输入意见",clearable:""},null,8,["modelValue","style"]),step.value.signType>=2?(openBlock(),createBlock(i,{key:0,onClick:t[6]||(t[6]=s=>sign()),type:"primary",style:{"margin-right":"8px",padding:"8px"}},{default:withCtx(()=>[createTextVNode("签章")]),_:1})):createCommentVNode("",!0),step.value.sign==1?(openBlock(),createBlock(unref(ElUsersign),{key:1,sign:unref(utils).length(step.value.signImg)>0?step.value.signImg:step.value.signName,style:{"vertical-align":"-2px"}},null,8,["sign"])):createCommentVNode("",!0)])):createCommentVNode("",!0),unref(utils).length(unref(programId))===0&&unref(utils).length(unref(formId))===0?(openBlock(),createElementBlock("div",_hoisted_24,[createVNode(p,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(buttonsMobile.value,(s,c)=>(openBlock(),createBlock(i,{type:"primary",key:s.id,onClick:v=>execScript(s.scripts,!0),disabled:butDisabled.value,style:{cursor:"pointer"}},{default:withCtx(()=>[unref(utils).length(s.ico)>0?(openBlock(),createBlock(resolveDynamicComponent(s.ico),{key:0,style:{width:"16px",height:"16px","vertical-align":"-3px","margin-right":"5px"}})):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(s.title),1)]),_:2},1032,["onClick","disabled"]))),128)),buttonsMobileMore.value.length>0?(openBlock(),createBlock(i,{key:0,type:"primary",onClick:t[7]||(t[7]=()=>{dropdown_mobilebuttons.value.handleOpen()})},{default:withCtx(()=>[createVNode(m,null,{default:withCtx(()=>[createVNode(f)]),_:1})]),_:1})):createCommentVNode("",!0)]),_:1}),createVNode(_,{ref_key:"dropdown_mobilebuttons",ref:dropdown_mobilebuttons,trigger:"click",placement:"top"},{dropdown:withCtx(()=>[createVNode(h,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(buttonsMobileMore.value,(s,c)=>(openBlock(),createBlock(g,{key:s.id,onClick:v=>execScript(s.scripts,!0),disabled:butDisabled.value,style:{cursor:"pointer"}},{default:withCtx(()=>[createVNode(i,{type:"default"},{default:withCtx(()=>[unref(utils).length(s.ico)>0?(openBlock(),createBlock(resolveDynamicComponent(s.ico),{key:0,style:{width:"16px",height:"16px","vertical-align":"-3px","margin-right":"5px"}})):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(s.title),1)]),_:2},1024)]),_:2},1032,["onClick","disabled"]))),128))]),_:1})]),default:withCtx(()=>[_hoisted_25]),_:1},512)])):createCommentVNode("",!0)])):createCommentVNode("",!0),createVNode(b,{modelValue:dialogShow.value,"onUpdate:modelValue":t[8]||(t[8]=s=>dialogShow.value=s),title:dialogTitle.value,class:normalizeClass(dialogClass.value),"destroy-on-close":"",width:dialogWidth.value,draggable:"","close-on-click-modal":!1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(dialogPage.value),{query:dialogQuery.value},null,8,["query"]))]),_:1},8,["modelValue","title","class","width"]),(unref(utils).length(unref(programId))>0||unref(utils).length(unref(formId))>0)&&!unref(isPreview)?(openBlock(),createElementBlock("div",_hoisted_26,[(openBlock(!0),createElementBlock(Fragment,null,renderList(buttons.value,s=>(openBlock(),createBlock(i,{type:"primary",key:s.id,disabled:butDisabled.value,onClick:c=>execScript(s.scripts,!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(s.title),1)]),_:2},1032,["disabled","onClick"]))),128))])):createCommentVNode("",!0)],8,_hoisted_1)),[[y,loading.value]])}}};export{_sfc_main as default};
