import{ai as a,aT as u,aF as R,c as T,W as r,bD as o,aX as c,o as y,H as j,bi as b,I as B,U as w}from"./_@vue-5ba92de9.js";const N={__name:"addwrite",props:{query:{type:String,default:()=>""}},setup(k){const h=a("ajax"),l=a("utils"),q=a("ElSelectorg"),x=a("flowrun_addwriteok"),f=a("flowrun_dialogshow"),d=k,S=l.getQuery(d.query),m=l.query("stepid",d.query),V=l.query("ismobile",d.query),v=u(null),s=u({}),p=u(""),e=u(!1),C={receiver:[{required:!0,message:"请选择接收人",trigger:"blur"}]};R(()=>{W()});const W=()=>{e.value=!0,h.post("/Flow/GetAddWriteSelectRange?"+S).then(n=>{p.value=n.data.range,e.value=!1}).catch(()=>{e.value=!1})},D=async()=>{if(l.length(m)===0){l.msg("未找到步骤！",!1);return}await v.value.validate(n=>{if(n){e.value=!0;let t=[{id:m,members:s.value.receiver,addWriteType:0,addWriteHandleType:0}];x(t),e.value=!1,f.value=!1}})};return(n,t)=>{const _=c("el-form-item"),g=c("el-button"),F=c("el-form");return y(),T("div",null,[r(F,{model:s.value,ref_key:"ruleFormRef",ref:v,rules:C,"label-width":"70px"},{default:o(()=>[r(_,{label:"接收人",prop:"receiver"},{default:o(()=>[e.value?B("",!0):(y(),j(b(q),{key:0,placeholder:"选择加签接收人",style:{width:"100%"},"select-range":p.value,"show-search":b(V)!="1",modelValue:s.value.receiver,"onUpdate:modelValue":t[0]||(t[0]=i=>s.value.receiver=i)},null,8,["select-range","show-search","modelValue"]))]),_:1}),r(_,null,{default:o(()=>[r(g,{type:"primary",disabled:e.value,onClick:t[1]||(t[1]=i=>D())},{default:o(()=>[w("确定")]),_:1},8,["disabled"]),r(g,{disabled:e.value,onClick:t[2]||(t[2]=i=>f.value=!1)},{default:o(()=>[w("取消")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}};export{N as default};
