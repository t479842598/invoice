import{ai as b,aT as d,aF as F,c as H,a as f,W as o,bD as u,bF as A,H as E,aX as i,aY as G,o as j,bi as x,U as _,ay as L,b9 as V}from"./_@vue-5ba92de9.js";const W={class:"roadui_page"},X=["onClick"],I={class:"roadui_pagerdiv"},Z={__name:"outbox",setup(J){const C=b("ajax"),n=b("utils"),D=b("qs"),M=b("index_openmenu"),r=d({}),c=d([]),s=d(!1),h=d(!1),S=d([]);let m=[];const k=d({prop:"sendtime",order:"descending"}),a=d(n.getPager(k.value));F(()=>{v(!1)});const U=t=>{m=t},B=t=>{a.value.size=t,v(!1)},T=t=>{a.value.number=t,v(!1)},Y=t=>{a.value.order=n.getOrder(t),v(!1)},v=t=>{t&&(a.value.number=1),h.value=!0,s.value=!0,r.value.size=a.value.size,r.value.number=a.value.number,r.value.order=a.value.order,r.value.date1=n.length(c.value)>0?c.value[0]:"",r.value.date2=n.length(c.value)>1?c.value[1]:"",C.post("/Mail/GetOutList",D.stringify(r.value)).then(e=>{S.value=e.data.rows,a.value.total=e.data.total,s.value=!1,h.value=!1}).catch(()=>{s.value=!1})},z=t=>{if(m.length===0){n.msg("请选择要删除的邮件！","error");return}n.confirm("您确定要"+(t==1?"彻底":"")+"删除所选邮件吗？",()=>{s.value=!0,C.post("/Mail/DeleteDraft",D.stringify({ids:n.getArrayValues(m,"id").join(","),type:t})).then(e=>{let p=e.msg;n.length(p)===0&&(p=e.success?"删除成功！":"删除失败！"),n.msg(p,e.success),s.value=!1,e.success&&(m=[],v(!1))}).catch(()=>{s.value=!1})})},P=t=>{const e={title:t.mailSubject,id:"mail_view_"+t.id,url:"/system/mail/view?id="+t.id+"&source=outbox",ico:"Message",openMode:0};M(e)};return(t,e)=>{const p=i("el-input"),w=i("el-form-item"),$=i("el-date-picker"),y=i("el-button"),N=i("el-form"),g=i("el-table-column"),O=i("el-table"),R=i("el-pagination"),q=G("loading");return j(),H("div",W,[f("div",null,[o(N,{inline:!0},{default:u(()=>[o(w,{label:"主题"},{default:u(()=>[o(p,{modelValue:r.value.mailSubject,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.mailSubject=l),style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),o(w,{label:"日期"},{default:u(()=>[o($,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value=l),style:{width:"220px"},type:"daterange","value-format":"YYYY-MM-DD","unlink-panels":"","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:x(n).dateShortucts},null,8,["modelValue","shortcuts"])]),_:1}),o(w,null,{default:u(()=>[o(y,{type:"primary",disabled:s.value,onClick:e[2]||(e[2]=l=>v(!0))},{default:u(()=>[_("查询")]),_:1},8,["disabled"]),o(y,{type:"danger",disabled:s.value,onClick:e[3]||(e[3]=l=>z(0))},{default:u(()=>[_("删除")]),_:1},8,["disabled"]),o(y,{type:"danger",disabled:s.value,onClick:e[4]||(e[4]=l=>z(1))},{default:u(()=>[_("彻底删除")]),_:1},8,["disabled"])]),_:1})]),_:1})]),f("div",null,[A((j(),E(O,{data:S.value,stripe:a.value.tableStripe,border:a.value.tableBorder,style:{width:"100%"},"highlight-current-row":a.value.tableHighlightCurrentRow,"default-sort":k.value,onSortChange:Y,onSelectionChange:U},{default:u(()=>[o(g,{type:"selection",width:"45"}),o(g,{prop:"mailSubject",label:"主题",sortable:"custom","show-overflow-tooltip":""},{default:u(l=>[f("a",{class:"roaduia",href:"javascript:;",onClick:K=>P(l.row),style:L(x(n).length(l.row.subjectColor)>0?"color:"+l.row.subjectColor:"")},V(l.row.mailSubject),13,X)]),_:1}),o(g,{prop:"receiveUsers",label:"收件人",width:"350"},{default:u(l=>[_(V(l.row.receiveUsers),1)]),_:1}),o(g,{prop:"sendTime",label:"日期",width:"180",sortable:"custom"})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[q,h.value]])]),f("div",I,[o(R,{currentPage:a.value.number,"onUpdate:currentPage":e[5]||(e[5]=l=>a.value.number=l),"page-size":a.value.size,"onUpdate:pageSize":e[6]||(e[6]=l=>a.value.size=l),"page-sizes":a.value.sizes,background:a.value.background,layout:a.value.layout,total:a.value.total,disabled:s.value,onSizeChange:B,onCurrentChange:T},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])])])}}};export{Z as default};
