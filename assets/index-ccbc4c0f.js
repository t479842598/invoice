import{ai as S,aT as f,A as q,b5 as ue,H as p,bD as t,bi as z,aN as ie,aX as d,aY as de,o as i,W as s,a as y,aZ as R,b9 as P,c as A,bI as ce,U as m,I as k,bF as pe}from"./_@vue-5ba92de9.js";import{p as E,_ as fe}from"./_splitpanes-c98d9122.js";import ve from"./design-6f3fc913.js";import"./attr-5eff33cd.js";import"./list-60b7f9af.js";import"./chart-37bd8203.js";import"./query-0e5a2d34.js";import"./button1-30915d18.js";import"./validate-f3d8f299.js";import"./export-9b056b65.js";const me={class:"roadui_treenode"},ge={key:0},_e=y("span",null,"操作",-1),he={class:"roadui_pagerdiv"},be={key:1},Ve={__name:"index",setup(ye){const h=S("ajax"),o=S("utils"),C=S("qs"),u=f({status:0}),n=f(!1),G=q(()=>e=>{switch(e){case 0:return"设计中";case 1:return"已发布";case 2:return"已删除";default:return"未知"}}),H=q(()=>e=>{switch(e){case 0:return"info";case 1:return"success";case 2:return"danger";default:return""}}),T=f([]),L=f([]),J=e=>{if(u.value.type=e.id,e.id===o.emptyLong+""){u.value.status=2,c(!0);return}u.value.status=0,c(!1)},O={children:"children",label:"title",isLeaf:"isLeaf"},F=(e,a)=>{if(e.level===0)h.post("/Dictionary/GetTreeJson?root=system_applibrary_type").then(v=>{const w={id:o.emptyLong+"",parentId:"0",title:"已删除应用",ico:"Delete",titleEn:"",titleTw:"",isLeaf:!0};v.data.push(w),T.value=v.data,o.length(v.data)>0&&L.value.push(v.data[0].id),c(!1)}).catch(()=>{});else{if(o.length(e.data.children)>0){a(e.data.children);return}h.post("/Dictionary/GetTreeChildsJson?parentid="+e.data.id).then(v=>{a(v.data)}).catch(()=>{})}},D=f(!1),N=f([]);let g=[];const V=f({prop:"createtime",order:"descending"}),r=f(o.getPager(V.value)),K=e=>{g=e},M=e=>{r.value.size=e,c(!1)},Q=e=>{r.value.number=e,c(!1)},W=e=>{r.value.order=o.getOrder(e),c(!1)},c=e=>{e&&(r.value.number=1),D.value=!0,n.value=!0,u.value.size=r.value.size,u.value.number=r.value.number,u.value.order=r.value.order,h.post("/Program/GetList",C.stringify(u.value)).then(a=>{N.value=a.data.rows,r.value.total=a.data.total,n.value=!1,D.value=!1}).catch(()=>{n.value=!1})},X=()=>{if(g.length===0){o.msg("您没有选择要删除的应用！",!1);return}o.confirm("您确定要删除所选应用吗？",()=>{n.value=!0,h.post("/Program/Delete",C.stringify({ids:o.getArrayValues(g,"id").join(",")})).then(e=>{o.msg(e.success?"删除成功！":"删除失败！",e.success),n.value=!1,g=[],c(!1)}).catch(()=>{n.value=!1})})},Y=()=>{if(g.length===0){o.msg("您没有选择要彻底删除的应用！",!1);return}o.confirm("您确定要彻底删除所选应用吗？",()=>{n.value=!0,h.post("/Program/ThoroughDelete",C.stringify({ids:o.getArrayValues(g,"id").join(",")})).then(e=>{n.value=!1,o.msg(e.success?"彻底删除成功！":"彻底删除失败！",e.success),g=[],c(!1)}).catch(()=>{n.value=!1})})},x=f(0),U=ue(null),$=f(""),j=e=>{U.value=ve,$.value="?programid="+(o.isDef(e)?e.id:""),x.value=1},Z=e=>{o.confirm("您确定要恢复该应用吗？",()=>{n.value=!0,h.post("/Program/Recovery",C.stringify({id:e.id})).then(a=>{a.success?(o.msg("恢复成功！",!0),c(!1)):o.msg("恢复失败！",!1),n.value=!1}).catch(()=>{n.value=!1})})};return ie("program_returnlist",()=>{x.value=0,c(!1)}),(e,a)=>{const v=d("document"),w=d("el-icon"),ee=d("folder"),te=d("el-tree"),ae=d("el-input"),B=d("el-form-item"),b=d("el-button"),le=d("el-form"),_=d("el-table-column"),I=d("el-tag"),se=d("el-table"),oe=d("el-pagination"),ne=de("loading");return i(),p(z(fe),{class:"default-theme",style:{height:"inherit"}},{default:t(()=>[s(z(E),{size:16,"min-size":"16","max-size":"50",style:{overflow:"auto",background:"#fff"}},{default:t(()=>[s(te,{data:T.value,props:O,load:F,lazy:"","node-key":"id","highlight-current":"","default-expanded-keys":L.value,"expand-on-click-node":!1,style:{height:"inherit","padding-right":"14px"},onNodeClick:J},{default:t(l=>[y("div",me,[z(o).length(l.data.ico)>0?(i(),p(R(l.data.ico),{key:0})):l.node.isLeaf?(i(),p(w,{key:1},{default:t(()=>[s(v)]),_:1})):(i(),p(w,{key:2},{default:t(()=>[s(ee)]),_:1})),y("span",null,P(l.node.label),1)])]),_:1},8,["data","default-expanded-keys"])]),_:1}),s(z(E),{size:84,style:{background:"#fff",overflow:"auto","padding-left":"5px"}},{default:t(()=>[x.value===0?(i(),A("div",ge,[y("div",null,[s(le,{inline:!0,onSubmit:a[3]||(a[3]=ce(()=>{},["prevent"]))},{default:t(()=>[s(B,{label:"名称"},{default:t(()=>[s(ae,{modelValue:u.value.name,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value.name=l),placeholder:"应用名称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),s(B,null,{default:t(()=>[s(b,{type:"primary",disabled:n.value,onClick:a[1]||(a[1]=l=>c(!0))},{default:t(()=>[m("查询")]),_:1},8,["disabled"]),u.value.status==0?(i(),p(b,{key:0,type:"primary",disabled:n.value,onClick:a[2]||(a[2]=l=>j(null))},{default:t(()=>[m("添加")]),_:1},8,["disabled"])):k("",!0),u.value.status==0?(i(),p(b,{key:1,type:"danger",disabled:n.value,onClick:X},{default:t(()=>[m("删除")]),_:1},8,["disabled"])):k("",!0),u.value.status==2?(i(),p(b,{key:2,type:"danger",disabled:n.value,onClick:Y},{default:t(()=>[m("彻底删除")]),_:1},8,["disabled"])):k("",!0)]),_:1})]),_:1})]),y("div",null,[pe((i(),p(se,{data:N.value,stripe:r.value.tableStripe,border:r.value.tableBorder,style:{width:"100%"},"highlight-current-row":r.value.tableHighlightCurrentRow,"default-sort":V.value,onSortChange:W,onSelectionChange:K},{default:t(()=>[s(_,{type:"selection",width:"45"}),s(_,{prop:"name",label:"应用名称",sortable:"custom"}),s(_,{prop:"type",label:"应用分类",sortable:"custom"}),s(_,{prop:"createTime",label:"创建时间",width:"150",sortable:"custom"}),s(_,{prop:"createUserId",label:"创建人",width:"120",sortable:"custom"},{default:t(l=>[s(I,null,{default:t(()=>[m(P(l.row.createUserId),1)]),_:2},1024)]),_:1}),s(_,{prop:"status",label:"状态",width:"100",sortable:"custom"},{default:t(l=>[s(I,{effect:"dark",type:H.value(l.row.status)},{default:t(()=>[m(P(G.value(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),s(_,{width:"100"},{header:t(()=>[_e]),default:t(l=>[u.value.status==0?(i(),p(b,{key:0,size:"small",disabled:n.value,type:"primary",onClick:re=>j(l.row)},{default:t(()=>[m("编辑")]),_:2},1032,["disabled","onClick"])):k("",!0),u.value.status==2?(i(),p(b,{key:1,size:"small",disabled:n.value,type:"primary",onClick:re=>Z(l.row)},{default:t(()=>[m("恢复")]),_:2},1032,["disabled","onClick"])):k("",!0)]),_:1})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[ne,D.value]])]),y("div",he,[s(oe,{currentPage:r.value.number,"onUpdate:currentPage":a[4]||(a[4]=l=>r.value.number=l),"page-size":r.value.size,"onUpdate:pageSize":a[5]||(a[5]=l=>r.value.size=l),"page-sizes":r.value.sizes,background:r.value.background,layout:r.value.layout,total:r.value.total,disabled:n.value,onSizeChange:M,onCurrentChange:Q},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])])])):(i(),A("div",be,[(i(),p(R(U.value),{query:$.value},null,8,["query"]))]))]),_:1})]),_:1})}}};export{Ve as default};
