import{ai as A,aT as m,aF as P,H as h,bD as i,aX as v,o as n,W as u,a as t,b9 as U,c as b,aV as y,bi as _,F as g,U as f,bF as X,bv as Q}from"./_@vue-5ba92de9.js";import{d as Y}from"./form-design-8c117009.js";import"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_jquery-3a83ed9f.js";const Z={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},$=t("th",{style:{width:"60px"}},"控件id",-1),ee={class:"roadui_formfont"},le=t("th",null,"绑定字段",-1),te={class:"roadui_note1"},ae={style:{"margin-left":"12px"}},oe=t("th",null,"默认值",-1),de=t("th",null,"弹出页面",-1),ue=t("th",null,"值字段",-1),ne={style:{"margin-left":"12px"}},re=t("th",null,"值分隔符",-1),ie={style:{"margin-left":"12px"}},se=t("th",null,"窗口标题",-1),pe={style:{"margin-left":"10px"}},me={style:{"margin-left":"10px"}},ve={style:{"margin-left":"10px"}},be=t("th",null,"参数",-1),ce={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},he=t("th",{style:{width:"50px"}},"事件",-1),ye=t("th",null,"脚本",-1),Te={__name:"selectdiv",props:{query:{type:String,default:()=>""}},setup(D){const S=A("ajax"),d=A("utils"),R=A("qs"),q=A("ElCodemirror"),B=D,W=d.query("editorname",B.query),c=window.parent.CKEDITOR.instances[W],I=c.formAttributeJSON,l=m({}),r=m({}),x=m(""),k=m([]),G=Y.defaultValueOptions(),O=m([]),w=m([]),N=m([]),F=m([]);P(()=>{I&&d.getConnTableFields(I.dbConn,I.dbTable).then(o=>{k.value=o,z()})});const M=o=>{d.length(o)!==0&&(l.value.defaultValue+=o[o.length-1])},z=()=>{if(d.length(O.value)>0){T();return}const o=[{id:"system_applibrary_type",key:"type",children:!0,valueField:"id"}];S.post("/Dictionary/GetMultipleOptions",R.stringify({json:JSON.stringify(o)})).then(a=>{O.value=a.data.type,T()}).catch(()=>{})},C=o=>{d.length(o)>0?S.post("/Applibrary/GetOptions?typeid="+o[o.length-1]).then(a=>{w.value=a.data}).catch(()=>{}):(l.value.applibraryId="",w.value=[])},E=o=>{const a=d.getArrayObj(w.value,o,"id");d.isDef(a)&&(l.value.applibraryAddress=a.address),S.post("/Program/GetFieldOptionsByApplibraryId?applibraryid="+o).then(s=>{N.value=s.data,F.value=s.data}).catch(()=>{})},T=o=>{l.value={id:"",label:"",field:"",width:"",defaultValue:"",placeholder:""},r.value={},o||(o=c.currentSelectEditorElement),o&&(l.value.id=o.getAttribute("data-id"),l.value.label=o.getAttribute("data-label"),l.value.field=o.getAttribute("data-bindfiled"),l.value.defaultValue=d.decodeURI(o.getAttribute("data-defaultvalue")),l.value.applibraryTypeId=JSON.parse(d.decodeURI(o.getAttribute("data-applibrarytypeid")||"[]"))||[],l.value.applibraryId=d.decodeURI(o.getAttribute("data-applibraryid")),l.value.applibraryAddress=d.decodeURI(o.getAttribute("data-applibraryaddress")),l.value.valueField=o.getAttribute("data-valuefield"),l.value.titleField=o.getAttribute("data-titlefield"),l.value.valueSeparator=o.getAttribute("data-valueseparator"),l.value.titleSeparator=o.getAttribute("data-titleseparator"),l.value.modalTitle=o.getAttribute("data-modaltitle"),l.value.placeholder=o.getAttribute("data-placeholder"),l.value.width=o.getAttribute("data-width"),d.isNumberString(o.getAttribute("data-modalwidth"))&&(l.value.modalWidth=d.toNumber(o.getAttribute("data-modalwidth"))),l.value.params=d.decodeURI(o.getAttribute("data-params")),l.value.applibraryTypeId.length>0&&C(l.value.applibraryTypeId),d.length(l.value.applibraryId)>0&&E(l.value.applibraryId),r.value=d.getArrayObj(c.formEventsJSON,l.value.id,"id"),d.isUndef(r.value)?(r.value={id:l.value.id,events:[{name:"change",script:""}]},c.formEventsJSON.push(r.value)):d.length(r.value.events)===0&&(r.value={id:l.value.id,events:[{name:"change",script:""}]}),x.value=r.value.events[0].name),c.currentSelectEditorElementJson=l.value,c.initFunction_selectdiv=T};return(o,a)=>{const s=v("el-option"),V=v("el-select"),p=v("el-input"),j=v("el-cascader"),H=v("el-input-number"),J=v("el-tab-pane"),K=v("el-tabs");return n(),h(K,null,{default:i(()=>[u(J,{name:"0",label:"属性",style:{height:"100%"}},{default:i(()=>[t("table",Z,[t("tr",null,[$,t("td",ee,U(l.value.id),1)]),t("tr",null,[le,t("td",null,[u(V,{modelValue:l.value.field,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value.field=e),filterable:"",style:{width:"260px"},clearable:""},{default:i(()=>[(n(!0),b(g,null,y(k.value,e=>(n(),h(s,{key:e.name,value:e.name,label:e.name+(_(d).length(e.comment)>0?" - "+e.comment:"")},{default:i(()=>[t("span",null,U(e.name),1),t("span",te,U(_(d).length(e.comment)>0?" - "+e.comment:""),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),t("span",ae,[f(" 标签"),u(p,{modelValue:l.value.label,"onUpdate:modelValue":a[1]||(a[1]=e=>l.value.label=e),placeholder:"控件label",style:{width:"285px","margin-left":"12px"},clearable:""},null,8,["modelValue"])])])]),t("tr",null,[oe,t("td",null,[u(j,{placeholder:"选择默认值",options:_(G),props:{expandTrigger:"hover",checkStrictly:!1},clearable:"",onChange:M,style:{width:"260px","margin-right":"18px"}},null,8,["options"]),u(p,{modelValue:l.value.defaultValue,"onUpdate:modelValue":a[2]||(a[2]=e=>l.value.defaultValue=e),style:{width:"323px"},clearable:""},null,8,["modelValue"])])]),t("tr",null,[de,t("td",null,[u(j,{modelValue:l.value.applibraryTypeId,"onUpdate:modelValue":a[3]||(a[3]=e=>l.value.applibraryTypeId=e),placeholder:"请选择应用分类",options:O.value,onChange:C,props:{expandTrigger:"hover",checkStrictly:!1},clearable:"",style:{width:"260px","margin-right":"18px"}},null,8,["modelValue","options"]),u(V,{modelValue:l.value.applibraryId,"onUpdate:modelValue":a[4]||(a[4]=e=>l.value.applibraryId=e),onChange:E,style:{width:"323px"},clearable:""},{default:i(()=>[(n(!0),b(g,null,y(w.value,e=>(n(),h(s,{key:e.id,value:e.id,label:e.label},{default:i(()=>[t("span",null,U(e.label+(_(d).length(e.note)>0?" - "+e.note:"")),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[ue,t("td",null,[u(V,{modelValue:l.value.valueField,"onUpdate:modelValue":a[5]||(a[5]=e=>l.value.valueField=e),style:{width:"260px"},clearable:""},{default:i(()=>[(n(!0),b(g,null,y(N.value,e=>(n(),h(s,{key:e.value,value:e.value,label:e.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"]),t("span",ne,[f(" 标题字段"),u(V,{modelValue:l.value.titleField,"onUpdate:modelValue":a[6]||(a[6]=e=>l.value.titleField=e),options:F.value,style:{width:"257px","margin-left":"12px"},clearable:""},{default:i(()=>[(n(!0),b(g,null,y(F.value,e=>(n(),h(s,{key:e.value,value:e.value,label:e.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue","options"])])])]),t("tr",null,[re,t("td",null,[u(p,{modelValue:l.value.valueSeparator,"onUpdate:modelValue":a[7]||(a[7]=e=>l.value.valueSeparator=e),placeholder:"多选时多个值之间的分隔符",style:{width:"260px"},clearable:""},null,8,["modelValue"]),t("span",ie,[f(" 标题分隔符"),u(p,{modelValue:l.value.titleSeparator,"onUpdate:modelValue":a[8]||(a[8]=e=>l.value.titleSeparator=e),placeholder:"多选时多个标题之间的分隔符",style:{width:"243px","margin-left":"12px"},clearable:""},null,8,["modelValue"])])])]),t("tr",null,[se,t("td",null,[u(p,{modelValue:l.value.modalTitle,"onUpdate:modelValue":a[9]||(a[9]=e=>l.value.modalTitle=e),style:{width:"100px"},clearable:""},null,8,["modelValue"]),t("span",pe,[f(" 背景文字"),u(p,{modelValue:l.value.placeholder,"onUpdate:modelValue":a[10]||(a[10]=e=>l.value.placeholder=e),placeholder:"placeholder",style:{width:"100px","margin-left":"12px"},clearable:""},null,8,["modelValue"])]),t("span",me,[f(" 控件宽度"),u(p,{modelValue:l.value.width,"onUpdate:modelValue":a[11]||(a[11]=e=>l.value.width=e),placeholder:"px或%",style:{width:"70px","margin-left":"12px"},"allow-clear":""},null,8,["modelValue"])]),t("span",ve,[f(" 窗口宽度"),u(H,{modelValue:l.value.modalWidth,"onUpdate:modelValue":a[12]||(a[12]=e=>l.value.modalWidth=e),"controls-position":"right",style:{width:"85px","margin-left":"12px"}},null,8,["modelValue"])])])]),t("tr",null,[be,t("td",null,[u(p,{modelValue:l.value.params,"onUpdate:modelValue":a[13]||(a[13]=e=>l.value.params=e),style:{width:"601px"},"allow-clear":"",placeholder:"js表达式，例'size=5&test='+this.formData['id']"},null,8,["modelValue"])])])])]),_:1}),u(J,{name:"1",label:"事件",style:{height:"100%"}},{default:i(()=>[t("table",ce,[t("tr",null,[he,t("td",null,[u(V,{modelValue:x.value,"onUpdate:modelValue":a[14]||(a[14]=e=>x.value=e)},{default:i(()=>[(n(!0),b(g,null,y(r.value.events,e=>(n(),h(s,{key:e.name,value:e.name,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[ye,t("td",null,[(n(!0),b(g,null,y(r.value.events,e=>X((n(),b("div",{style:{width:"620px"},key:"script_"+e.name},[u(_(q),{modelValue:e.script,"onUpdate:modelValue":L=>e.script=L,height:"350px"},null,8,["modelValue","onUpdate:modelValue"])])),[[Q,x.value==e.name]])),128))])])])]),_:1})]),_:1})}}};export{Te as default};
