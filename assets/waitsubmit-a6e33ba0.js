import{ai as M,aT as D,aF as G,c as n,a as o,U as f,b9 as p,H as U,bD as _,I as k,W as c,F as w,aV as T,aX as b,o as t,bi as S,ay as m}from"./_@vue-5ba92de9.js";const H={class:"roadui_vote_title"},I={class:"roadui_vote_titleinfo"},L=o("span",{style:{"margin-right":"12px"}},"发布人",-1),O={style:{color:"#666"}},W={key:0},X=o("span",{style:{"margin-right":"12px"}},"发布时间",-1),J=o("span",{style:{"margin-right":"12px"}},"结束时间",-1),K={key:1},P=o("span",{style:{"margin-right":"12px"}},"提交方式",-1),R=o("span",{style:{"font-weight":"bold"}},"匿名",-1),Y=[P,R],Z={class:"roadui_vote_body"},j={class:"roadui_vote_subject_title"},ee={key:0},le={key:1},ae={key:0},te={key:1},oe={style:{"text-align":"center",width:"100%","margin-top":"12px"}},ne={__name:"waitsubmit",props:{query:{type:String,default:()=>""}},setup(q){const C=M("ajax"),B=M("qs"),g=M("utils"),z=M("wait_dialogshow"),N=M("wait_loadtabledata"),$=q,y=D(!1),s=D({});G(()=>{F()});const F=()=>{y.value=!0,C.post("/Questionnaire/GetSubjects"+($.query||"")+"&loadresult=1").then(r=>{s.value=r.data,y.value=!1}).catch(()=>{y.value=!1})},A=()=>{g.confirm("您确定要提交吗？",()=>{y.value=!0;for(var r={id:s.value.id,subjects:[]},d=0;d<s.value.subjects.length;d++){var a=s.value.subjects[d],h="";switch(a.subjectMode){case 1:h=a.selectValue||"";break;case 2:h=(a.selectValue||[]).join(",");break;case 3:h=a.inputValue||"";break;case 4:h=a.textareaValue||"";break}for(var i={id:a.id,value:h,mode:a.subjectMode},u=0;u<a.options.length;u++)a.options[u].optionMode==1?i["value_"+a.options[u].id]=a.options[u].inputValue||"":a.options[u].optionMode==2&&(i["value_"+a.options[u].id]=a.options[u].textareaValue||"");r.subjects.push(i)}r.subjectSize=r.subjects.length,C.post("/Questionnaire/SaveSubmit",B.stringify(r)).then(V=>{y.value=!1;let v=V.msg;g.length(v)===0&&(V.success?v="提交成功！":V.code==1?v="没有找到要提交的问卷！":V.code==2?v="问卷已超过结束时间，不能提交！":v="提交失败！"),g.msg(v,V.success),V.success&&(N(!1),z.value=!1)}).catch(()=>{y.value=!1})})};return(r,d)=>{const a=b("el-button"),h=b("el-space"),i=b("el-input"),u=b("el-radio"),V=b("el-radio-group"),v=b("el-checkbox"),Q=b("el-checkbox-group");return t(),n("div",null,[o("div",H,[f(p(s.value.subject)+" ",1),s.value.status==0?(t(),U(a,{key:0,type:"primary",size:"small",onClick:d[0]||(d[0]=l=>r.add(null)),style:{"margin-left":"12px"}},{default:_(()=>[f("添加选题")]),_:1})):k("",!0)]),o("div",I,[c(h,{size:25},{default:_(()=>[o("span",null,[L,f(p(s.value.addUser),1),o("span",O," - "+p(s.value.addUserOrganize),1)]),S(g).length(s.value.publishTime)>0?(t(),n("span",W,[X,f(p(s.value.publishTime),1)])):k("",!0),o("span",null,[J,f(p(S(g).length(s.value.endTime)>0?s.value.endTime:"无结束时间"),1)]),s.value.anonymous==1?(t(),n("span",K,Y)):k("",!0)]),_:1})]),o("div",Z,[(t(!0),n(w,null,T(s.value.subjects,(l,E)=>(t(),n("div",{key:l.id,class:"roadui_vote_subjectline"},[o("div",j,[o("span",{style:m(l.subjectStyle)},p(E+1)+"、"+p(l.subjectTitle),5),s.value.status==0?(t(),U(a,{key:0,size:"small",type:"primary",onClick:e=>r.add(l),style:{"margin-left":"12px"}},{default:_(()=>[f("编辑")]),_:2},1032,["onClick"])):k("",!0)]),o("div",null,[l.subjectMode==1?(t(),U(V,{key:0,modelValue:l.selectValue,"onUpdate:modelValue":e=>l.selectValue=e,style:{display:"block"}},{default:_(()=>[(t(!0),n(w,null,T(l.options,e=>(t(),n("div",{key:e.id,class:"roadui_vote_subject_option"},[c(u,{label:e.id},{default:_(()=>[o("span",{style:m(e.optionMode==0?e.optionStyle:"")},p(e.optionTitle),5),e.optionMode==1&&l.selectValue==e.id?(t(),n("span",ee,[c(i,{modelValue:e.inputValue,"onUpdate:modelValue":x=>e.inputValue=x,clearable:"",style:m("margin-left:12px;"+e.optionStyle)},null,8,["modelValue","onUpdate:modelValue","style"])])):e.optionMode==2&&l.selectValue==e.id?(t(),n("span",le,[c(i,{modelValue:e.textareaValue,"onUpdate:modelValue":x=>e.textareaValue=x,type:"textarea",style:m("margin-left:12px;vertical-align:middle;"+e.optionStyle)},null,8,["modelValue","onUpdate:modelValue","style"])])):k("",!0)]),_:2},1032,["label"])]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):l.subjectMode==2?(t(),U(Q,{key:1,name:"checkbox_"+l.id,modelValue:l.selectValue,"onUpdate:modelValue":e=>l.selectValue=e},{default:_(()=>[(t(!0),n(w,null,T(l.options,e=>(t(),n("div",{key:e.id,class:"roadui_vote_subject_option"},[c(v,{label:e.id},{default:_(()=>[o("span",{style:m(e.optionMode==0?e.optionStyle:"")},p(e.optionTitle),5),e.optionMode==1&&S(g).inArray(l.selectValue,e.id)?(t(),n("span",ae,[c(i,{modelValue:e.inputValue,"onUpdate:modelValue":x=>e.inputValue=x,clearable:"",style:m("margin-left:12px;"+e.optionStyle)},null,8,["modelValue","onUpdate:modelValue","style"])])):e.optionMode==2&&S(g).inArray(l.selectValue,e.id)?(t(),n("span",te,[c(i,{modelValue:e.textareaValue,"onUpdate:modelValue":x=>e.textareaValue=x,type:"textarea",style:m("margin-left:12px;vertical-align:middle;"+e.optionStyle)},null,8,["modelValue","onUpdate:modelValue","style"])])):k("",!0)]),_:2},1032,["label"])]))),128))]),_:2},1032,["name","modelValue","onUpdate:modelValue"])):l.subjectMode==3?(t(),U(i,{key:2,modelValue:l.inputValue,"onUpdate:modelValue":e=>l.inputValue=e,clearable:"",style:m("margin-top:10px;"+l.subjectStyle)},null,8,["modelValue","onUpdate:modelValue","style"])):l.subjectMode==4?(t(),U(i,{key:3,modelValue:l.textareaValue,"onUpdate:modelValue":e=>l.textareaValue=e,type:"textarea",style:m("margin-top:10px;vertical-align:middle;"+l.subjectStyle)},null,8,["modelValue","onUpdate:modelValue","style"])):k("",!0)])]))),128)),o("div",oe,[c(a,{disabled:y.value,type:"primary",onClick:d[1]||(d[1]=l=>A())},{default:_(()=>[f("提交")]),_:1},8,["disabled"]),c(a,{disabled:y.value,onClick:d[2]||(d[2]=l=>{z.value=!1})},{default:_(()=>[f("关闭")]),_:1},8,["disabled"])])])])}}};export{ne as default};
