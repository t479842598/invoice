import{ai as p,aT as n,aF as Le,av as Ra,aK as Ua,by as Pa,b5 as Ma,aN as A,c as G,a as T,W as d,bD as c,F as Q,aV as se,A as Ja,aX as I,o as C,bF as h,bv as w,H as W,U as F,b9 as q,bi as ye,I as Ea}from"./_@vue-5ba92de9.js";import{B as ja,P as Da}from"./_@element-plus-ad4c9002.js";import Ha from"./send-40a38f7b.js";import{_ as Ba}from"./index-823f4b27.js";import{a as ne}from"./_element-plus-8c7ce171.js";import"./__vendor-5e6ac033.js";import"./_crypto-js-0812dcff.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_@popperjs-c75af06c.js";const La={style:{padding:"15px"}},Aa={style:{color:"#606266"}},Ga={class:"card-header",style:{display:"flex","align-items":"center"}},Qa={class:"bottom"},Wa={__name:"Editmobile",props:{query:{type:String,default:()=>""},modelValue:{type:Boolean,default:!1},new:{type:Boolean,default:!0},id:{type:String,default:"0"},buyerTaxNo:{type:String,default:""},flowtaskid:{type:String,default:""}},emits:["update:id","update:buyerTaxNo","update:new","update:flowtaskid"],setup(Ae,{expose:Ge,emit:Qe}){const x=p("ajax"),t=p("utils"),P=p("qs");p("config"),p("getTableData"),p("postSaleDetail");const We=p("dialogShow"),ke=p("index_openmenu"),re=p("index_removetab"),N=p("index_refreshtab"),ie=p("index_dialogshow"),ue=p("index_regcomponent"),_e=p("index_userinfo"),$e=n({prop:"",order:"ascending"});n(t.getPager($e.value)),n([]);const de=n([]),$=n("01"),ce=n(""),K=n(!1),Te=n(""),Ke=n([{id:"01",label:"全电专用发票"},{id:"02",label:"全电普通发票"}]),ze=Qe,v=Ae;function fe(e){return Ja({get:()=>v[e],set:l=>{ze(`update:${e}`,l)}})}const O=fe("id"),j=fe("new"),xe=fe("flowtaskid"),me=n(),Xe=()=>{ge()},Ie=n(t.query("name",v.query));var Ce=t.query("formid",v.query);const z=t.length(t.query("programid",v.query))>0?p("programrun_programcomponentref"):n(null),Ye=S=="1"&&D!="1"?p("indexm_refreshpage"):null,Ze=p("index_dialogcomponentId"),ea=p("index_dialogcomponentquery"),b=n(!1),M=n(!1),Ne=n(!1),X=n(""),Y=n(""),aa=t.query("stepid",v.query),la=t.query("taskid",v.query),Se=t.query("instanceid",v.query),pe=n(null),J=n("");var Ce=t.query("formid",v.query),ta=t.query("isminiprogram",v.query),D=t.query("isapp",v.query),Z=t.query("isemail",v.query);const oa=n([]),E=n([]),sa=n([]),g=n({}),m=n({}),na=n(null),ra=n("");t.query("display",v.query);var y=t.query("openmode",v.query)||"0",S=t.query("ismobile",v.query);const k=n({}),ee=n("");localStorage.getItem("sobInfo")!=""&&(ee.value=JSON.parse(localStorage.getItem("sobInfo")));const H=n(!0),ia=n(null),Fe=n({id:""}),u=n({invoiceTypeCode:$.value,serialNo:"",buyerName:"",buyerTaxNo:"",buyerEmail:"",sellerName:[],sellerid:[],sellerTaxNo:"",remarks:""});Le(()=>{Ra(()=>{ga()}),ge(),ue("503254660329541","/Invoice/components/Editmobile.vue")}),Ua(()=>{window.removeEventListener("resize",he,!1)});const ua={buyerName:[{required:!0,message:"请输入购方名称",trigger:"blur"}],buyerTaxNo:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"}]};function da(){ne.confirm("确定要作废吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x.post("/Invoice/DeleteAll",P.stringify({id:O.value})).then(e=>{const l=e.success?"success":"error";t.msg(e.msg,l,!1),e.success&&N()}).catch(()=>{})}).catch(()=>{})}const ca=n([{prop:"id",align:"center",show:!1,useTemplate:!1},{prop:"goodsLineNo",label:"序号",align:"center",useTemplate:!1,show:!1,width:"60"},{prop:"goodsCode",label:"商品编号",show:!0,useTemplate:!0,align:"center",width:"200"},{prop:"goodsName",label:"商品名称",show:!0,useTemplate:!0,align:"center",width:"160"},{prop:"goodsSpecification",label:"规格型号",show:!0,useTemplate:!0,align:"center",width:"180"},{prop:"goodsUnit",label:"单位",show:!0,align:"center",useTemplate:!0,width:"100"},{prop:"goodsQuantity",label:"数量",show:!0,align:"center",useTemplate:!0,width:"120"},{prop:"goodsPrice",label:"单价",show:!0,align:"center",useTemplate:!1,width:"120"},{prop:"goodsTotalPrice",label:"价税合计",show:!0,align:"right",useTemplate:!0,width:"120"},{prop:"goodsTotalTax",label:"税额",show:!0,useTemplate:!1,align:"center",width:"150"},{prop:"goodsTaxRate",label:"税率/征收率",show:!0,align:"center",useTemplate:!0,minWidth:"150%"},{prop:"invoiceLineNature",label:"发票行性质",show:!1,align:"center",useTemplate:!0,width:"200"},{prop:"discountRate",label:"折扣率",show:!1,align:"center",useTemplate:!0,width:"200"},{prop:"discountAmount",label:"折扣额",show:!1,align:"center",useTemplate:!0,width:"200"}]),ve=async()=>{try{const e=await x.post("user/GetUserInvoiceDepartByUser",P.stringify({userid:_e.value.userId}));e.success&&(de.value=e.data)}catch{}};function ge(){if(Ie.value=="流程"){let e=JSON.parse(localStorage.getItem("task"));Fe.value=JSON.parse(localStorage.getItem("tasks")),ce.value=localStorage.getItem("FristStepId"),K.value=!0,H.value=!1,e.stepId===localStorage.getItem("FristStepId")?b.value=!1:b.value=!0,De(),be(localStorage.getItem("formid")),ve(),u.value={invoiceTypeCode:$.value,customercode:"",customername:"",serialNo:"",buyerName:"",buyerTaxNo:"",buyerEmail:"",sellerName:[],sellerid:[],sellerTaxNo:"",remarks:""};const l=p("flowrun_form");p("flowrun_step");const s=l.value.formData;n(null),l.value.formRules,Le(()=>{s.formAttrJson={dbConn:t.emptyLong+"",dbTable:"rf_form_test",dbTablePrimaryKey:"id"}})}j.value==!0?(H.value=j.value,K.value=!1,u.value={invoiceTypeCode:$.value,customercode:"",customername:"",serialNo:"",buyerName:"",buyerTaxNo:"",buyerEmail:"",sellerName:[],sellerid:[],sellerTaxNo:"",remarks:""},xe.value="0",He(),be(O.value),ve()):j.value==!1&&Ie.value!="流程"&&(H.value=j.value,K.value=!1,u.value={invoiceTypeCode:$.value,customercode:"",customername:"",serialNo:"",buyerName:"",buyerTaxNo:"",buyerEmail:"",sellerName:[],sellerid:[],sellerTaxNo:"",remarks:""},K.value=!1,He(),be(O.value),ve())}function fa(e){let l=de.value.find(s=>s.id===e);l&&(u.value.sellerName=l.label,u.value.sellerTaxNo=l.taxno)}const _=n([]),be=async e=>{M.value=!0;try{const l=await x.post("/Invoice/GetInvoiceApply",P.stringify({id:e}));u.value=l.data.invoicemain,O.value=l.data.invoicemain.id,_.value=l.data.invoicedetail}catch{}finally{M.value=!1}};function ma(){x.post("/Flow/GetLongId").then(e=>{Te.value=e.data;const l={goodsLineNo:_.value.length+1,id:Te.value,mainid:O.value,goodsCode:"",goodsName:"",goodsSpecification:"",goodsUnit:"",goodsQuantity:"",goodsPrice:"0",goodsTotalPrice:"",goodsTaxRate:"",goodsTotalTax:"",invoiceLineNature:0,discountRate:"0",discountAmount:"0"};_.value.push(l)}).catch(()=>{})}function pa(e){ne.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.value.splice(e,1);for(let l=0;l<_.value.length;l++)_.value[l].goodsLineNo=l+1}).catch(()=>{})}function va({row:e,column:l,rowIndex:s,columnIndex:a}){return{color:"#000",textAlign:"center"}}Pa(()=>_.value,e=>{let l=0,s=0;const a=n(0);e.forEach(o=>{if(l+=Number(o.goodsTotalPrice),s+=Number(o.goodsTotalTax),o.goodsQuantity==""||o.goodsQuantity==null)o.goodsPrice=0;else{let i=(Number(o.goodsTotalPrice)/Number(o.goodsQuantity)).toFixed(2);o.goodsPrice=isNaN(i)?0:i}const r=1+Number(o.goodsTaxRate);a.value=(Number(o.goodsTotalPrice)/Number(r)).toFixed(2),o.goodsTotalTax=(Number(o.goodsTotalPrice)-a.value).toFixed(2),u.value.invoiceTotalPrice=o.goodsTotalPrice-o.goodsTotalTax})},{deep:!0});const he=()=>{if(t.length(programId)>0){let s=t.query("programmodalheight",v.query);formHeight.value=t.length(s)>0&&s>0?s+"px":"auto";return}let e=S=="1"?105:155;g.value.signType>0&&(g.value.display==0||g.value.display==4)&&(e+=46),isPreview&&(e-=105),index_themeset.value.homeType===1&&(e-=46),formHeight.value=window.document.body.offsetHeight-e+"px"},ga=()=>{M.value=!0,x.post("/Flow/GetRun"+J.value).then(e=>{if(e.success){if(t.length(e.data.form)>0)switch(e.data.form.type){case 0:initFormData(e.data),regFormComponent(e.data);break;case 1:initFormData(e.data);let s=e.data.form.address.split("?"),a=s[0],o=s.length>1?s[1]:"",r="formrun-"+t.createGuid(!1);ue(r,a),na.value=r,ra.value=o;break}if(oa.value=e.data.buttons,E.value=t.spliceArrayObj([...e.data.buttons],t.emptyLong+"","id"),E.value.length>2){for(var l=3;l<E.value.length;l++)sa.value.push(E.value[l]);E.value=E.value.slice(0,3)}g.value=e.data.step,m.value=e.data.form}else{let s=e.msg;if(t.length(s)===0)switch(e.code){case 1:s="未找到流程运行时！";break;case 2:s="未找到流程步骤运行时！";break;case 3:s="当前任务正由"+e.data+"处理，请等待！";break;case 4:s="您无权查看当前任务！";break;case 5:s="当前流程"+t.getFlowStatusTitle(parseInt(e.data))+"不能发起新的实例！";break;case 6:s="未找到用户登录信息！";break;case 7:s="未找到当前任务！";break}t.alert(s||"加载错误！","","","error",()=>{re()})}M.value=!1,he(),window.addEventListener("resize",he,!1)}).catch(()=>{})},ae=(e,l,s)=>{if(t.length(programId)>0||t.length(Ce)>0){switch(t.query("save",v.query).toLowerCase()||"close"){case"close":if(t.isDef(z)&&t.isDef(z.value))z.value.dialogShow=!1,z.value.loadData(!1);else switch(y){case"0":re();break;case"1":t.isDef(ie.value)&&(ie.value=!1);break;case"2":case"3":window.close();break}break;case"refresh":switch(y){case"0":N();break;case"2":case"3":var a=window.location.href;window.location.href=a;break}break}return}if(e.code!=0||l==="Copyfor"||l==="Solicitopinion"||l==="AddWrite"&&t.length(s.steps)>0&&s.steps[0].addWriteType==0)return;if(t.isDef(N)&&N("Tab_Home"),t.isDef(N)&&(N("170346575288606"),l==="Withdraw"&&N("170346576223936")),l==="Save"){if(e.nextTasks.length>0){const r=e.nextTasks[0];if(S=="1"||Z=="1"||y=="3"||y=="2")window.setTimeout(function(){const i="/flow/run/index?flowid="+r.flowId+"&stepid="+r.stepId+"&taskid="+r.id+"&groupid="+r.groupId+"&instanceid="+r.instanceId+"&ismobile="+S+"&isapp="+D+"&isemail="+Z+"&openmode="+y;window.location.href="?loadurl="+encodeURIComponent(i)+"&title="+encodeURIComponent(r.title)},100);else{const i="/flow/run/index?flowid="+r.flowId+"&stepid="+r.stepId+"&taskid="+r.id+"&groupid="+r.groupId+"&instanceid="+r.instanceId+"&ismobile="+S+"&isapp="+D+"&isemail="+Z+"&openmode="+y;je(i)}}return}if(S=="1"){if(ta=="1"){window.setTimeout(function(){var r=window.location.href;window.location.href=r},100);return}if(D=="1"){window.parent.postMessage({msg:"refresh"},"*");return}indexm_openurl(void 0,"/mobile/flow/todo.vue");return}if(Z=="1"||y=="3"||y=="2"){window.setTimeout(function(){var r=window.location.href;window.location.href=r},100);return}if(y=="1"){ie.value=!1;return}y=="0"&&re();let o=_e.value.userId;if(t.length(e.nextTasks)>0){let r=null;for(let i=0;i<e.nextTasks.length;i++)if(e.nextTasks[i].receiverId==o&&e.nextTasks[i].status==0){r=e.nextTasks[i];break}t.isDef(r)&&ke({title:r.title,id:"task_"+r.id,url:"/flow/run/index?flowid="+r.flowId+"&stepid="+r.stepId+"&taskid="+r.id+"&groupid="+r.groupId+"&instanceid="+r.instanceId,ico:"Edit",openMode:y,closable:!0})}},le=(e,l)=>{const s=e.code;let a="";if(s==0){switch(l.toLowerCase()){case"save":a="已保存！";break;case"saveprogram":a="保存成功！";break;case"submit":case"freesubmit":t.length(e.sendMessage)>0?a=e.sendMessage:t.length(e.receiveHandler)>0?a="已发送到："+e.receiveHandler:e.stepPass?e.stepCountersignPass?e.flowCompleted?a="已完成！":a="已发送！":a=e.nextTasks.length==0?"已完成，等待其他步骤处理！":"已发送，等待其他步骤处理！":a=e.nextTasks.length==0?"已完成，等待他人处理！":"已发送，等待他人处理！";break;case"back":t.length(e.backMessage)>0?a=e.backMessage:t.length(e.receiveHandler)>0?a="已退回到："+e.receiveHandler:e.backPass?a="已退回！":a="已退回，等待他人处理！";break;case"known":a="已完成！";break;case"postpone":a="已暂缓！";break;case"end":a="已终止！";break;case"copyfor":a=t.length(e.receiveHandler)>0?"已抄送给："+e.receiveHandler:"已抄送！";break;case"solicitopinion":a=t.length(e.receiveHandler)>0?"已向："+e.receiveHandler+"征求意见！":"已征求意见！";break;case"reply":a="已回复！";break;case"redirect":a=t.length(e.receiveHandler)>0?"已转交给："+e.receiveHandler:"已转交！";break;case"addwrite":a=t.length(e.receiveHandler)>0?"已发送给："+e.receiveHandler+" 加签！":"已加签！";break;case"withdraw":a="已撤回！";break;default:a="处理成功！";break}return a}switch(s){case 1:a="参数错误！";break;case 2:a="流程id错误！";break;case 3:a="未知的处理类型！";break;case 4:a="未找到流程运行时实体！";break;case 5:a="未找到当前步骤运行时实体！";break;case 6:a="您不能处理该任务！";break;case 7:a="当前任务已处理，不能再次处理！";break;case 8:a="处理人为空！";break;case 9:a="当前流程不能发起新的任务！";break;case 10:a="未找到要处理的任务！";break;case 11:a="当前实例组任务为空！";break;case 12:a="保存表单数据时发生了错误！";break;case 1001:a=e.message;break;case 1002:a="发起子流程发生了错误！";break;case 1003:a="子流程对应的任务未完成，不能提交！";break;case 1100:a="未找到要抄送的步骤！";break;case 1101:a="抄送接收人为空！";break;case 1200:a="未找到要征求意见的步骤！";break;case 1201:a="征求意见接收人为空！";break;case 1300:a="未找到要转交的步骤！";break;case 1301:a="转交接收人为空！";break;case 1400:a="未找到要加签的步骤！";break;case 1401:a="加签接收人为空！";break;case 1500:a="不是发起人不能作废流程实例！";break;case 1501:a="作废流程实例发生错误！";break;case 2e3:a="当前步骤设置为不能退回！";break;case 2001:a=e.message;break;case 2002:a="退回没有找到接收人！";break;case 3e3:a="处理流程发生了错误！";break;case 5006:a="任务已处理，不能撤回！";break}return a},qe=n(""),Oe=n(""),Ve=n("开票申请"),Re=n(),Ue=n(),ba=(e,l)=>{const s={type:e,flowId:X.value,stepId:aa,taskId:la,groupId:Y.value,instanceId:Se,isMobile:S,steps:l||[],comment:g.value.comment,attachment:g.value.attachment,sign:g.value.sign};if(g.value.archive==1&&(m.value.formData.archiveFormSelectOptions=m.value.formSelectOptions),t.hasKey(m.value.formData,"serialNumber")&&t.length(m.value.formData.serialNumber)>0)for(let a=0;a<m.value.formData.serialNumber.length;a++){let o=m.value.formData.serialNumber[a],r=[];for(let i=0;i<o.serials.length;i++){let V=o.serials[i].data;if(t.length(V)===0)continue;new Function("formData",V)(m.value.formData)||r.push(i)}for(let i=0;i<r.length;i++)o.serials.splice(r[i],1)}x.post("/Flow/FlowExecute?srcorgid="+ee.value.id+J.value,P.stringify({json:JSON.stringify(s),formData:JSON.stringify(m.value.formData),id:O.value,isapply:"1",formtype:Ve.value,billJson:JSON.stringify(Ue.value)})).then(a=>{if(k.value=a.data.currentTaskModel,k.value.entrustUserId==null&&(k.value.entrustUserId=0),k.value.mainTaskId==null&&(k.value.mainTaskId=0),qe.value=a.data.currentTaskModel.stepId,Oe.value=a.data.currentTaskModel.id,a.success){const o=a.data;te(),t.length(programId)>0?(t.msg(le(o,e),o.code==0),ae(o,e,s)):t.alert(le(o,e),"","",o.code==0,()=>{ae(o,e,s)})}else t.msg("执行流程发生了错误！",!1);Ne.value=!1,M.value=!1}).catch(()=>{Ne.value=!1,M.value=!1})},ha=(e,l)=>{const s={type:e,flowId:X.value,stepId:qe.value,taskId:Oe.value,groupId:Y.value,instanceId:Se,isMobile:S,steps:l||[],comment:g.value.comment,attachment:g.value.attachment,sign:g.value.sign};if(g.value.archive==1&&(m.value.formData.archiveFormSelectOptions=m.value.formSelectOptions),t.hasKey(m.value.formData,"serialNumber")&&t.length(m.value.formData.serialNumber)>0)for(let a=0;a<m.value.formData.serialNumber.length;a++){let o=m.value.formData.serialNumber[a],r=[];for(let i=0;i<o.serials.length;i++){let V=o.serials[i].data;if(t.length(V)===0)continue;new Function("formData",V)(m.value.formData)||r.push(i)}for(let i=0;i<r.length;i++)o.serials.splice(r[i],1)}x.post("/Flow/FlowExecute?srcorgid="+ee.value.id+J.value,P.stringify({istj:"0",isapply:"1",formtype:Ve.value,json:JSON.stringify(s),formData:JSON.stringify(m.value.formData),id:O.value})).then(a=>{if(k.value=a.data.currentTaskModel,k.value.entrustUserId==null&&(k.value.entrustUserId=0),k.value.mainTaskId==null&&(k.value.mainTaskId=0),a.success){N();const o=a.data;t.length(programId)>0?(t.msg(le(o,e),o.code==0),ae(o,e,s)):t.alert(le(o,e),"","",o.code==0,()=>{ae(o,e,s)})}else t.msg("执行流程发生了错误！",!1)}).catch(()=>{})},Pe=n(!1),wa=n(""),ya=n(""),ka=n(""),_a=n(""),Ta=n(!0),xa=Ma(null),te=()=>{if(g.value.signType>0&&t.length(g.value.comment)===0){t.msg("请填写处理意见！",!1);return}if(g.value.signType>=2&&g.value.sign==0){g.value.signType==3?sign(1):t.msg("请签章！",!1);return}ka.value=J.value,xa.value=Ha,wa.value="确认接收步骤",ya.value=S=="1"?"350px":"600px",_a.value="",Ta.value=!0,Pe.value=!0},Ia=e=>{ha("Submit",e)},Na=async e=>{e&&await e.validate((l,s)=>{l&&(Be(),Re.value=Object.keys(localStorage),Ue.value=Re.value.filter(a=>a.endsWith("JSON")).reduce((a,o)=>{const r=localStorage.getItem(o),i=JSON.parse(r);return a[o]=i,a},{}),ne.confirm("是否保存并提交下一步流程?","提示",{confirmButtonText:"确定",cancelButtonText:"关闭",type:"warning"}).then(()=>{ba("Save")}).catch(()=>{}))})},Sa=async e=>{e&&await e.validate((l,s)=>{l&&Me(0)})};function Me(e){x.post("/Flow/GetLongId").then(l=>{k.value.Id=l.data,Je(e)}).catch(()=>{})}function Je(e){u.value.customercode=u.value.buyerName,x.post("Invoice/SaveWithFlow?srcorgid="+ee.value.id,P.stringify({isapply:e,invoiceJSON:JSON.stringify(u.value),invoicedetailsJSON:JSON.stringify(_.value),flowtaskjson:JSON.stringify(k.value)})).then(l=>{l.success==!0&&(We.value=!1,N()),l.code==1&&ne.confirm(l.msg,"提示",{confirmButtonText:"确定",type:"warning"})}).catch(l=>{})}const Ee=()=>{Ca()},je=(e,l)=>{if(S=="1")if(D=="1"){let s=window.location.href;window.location.href=s}else Ye(l,e);else if(y=="2"||y=="3"){let s=window.location.href;window.location.href=s}else if(y=="1"){t.length(e)===0&&(e="/flow/run/index"+(v.query.indexOf("?")===0?"":"?")+v.query);const s="task_"+t.createGuid(!1),a=e.split("?"),o=a[0],r=a.length>1?a[1]:"";ue(s,o),Ze.value=s,ea.value=r}else N(l,e)},De=()=>{x.post("flow/GetFlowTask?flowtaskid="+Fe.value.id+" &isnew="+H.value+"&flowname=开票申请").then(e=>{ce.value=e.data.FristStepId,X.value=e.data.taskmodel.flowId,Y.value=e.data.taskmodel.groupId,B.value=e.data.taskmodel,k.value=e.data.taskmodel,J.value="?flowid="+e.data.taskmodel.flowId+"&openmode=0"}).catch(e=>{})},He=()=>{x.post("flow/GetFlowTask?flowtaskid="+xe.value+" &isnew="+H.value+"&flowname=开票申请").then(e=>{ce.value=e.data.FristStepId,X.value=e.data.taskmodel.flowId,Y.value=e.data.taskmodel.groupId,B.value=e.data.taskmodel,k.value=e.data.taskmodel,J.value="?flowid="+e.data.taskmodel.flowId+"&openmode=0"}).catch(e=>{})},B=n({}),Ca=()=>{const e={id:"task_process_"+t.createGuid(!1),title:B.value.title,url:"/flow/run/process?flowid="+B.value.flowId+"&groupid="+B.value.groupId+"&status=0",openMode:1,width:"1150px",customClass:"el-dialog__padding",center:!1};ke(e)},Fa=async()=>{if(m.value.type==0){const e=pe.value.$refs.roadflowFormRef;if(t.isUndef(e)||t.isFunction(pe.value.formValidate)&&!pe.value.formValidate())return;await e.validate(l=>{l?te():t.msg("表单验证错误，请检查表单必填项等信息！",!1)})}else m.value.type==1?await ia.validate(e=>{e?te():t.msg("表单验证错误，请检查表单必填项等信息！",!1)}):te()};Ge({open:ge,headerCellStyle:va,openflow:Ee,refresh:je,getflowid:De,savecontent:Be,save:Me,savetwo:Je});function Be(){u.value.customercode=u.value.buyerName,localStorage.setItem("invoiceJSON",JSON.stringify(u.value)),localStorage.setItem("invoicedetailsJSON",JSON.stringify(_.value))}return A("flowrun_step",g),A("flowrun_form",u.value),A("flowrun_send",Fa),A("flowrun_sendok",Ia),A("flowrun_dialogshow",Pe),(e,l)=>{const s=I("el-radio"),a=I("el-radio-group"),o=I("el-form-item"),r=I("el-divider"),i=I("el-input"),V=I("el-option"),we=I("el-select"),oe=I("el-form"),R=I("el-button"),qa=I("el-card"),Oa=I("el-affix");return C(),G(Q,null,[T("div",La,[d(oe,{model:u.value,rules:ua,ref_key:"ruleFormRef",ref:me,"label-width":"110px"},{default:c(()=>[d(o,{style:{"margin-bottom":"10px"},label:"发票类型:",prop:"invoiceTypeCode"},{default:c(()=>[h(d(a,{modelValue:u.value.invoiceTypeCode,"onUpdate:modelValue":l[0]||(l[0]=f=>u.value.invoiceTypeCode=f)},{default:c(()=>[(C(!0),G(Q,null,se(Ke.value,f=>(C(),W(s,{label:f.id},{default:c(()=>[F(q(f.label),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.invoiceTypeName),513),[[w,b.value]])]),_:1}),d(o,{style:{"margin-bottom":"20px"},label:"开票流水号:"},{default:c(()=>[T("span",null,q(u.value.serialNo),1)]),_:1}),d(r,{"content-position":"left"},{default:c(()=>[F("购买方信息")]),_:1}),d(o,{label:"购方名称",prop:"buyerName",class:"elitem"},{default:c(()=>[h(d(i,{modelValue:u.value.buyerName,"onUpdate:modelValue":l[1]||(l[1]=f=>u.value.buyerName=f)},null,8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.buyerName),513),[[w,b.value]])]),_:1}),d(o,{label:"纳税人识别号",prop:"buyerTaxNo",class:"elitem"},{default:c(()=>[h(d(i,{modelValue:u.value.buyerTaxNo,"onUpdate:modelValue":l[2]||(l[2]=f=>u.value.buyerTaxNo=f)},null,8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.buyerTaxNo),513),[[w,b.value]])]),_:1}),d(o,{label:"邮箱",prop:"buyerEmail",class:"elitem"},{default:c(()=>[h(d(i,{modelValue:u.value.buyerEmail,"onUpdate:modelValue":l[3]||(l[3]=f=>u.value.buyerEmail=f)},null,8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.buyerEmail),513),[[w,b.value]])]),_:1}),d(r,{"content-position":"left"},{default:c(()=>[F("销售方信息")]),_:1}),d(o,{label:"销售方名称",prop:"sellerid",class:"elitem"},{default:c(()=>[h(d(we,{onChange:fa,modelValue:u.value.sellerName,"onUpdate:modelValue":l[4]||(l[4]=f=>u.value.sellerName=f),placeholder:"请选择开票单位",style:{width:"100%"}},{default:c(()=>[(C(!0),G(Q,null,se(de.value,f=>(C(),W(V,{key:f.id,label:f.label,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.sellerName),513),[[w,b.value]])]),_:1}),d(o,{label:"纳税人识别号",prop:"sellerTaxNo",class:"elitem"},{default:c(()=>[T("span",Aa,q(u.value.sellerTaxNo),1)]),_:1}),d(o,{label:"备注",style:{height:"50px"},prop:"remarks"},{default:c(()=>[h(d(i,{type:"textarea",modelValue:u.value.remarks,"onUpdate:modelValue":l[5]||(l[5]=f=>u.value.remarks=f)},null,8,["modelValue"]),[[w,!b.value]]),h(T("span",null,q(u.value.remarks),513),[[w,b.value]])]),_:1})]),_:1},8,["model"]),d(r,{"content-position":"left"},{default:c(()=>[F("商品明细 "),d(R,{type:"primary",size:"small",onClick:ma,icon:ye(ja)},null,8,["icon"])]),_:1}),(C(!0),G(Q,null,se(_.value,(f,L)=>(C(),W(qa,{class:"box-card",shadow:"never"},{header:c(()=>[T("div",Ga,[d(R,{type:"danger",size:"small",onClick:U=>pa(L),icon:ye(Da)},{default:c(()=>[F("删除")]),_:2},1032,["onClick","icon"])])]),default:c(()=>[d(oe,{model:_.value[L],ref_for:!0,ref:"detailRef","label-width":"100px"},{default:c(()=>[(C(!0),G(Q,null,se(ca.value,(U,$a)=>h((C(),W(o,{label:U.label,prop:U.prop},{default:c(()=>[h(d(i,{modelValue:_.value[L][U.prop],"onUpdate:modelValue":Va=>_.value[L][U.prop]=Va},null,8,["modelValue","onUpdate:modelValue"]),[[w,!b.value]]),h(T("span",null,q(_.value[L][U.prop]),513),[[w,b.value]])]),_:2},1032,["label","prop"])),[[w,U.show]])),256))]),_:2},1032,["model"])]),_:2},1024))),256))]),T("div",Qa,[d(Oa,{offset:20,target:".bottom",position:"bottom"},{default:c(()=>[d(R,{type:"warning",onClick:l[6]||(l[6]=f=>Sa(me.value))},{default:c(()=>[F("暂存")]),_:1}),d(R,{type:"primary",onClick:l[7]||(l[7]=f=>Na(me.value))},{default:c(()=>[F("提交")]),_:1}),d(R,{type:"primary",onClick:Xe},{default:c(()=>[F("刷新")]),_:1}),ye(j)?Ea("",!0):(C(),W(R,{key:0,type:"danger",onClick:da},{default:c(()=>[F("作废")]),_:1})),d(R,{type:"success",onClick:Ee},{default:c(()=>[F("查看流程")]),_:1})]),_:1})])],64)}}},nl=Ba(Wa,[["__scopeId","data-v-b7a3f4ce"]]);export{nl as default};
