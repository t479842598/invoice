import{ai as A,aT as c,aF as J,c as k,W as a,bD as l,bF as v,bv as U,a as T,aX as w,aY as X,o as i,H as p,U as s,b9 as f,bi as u,I as Y}from"./_@vue-5ba92de9.js";import{f as h}from"./flow-show-9c68805e.js";import"./_raphael-a934d412.js";import"./__vendor-5e6ac033.js";const $={key:0},L={key:1},K={__name:"process",props:{query:{type:String,default:()=>""}},setup(B){const x=A("ajax"),e=A("utils"),_=B;e.getQuery(_.query);const C=e.query("flowid",_.query),q=e.query("groupid",_.query),E=e.query("status",_.query),b=c([]),y=c(!1),m=c(e.getPager("")),D=c({}),j="flowShowDiv_"+e.query("flowid",_.query),g=c(!1),N=c(null),F=c([]);J(()=>{M()});const I=n=>{n=="1"&&e.length(D.value)===0&&R()},M=()=>{y.value=!0,x.post("/Flow/GetGroupList?groupid="+q+"&status="+E).then(n=>{for(let d=0;d<n.data.length;d++)n.data[d].indexNumber=d+1;b.value=n.data,y.value=!1}).catch(()=>{})},R=()=>{y.value=!0,x.post("/Flow/GetFlowDesignJson?isnew=0&flowid="+C+"&groupid="+q).then(n=>{if(!n.success)e.msg("加载流程图失败！",!1);else{D.value=n.data;const d=e.getTheme();let o;e.isDef(d)&&e.length(d.color)>0&&(o={line:d.color,step:d.color,focus:"#E6A23C",fontSize:14,stepText:""});const r=e.getFlowMaxXY(n.data.steps);h.dialogVisible=g,h.dialogRef=N,h.dialogData=F,h.roaduiUtils=e,h.init(C,r.x+150,r.y+50,o,!1),h.openFlow(n.data,b.value)}y.value=!1}).catch(()=>{})};return(n,d)=>{const o=w("el-table-column"),r=w("el-tag"),H=w("el-table"),S=w("el-tab-pane"),G=w("el-space"),z=w("el-tabs"),V=X("loading");return i(),k("div",null,[a(z,{onTabChange:I},{default:l(()=>[v((i(),p(S,{name:"0",label:"过程列表"},{default:l(()=>[a(H,{data:b.value,stripe:m.value.tableStripe,border:m.value.tableBorder,style:{width:"100%"},"highlight-current-row":m.value.tableHighlightCurrentRow},{default:l(()=>[a(o,{prop:"indexNumber",label:"#",width:"40"}),a(o,{prop:"stepName",label:"步骤","min-width":"100"}),a(o,{prop:"senderName",label:"发送人"}),a(o,{prop:"receiveTime",label:"接收时间",width:"145"}),a(o,{prop:"receiverName",label:"处理人"}),a(o,{prop:"completedTime",label:"完成时间",width:"145"}),a(o,{prop:"handleType",label:"状态","min-width":"100"},{default:l(t=>[t.row.handleType==0?(i(),p(r,{key:0,type:"info",effect:"dark"},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024)):t.row.handleType==1?(i(),p(r,{key:1,color:"#E6A23C",effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024)):(i(),p(r,{key:2,type:"info"},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024))]),_:1}),a(o,{prop:"comment",label:"处理意见","min-width":"100"}),a(o,{prop:"note",label:"备注"},{default:l(t=>[u(e).length(t.row.note)>0?(i(),k("span",$,f(n.note),1)):(i(),k("span",L,[t.row.taskType>0?(i(),p(r,{key:0,color:u(e).getTaskTypeColor(t.row.taskType),effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s(f(u(e).getTaskTypeTitle(t.row.taskType)),1)]),_:2},1032,["color"])):Y("",!0)]))]),_:1})]),_:1},8,["data","stripe","border","highlight-current-row"])]),_:1})),[[V,y.value]]),v((i(),p(S,{name:"1",label:"流程图"},{default:l(()=>[T("div",null,[a(G,{size:"large"},{default:l(()=>[a(r,{color:"#67C23A",effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s("已完成")]),_:1}),a(r,{color:"#E6A23C",effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s("处理中")]),_:1}),a(r,{color:"#909399",effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s("未到达")]),_:1})]),_:1})]),T("div",{style:{overflow:"auto"}},[T("div",{id:j})])]),_:1})),[[V,y.value]])]),_:1}),v(T("div",{onMouseover:d[0]||(d[0]=t=>g.value=!0),onMouseout:d[1]||(d[1]=t=>g.value=!1),ref_key:"dialogRef",ref:N,class:"roadui_flowrun_showprocess"},[a(H,{data:F.value,stripe:"",style:{width:"100%"},"max-height":330},{default:l(()=>[a(o,{width:"85",property:"receiverName",label:"处理人"}),a(o,{width:"143",property:"receiveTime",label:"接收时间"}),a(o,{width:"100",property:"taskType",label:"任务类型"},{default:l(t=>[t.row.taskType>0?(i(),p(r,{key:0,effect:"dark",style:{"margin-right":"8px","border-width":"0"},color:u(e).getTaskTypeColor(t.row.taskType)},{default:l(()=>[s(f(u(e).getTaskTypeTitle(t.row.taskType)),1)]),_:2},1032,["color"])):(i(),p(r,{key:1,type:"info"},{default:l(()=>[s("常规")]),_:1}))]),_:1}),a(o,{width:"143",property:"completedTime",label:"完成时间"}),a(o,{width:"108",property:"handleType",label:"处理类型"},{default:l(t=>[t.row.handleType==0?(i(),p(r,{key:0,type:"info",effect:"dark"},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024)):t.row.handleType==1?(i(),p(r,{key:1,color:"#E6A23C",effect:"dark",style:{"border-width":"0"}},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024)):(i(),p(r,{key:2,type:"info"},{default:l(()=>[s(f(u(e).getTaskHadleTitle(t.row.handleType)),1)]),_:2},1024))]),_:1}),a(o,{property:"comment",label:"处理意见"})]),_:1},8,["data"])],544),[[U,g.value]])])}}};export{K as default};
