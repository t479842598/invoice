import{D as G}from"./_vuedraggable-a473ce37.js";import{ai as f,aF as M,aK as P,aT as _,c as z,a as e,W as i,bD as d,bi as p,aX as r,o as h,H as b,aZ as E,b9 as x,U as g,aw as F}from"./_@vue-5ba92de9.js";import"./__vendor-5e6ac033.js";const H={class:"roadui_setshortuctdiv"},K=e("div",{class:"roadui_note",style:{"margin-bottom":"12px"}},"提示：不能设置没有绑定应用的菜单为快捷菜单。已选择快捷菜单拖拽可排序。",-1),O={cellpadding:"0",cellspacing:"0",border:"0"},R={style:{width:"50%"},valign:"top"},W={class:"roadui_setshortuctlist"},X={class:"roadui_treenode"},Z={class:"roadui_setshortuctbuttd",valign:"middle"},I={valign:"top"},J={class:"roadui_setshortuctlist"},Q=["onDblclick","onClick"],le={__name:"shortuct",setup(Y){const v=f("ajax"),a=f("utils"),N=f("qs");M(()=>{document.body.ondrop=function(t){try{t.preventDefault(),t.stopPropagation()}catch{}},w()}),P(()=>{document.body.ondrop=null});const y=_([]),j={children:"children",label:"title",isLeaf:"isLeaf"};let s=null;const u=_({id:""}),c=_([]),w=()=>{v.post("/Menu/GetUserTree").then(t=>{y.value=t.data,U()}).catch(()=>{})},S=t=>{s=t},k=t=>{u.value=t},T=()=>{if(s===null){a.msg("请选择要添加的菜单！",!1);return}if(a.length(s.url)===0){a.msg("不能设置没有绑定应用的菜单为快捷菜单！",!1);return}if(a.inArray(c.value,s.id,"id")){a.msg("当前菜单已经选择了！",!1);return}c.value.push({id:s.id,title:s.title,title_en:s.title_en,title_tw:s.title_tw})},C=()=>{if(a.length(u.value.id)===0){a.msg("请选择要移出的快捷菜单！",!1);return}a.removeArrayObj(c.value,u.value.id,"id"),u.value={id:""}},o=_(!1),U=()=>{o.value=!0,v.post("/User/GetShortuct").then(t=>{c.value=t.data,o.value=!1}).catch(()=>{o.value=!1})},B=()=>{o.value=!0;let t=[];for(let n=0;n<c.value.length;n++)t.push(c.value[n].id);v.post("/User/SaveShortuct",N.stringify({ids:t.join(",")})).then(n=>{a.msg(n.success?"保存成功！":"保存失败！",n.success),o.value=!1}).catch(()=>{o.value=!1})};return(t,n)=>{const L=r("document"),D=r("el-icon"),V=r("folder"),$=r("el-tree"),q=r("el-scrollbar"),m=r("el-button");return h(),z("div",H,[K,e("table",O,[e("tbody",null,[e("tr",null,[e("td",R,[e("div",W,[i(q,{style:{height:"inherit"}},{default:d(()=>[i($,{data:y.value,props:j,"node-key":"id",ref:"menuTreeRef","highlight-current":"",style:{height:"100%"},"expand-on-click-node":!1,onNodeClick:S},{default:d(l=>[e("div",X,[p(a).length(l.data.ico)===0&&l.node.isLeaf?(h(),b(D,{key:0,class:"roadui_main_tabico"},{default:d(()=>[i(L)]),_:1})):p(a).length(l.data.ico)===0&&!l.node.isLeaf?(h(),b(D,{key:1,class:"roadui_main_tabico"},{default:d(()=>[i(V)]),_:1})):(h(),b(E(l.data.ico),{key:2,class:"roadui_main_tabico"})),e("span",null,x(l.node.label),1)])]),_:1},8,["data"])]),_:1})])]),e("td",Z,[e("div",null,[e("div",null,[i(m,{type:"primary",disabled:o.value,onClick:T},{default:d(()=>[g("添加")]),_:1},8,["disabled"])]),e("div",null,[i(m,{type:"danger",disabled:o.value,onClick:C},{default:d(()=>[g("移出")]),_:1},8,["disabled"])]),e("div",null,[i(m,{type:"primary",disabled:o.value,onClick:B},{default:d(()=>[g("保存")]),_:1},8,["disabled"])])])]),e("td",I,[e("div",J,[i(p(G),{list:c.value,"item-key":"id",animation:200,group:{name:"shortuct",pull:!0}},{item:d(({element:l})=>[e("div",{class:F(`roadui_draggable_item${l.id==u.value.id?" roadui_draggable_itemhover":""}`),onDblclick:A=>{k(l),C()},onClick:A=>k(l)},[e("div",null,x(l.title),1)],42,Q)]),_:1},8,["list"])])])])])])])}}};export{le as default};
