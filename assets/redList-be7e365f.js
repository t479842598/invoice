import{_ as Ne,a as X}from"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import{ai as p,aT as a,aF as ze,b5 as Ee,c as q,a as g,W as o,bD as n,bF as Pe,H as Re,au as Fe,aN as N,aX as m,aY as Le,o as z,U as u,I as $e,F as Be,aV as Ae,P as Oe,b9 as Ye,bi as G,Y as H}from"./_@vue-5ba92de9.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";const Me={class:"form-container"},je={class:"table-container"},Xe={style:{display:"flex","align-items":"center"}},qe=["onClick"],Ge={class:"roadui_pagerdiv"},He={style:{width:"100%",padding:"20px 0 30px 0",display:"flex","justify-content":"space-around"}},We={__name:"redList",setup(Je){const W=H(()=>X(()=>import("./redInvoice-880e380e.js"),["./redInvoice-880e380e.js","./__vendor-5e6ac033.js","./_@vue-5ba92de9.js","./__vendor-693c365c.css","./index-823f4b27.js","./_@element-plus-ad4c9002.js","./_crypto-js-0812dcff.js","./_element-plus-8c7ce171.js","./_@popperjs-c75af06c.js","./_element-plus-7d03f811.css","./_pdfjs-dist-c04561eb.js","./_@microsoft-43c4e133.js","./_vue-codemirror-50da885a.js","./index-2ccff9e2.css","./redInvoice-7d03c41d.css"],import.meta.url)),E=H(()=>X(()=>import("./viewRedPage-4cfbbd7a.js"),["./viewRedPage-4cfbbd7a.js","./NumMoneyToChinese-d97b4b18.js","./__vendor-5e6ac033.js","./_@vue-5ba92de9.js","./__vendor-693c365c.css","./index-823f4b27.js","./_@element-plus-ad4c9002.js","./_crypto-js-0812dcff.js","./_element-plus-8c7ce171.js","./_@popperjs-c75af06c.js","./_element-plus-7d03f811.css","./_pdfjs-dist-c04561eb.js","./_@microsoft-43c4e133.js","./_vue-codemirror-50da885a.js","./index-2ccff9e2.css","./viewRedPage-f4eb9df4.css"],import.meta.url)),x=p("ajax"),d=p("utils"),J=p("index_openmenu"),C=a("");localStorage.getItem("sobInfo")!=""&&(C.value=JSON.parse(localStorage.getItem("sobInfo")));const K=p("config"),V=p("qs");p("index_openmenu"),p("index_removetab"),p("index_refreshtab");const k=a(!1),D=a(!1),Q=a(""),P=a(!1),Z=a("");a(""),a();const ee=a(""),le=a(""),ae=a(""),oe=a(""),te=a(""),ne=a(""),ie=a(""),S=a(!1),se=a(""),re=a(""),R=a(""),F=a(!0),_=a({emailcode:""});a(""),a("");const L=a(!1),y=a({no:"",invoiceDate:""});a(""),a("");const de=a({prop:"",order:"ascending"}),i=a(d.getPager(de.value)),$=a([]),B=a(""),A=a("");ze(()=>{f(!1)});const ue=[{prop:"redConfirmSerialNo",label:"开票流水号",template:!0},{prop:"redConfirmNo",label:"红字确认单编号"},{prop:"redInvoiceNo",label:"红字发票号"},{prop:"confirmState",label:"确认单状态"},{prop:"invoiceDate",label:"开具日期"},{prop:"invoiceTotalPriceTax",label:"价税合计"},{prop:"invoiceTotalPrice",label:"无税金额"},{prop:"invoiceTotalTax",label:"税额"},{prop:"sellerTaxName",label:"销售方名称"},{prop:"sellerTaxNo",label:"销方税号"},{prop:"buyerTaxName",label:"购方名称"},{prop:"buyerTaxNo",label:"购方税号"},{prop:"originalInvoiceNo",label:"蓝字发票号"},{prop:"remarks",label:"备注"},{prop:"msg",label:"错误提示"}],c=a({}),f=t=>{t&&(i.value.number=1),D.value=!0,k.value=!0,c.value.size=i.value.size,c.value.number=i.value.number,c.value.order=i.value.order,x.post("/Invoice/GetRedList?srcorgid="+C.value.id,V.stringify(c.value)).then(e=>{$.value=e.data.rows,i.value.total=e.data.total,k.value=!1,D.value=!1}).catch(()=>{k.value=!1,D.value=!1})},T=a(""),ce=t=>{T.value=t,i.value.number=1,ve.value=E,I.value="发票详情",U.value=!0},me=t=>{x.post("/Invoice/GetFormat",V.stringify({id:t.id})).then(e=>{e.success?(d.msg(e.msg,"success",!1),getTableData(!1)):d.msg(e.msg,"warning",!1)}).catch(e=>{})},pe=(t,e,v,r)=>{if(!d.isEmail(t)){d.msg("邮箱格式不正确","error",!1);return}if(_.value.emailcode==""){d.msg("邮箱号码不能为空","error",!1);return}x.post("/Invoice/Send?srcorgid="+C.value.id,V.stringify({receiver:e,sendType:4,email:t,connid:v,id:r,ists:1,title:oe.value+se.value,contents:"尊敬的客户：<br>给您开具的数电发票下载链接为：<a href="+R.value+">点击下载</a><br><br><br>购买方名称:"+ae.value+"<br>发票号码: "+te.value+"<br>开具日期: "+ne.value+"<br>价税合计: ￥"+ie.value+"<br><br><br><br><hr>"+re.value})).then(s=>{R.value="",le.value="";const b=s.code==0?"success":"error";s.code==0&&(S.value=!1,getTableData(!0)),d.notify("",s.msg,b)}).catch(s=>{})},I=a(""),ve=Ee(null),O=a(!1),fe=a("下载文件"),h=a(!1),be=a(""),ge=a(""),U=a(!1),_e=a(""),ye=a("");function we(){d.NewshowFile(J,{name:be.value,id:ge.value},K.SERVER_WEBADDRESS,!1)}function xe(){let t=document.createElement("a");t.style.display="none",t.href=_e.value,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ce(){let t=document.createElement("a");t.style.display="none",t.href=ye.value,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Ve(t){x.post("/Invoice/AddRedInvoice?srcorgid="+C.value.id,V.stringify({id:t.id,blueid:t.blueid})).then(e=>{d.msg(e.msg,"success",!1),f(!1)}).catch(e=>{})}const ke=t=>{i.value.size=t,f(!1)},De=t=>{i.value.number=t,f(!1)};function he({row:t,column:e,rowIndex:v,columnIndex:r}){return{color:"#000",textAlign:"center"}}return N("RedShow",h),N("getTableData",f),N("submit_dialogshow",h),(t,e)=>{const v=m("el-input"),r=m("el-form-item"),s=m("el-button"),b=m("el-form"),Y=m("el-table-column"),Se=m("el-table"),Te=m("el-pagination"),w=m("el-dialog"),Ie=m("el-date-picker"),Ue=Le("loding");return z(),q("div",null,[g("div",Me,[o(b,{inline:!0,model:c.value},{default:n(()=>[o(r,{label:"单位名称"},{default:n(()=>[o(v,{modelValue:c.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>c.value.name=l),style:{width:"230px"},clearable:""},null,8,["modelValue"])]),_:1}),o(r,{label:"纳税人识别号"},{default:n(()=>[o(v,{modelValue:c.value.taxno,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value.taxno=l),style:{width:"230px"},clearable:""},null,8,["modelValue"])]),_:1}),o(r,null,{default:n(()=>[o(s,{type:"primary",onClick:e[2]||(e[2]=l=>f(!0)),icon:"Search"},{default:n(()=>[u("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),g("div",je,[Pe((z(),Re(Se,Fe({data:$.value,stripe:i.value.tableStripe,border:"","highlight-current-row":i.value.tableHighlightCurrentRow,style:{width:"100%",color:"#000"},"header-cell-style":he},t.$attrs,{onCurrentChange:t.tableCurrentChange}),{default:n(()=>[u(" > "),$e("",!0),(z(),q(Be,null,Ae(ue,(l,M)=>o(Y,{fit:"","show-overflow-tooltip":"","min-width":"200%",key:M,prop:l.prop,label:l.label,align:"center",width:l.width},Oe({_:2},[l.template?{name:"default",fn:n(j=>[g("div",Xe,[g("a",{onClick:Ke=>ce(j.row.id),style:{"margin-left":"10px"}},Ye(j.row.redConfirmSerialNo),9,qe)])]),key:"0"}:void 0]),1032,["prop","label","width"])),64)),o(Y,{label:"操作",fixed:"right",align:"center",width:"100"},{default:n(l=>[o(s,{type:"primary",size:"small",onClick:M=>Ve(l.row)},{default:n(()=>[u("开具")]),_:2},1032,["onClick"])]),_:1})]),_:1},16,["data","stripe","highlight-current-row","onCurrentChange"])),[[Ue,D.value]]),g("div",Ge,[o(Te,{currentPage:i.value.number,"onUpdate:currentPage":e[3]||(e[3]=l=>i.value.number=l),"page-size":i.value.size,"onUpdate:pageSize":e[4]||(e[4]=l=>i.value.size=l),"page-sizes":i.value.sizes,background:i.value.background,layout:i.value.layout,total:i.value.total,disabled:k.value,onSizeChange:ke,onCurrentChange:De},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])]),o(w,{modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=l=>U.value=l),fullscreen:P.value,style:{position:"relative"},title:I.value,"align-center":"","destroy-on-close":"",width:"1200px",onClose:e[8]||(e[8]=l=>P.value=!1),draggable:"","close-on-click-modal":!1},{default:n(()=>[o(G(E),{id:T.value,"onUpdate:id":e[5]||(e[5]=l=>T.value=l),readonly:F.value,"onUpdate:readonly":e[6]||(e[6]=l=>F.value=l)},null,8,["id","readonly"])]),_:1},8,["modelValue","fullscreen","title"]),o(w,{modelValue:h.value,"onUpdate:modelValue":e[11]||(e[11]=l=>h.value=l),title:I.value,"align-center":"","destroy-on-close":"",width:"1400px",draggable:"","close-on-click-modal":!1},{default:n(()=>[o(G(W),{id:B.value,"onUpdate:id":e[9]||(e[9]=l=>B.value=l),blueid:A.value,"onUpdate:blueid":e[10]||(e[10]=l=>A.value=l)},null,8,["id","blueid"])]),_:1},8,["modelValue","title"]),o(w,{modelValue:O.value,"onUpdate:modelValue":e[15]||(e[15]=l=>O.value=l),style:{position:"relative"},title:fe.value,"align-center":"","destroy-on-close":"",width:"600px",draggable:"","close-on-click-modal":!1},{default:n(()=>[g("div",He,[o(s,{size:"large",type:"primary",onClick:e[12]||(e[12]=l=>xe()),round:""},{default:n(()=>[u("OFD下载")]),_:1}),o(s,{size:"large",type:"danger",onClick:e[13]||(e[13]=l=>we()),round:""},{default:n(()=>[u("PDF下载")]),_:1}),o(s,{size:"large",type:"success",onClick:e[14]||(e[14]=l=>Ce()),round:""},{default:n(()=>[u("XML下载")]),_:1})])]),_:1},8,["modelValue","title"]),o(w,{modelValue:S.value,"onUpdate:modelValue":e[18]||(e[18]=l=>S.value=l),title:"推送客户邮箱","align-center":"","destroy-on-close":"",width:"500px"},{default:n(()=>[o(b,{model:_.value,class:"inline","label-width":"100px"},{default:n(()=>[o(r,{label:"邮箱号码"},{default:n(()=>[o(v,{modelValue:_.value.emailcode,"onUpdate:modelValue":e[16]||(e[16]=l=>_.value.emailcode=l),style:{width:"300px"}},null,8,["modelValue"])]),_:1}),o(r,null,{default:n(()=>[o(s,{type:"primary",onClick:e[17]||(e[17]=l=>pe(_.value.emailcode,Q.value,Z.value,ee.value))},{default:n(()=>[u("发送")]),_:1}),o(s,{type:"success",onClick:t.closeDialog},{default:n(()=>[u("取消")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(w,{modelValue:L.value,"onUpdate:modelValue":e[21]||(e[21]=l=>L.value=l),title:"发票号修改","align-center":"","destroy-on-close":"",width:"500px"},{default:n(()=>[o(b,{model:y.value,class:"inline","label-width":"100px"},{default:n(()=>[o(r,{label:"发票号"},{default:n(()=>[o(v,{modelValue:y.value.no,"onUpdate:modelValue":e[19]||(e[19]=l=>y.value.no=l),style:{width:"210px"}},null,8,["modelValue"])]),_:1}),o(r,{label:"开票日期"},{default:n(()=>[o(Ie,{modelValue:y.value.invoiceDate,"onUpdate:modelValue":e[20]||(e[20]=l=>y.value.invoiceDate=l),type:"date","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),o(r,null,{default:n(()=>[o(s,{type:"primary",onClick:me},{default:n(()=>[u("保存")]),_:1}),o(s,{type:"success",onClick:t.closeDialog},{default:n(()=>[u("取消")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])])}}},rl=Ne(We,[["__scopeId","data-v-e71cdca2"]]);export{rl as default};
