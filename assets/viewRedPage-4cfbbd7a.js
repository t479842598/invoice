import{u as U}from"./NumMoneyToChinese-d97b4b18.js";import"./__vendor-5e6ac033.js";import{_ as G}from"./index-823f4b27.js";import{ai as f,aT as l,aF as J,bm as P,by as X,c as D,a as e,W as s,bD as n,U as m,b9 as a,bF as Y,H as A,bi as K,aX as d,aY as Z,o as y,F as $,aV as ee,P as te,aP as oe,aM as ie}from"./_@vue-5ba92de9.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";const x=c=>(oe("data-v-b2dfa2e5"),c=c(),ie(),c),ae={class:"main-page"},le={class:"top"},ne={style:{position:"absolute",left:"0px",top:"0"}},se={class:"image-slot"},re=x(()=>e("div",{class:"top-div"},[e("div",{style:{"font-size":"28px"}},"电子发票（普通发票）"),e("div",{style:{border:"1.1px solid #AD7353","margin-top":"8px"}}),e("div",{style:{border:"1.1px solid #AD7353","margin-top":"3px"}})],-1)),de={style:{position:"absolute",top:"40px",right:"50px"}},ce={style:{width:"fit-content","text-align":"right",color:"#AD7353"}},pe={style:{"font-size":"14px",color:"#585859"}},ge={style:{width:"fit-content","text-align":"right",color:"#AD7353"}},ue={style:{"font-size":"14px",color:"#585859"}},he={style:{width:"fit-content","text-align":"right",color:"#AD7353"}},_e={style:{"font-size":"14px",color:"red"}},fe={border:"1",cellpadding:"1",cellspacing:"1",style:{"line-height":"50px","border-color":"#AD7353","border-width":"1.3px",color:"#AD7353",width:"100%","margin-bottom":"0","font-family":"'STSong'","font-weight":"600"},class:"table maintable"},me={style:{height:"100px !important"}},xe=x(()=>e("td",{class:"vertical-text",style:{"font-weight":"bolder",width:"30px !important"}}," 购买方信息",-1)),ve={colspan:"3",width:"257",style:{padding:"15px 10px 0px 10px"}},be={style:{"font-size":"12px",color:"#585859"}},ye={style:{"font-size":"12px",color:"#585859"}},we=x(()=>e("td",{class:"vertical-text",style:{"font-weight":"bolder",width:"30px !important"}}," 销售方信息",-1)),Te={colspan:"3",width:"243",style:{padding:"15px 10px 0px 10px"}},Ne={style:{"font-size":"12px",color:"#585859"}},Se={style:{"font-size":"12px",color:"#585859"}},Ie={border:"",style:{width:"100%",height:"30px","font-family":"'STSong'","font-weight":"600",border:"0px solid #AD7353 !important","border-spacing":"0","border-top":"0px",color:"#AD7353"}},Pe=x(()=>e("td",{style:{width:"30%","text-align":"center","font-family":"'STSong'","font-weight":"600","font-size":"12px"}}," 价税合计（大写） ",-1)),De={style:{"font-family":"'STSong'","font-weight":"600",display:"flex","align-items":"center","justify-content":"space-between","min-width":"400px"}},Ae={style:{width:"calc(100% - 200px)","text-align":"left",height:"30px","font-size":"12px",color:"#585859","line-height":"30px","margin-left":"30px"}},ze={style:{"line-height":"30px","margin-right":"50px"}},Fe={style:{"font-size":"12px",color:"#585859"}},Re={border:"",style:{width:"100%",height:"160px","font-family":"'STSong'","font-weight":"600",border:"0px solid #AD7353 !important","border-spacing":"0","border-top":"0px",color:"#AD7353","font-size":"12px"}},Ce=x(()=>e("td",{style:{width:"30px","writing-mode":"vertical-rl","vertical-align":"middle","text-align":"center"}},"备注",-1)),Le={style:{padding:"12px","vertical-align":"top"}},ke={style:{"font-size":"12px",color:"#585859"}},Me={__name:"viewRedPage",props:{id:{},idModifiers:{},blueid:{},blueidModifiers:{}},emits:["update:id","update:blueid"],setup(c,{expose:z}){const F=f("ajax"),R=f("utils"),C=f("qs");f("config"),f("index_refreshtab");const N=l({prop:"goodsLineNo",order:"ascending"}),S=l(R.getPager(N.value));l(!1);const w=l(!1),L=l([]),u=l(""),k=l("");localStorage.getItem("sobInfo")!=""&&(k.value=JSON.parse(localStorage.getItem("sobInfo"))),J(()=>{V()});const M=P(c,"id"),j=P(c,"blueid"),o=l({}),B=l([{prop:"goodsName",label:"项目名称",align:"left",width:"200"},{prop:"goodsSpecification",label:"规格型号",align:"left",width:"150"},{prop:"goodsUnit",label:"单位",align:"center"},{prop:"goodsQuantity",label:"数量",align:"right"},{prop:"goodsPrice",label:"单价",align:"right"},{prop:"notaxamount",label:"金额",align:"right"},{prop:"goodsTaxRate",label:"税率/征收率",align:"center"},{prop:"goodsTotalTax",label:"税额",align:"right",width:"110"}]);function Q(){}const V=async()=>{w.value=!0;try{const t=await F.post("/Invoice/GetRedInvoice",C.stringify({id:M.value,blueid:j.value}));Array.isArray(t.data.invoicemain)&&t.data.invoicemain.length>0&&(o.value=t.data.invoicemain[0],t.data.invoicemain[0].redInvoiceLabel=="01"?u.value="开票有误":t.data.invoicemain[0].redInvoiceLabel=="02"?u.value="销货退回":t.data.invoicemain[0].redInvoiceLabel=="03"?u.value="服务中止":t.data.invoicemain[0].redInvoiceLabel=="04"&&(u.value="销售折让"),T.value=t.data.invoicedetail)}catch{}finally{w.value=!1}},W=t=>{L.value=t},T=l([]);function I({row:t,column:v,rowIndex:h,columnIndex:_}){return{color:"#AD7353",fontFamily:"STSong",textAlign:"center",fontWeight:600,height:"30px",fontSize:"14px",padding:"0"}}X(()=>T.value,t=>{let v=0,h=0,_=0;t.forEach(i=>{if(v+=Number(i.goodsTotalPrice),h+=Number(i.goodsTotalTax),i.goodsQuantity==""||i.goodsQuantity==null)i.goodsPrice=0;else{let b=(Number(i.goodsTotalPrice)/Number(i.goodsQuantity)).toFixed(8);i.goodsPrice=isNaN(b)?0:b}const p=1+Number(i.goodsTaxRate/100);var g=(Number(i.goodsTotalPrice)/Number(p)).toFixed(2);i.goodsTotalTax=(Number(i.goodsTotalPrice)-g).toFixed(2),i.notaxamount=Number(g),_+=Number(g)}),o.value.invoiceTotalPriceTax=Number(v.toFixed(2)),o.value.invoiceTotalTax=Number(h.toFixed(2)),o.value.invoiceTotalPrice=Number(_.toFixed(2))},{deep:!0});function q({row:t}){if(t.goodsTotalPrice===0)return{backgroundColor:"yellow"}}return z({open:Q,headerCellStyle:I}),(t,v)=>{const h=d("Picture"),_=d("el-icon"),i=d("el-image"),p=d("el-form-item"),g=d("el-form"),b=d("el-table-column"),E=d("el-table"),H=Z("loading");return y(),D("div",ae,[e("div",le,[e("div",ne,[s(i,{style:{width:"120px",height:"120px"},src:o.value.base64Image,fit:"scale-down"},{error:n(()=>[e("div",se,[s(_,null,{default:n(()=>[s(h)]),_:1})])]),_:1},8,["src"])]),re,e("div",de,[e("div",ce,[m("发票号码："),e("span",pe,a(o.value.originalInvoiceNo),1)]),e("div",ge,[m("开票日期："),e("span",ue,a(o.value.originInvoiceDate),1)]),e("div",he,[m("红冲原因："),e("span",_e,a(u.value),1)])])]),e("table",fe,[e("tbody",null,[e("tr",me,[xe,e("td",ve,[s(g,{model:o.value,ref:"ruleFormRef"},{default:n(()=>[s(p,{label:"名称:",prop:"buyerName",style:{position:"relative"}},{default:n(()=>[e("span",be,a(o.value.buyerTaxName),1)]),_:1}),s(p,{label:"统一社会信用代码/纳税人识别:",prop:"buyerTaxNo"},{default:n(()=>[e("span",ye,a(o.value.buyerTaxNo),1)]),_:1})]),_:1},8,["model"])]),we,e("td",Te,[s(g,{model:o.value,ref:"ruleFormRef"},{default:n(()=>[s(p,{label:"名称:",prop:"sellerid"},{default:n(()=>[e("span",Ne,a(o.value.sellerTaxName),1)]),_:1}),s(p,{label:"统一社会信用代码/纳税人识别:",prop:"sellerTaxNo"},{default:n(()=>[e("span",Se,a(o.value.sellerTaxNo),1)]),_:1})]),_:1},8,["model"])])])])]),Y((y(),A(E,{class:"eltable show_table",data:T.value,size:"small",stripe:S.value.tableStripe,"highlight-current-row":S.value.tableHighlightCurrentRow,style:{width:"100%",color:"#000"},"header-cell-style":I,"default-sort":N.value,onSelectionChange:W,"row-style":q},{default:n(()=>[(y(!0),D($,null,ee(B.value,r=>(y(),A(b,{prop:r.prop,fit:"","show-overflow-tooltip":"","min-width":r.minWidth,label:r.label,align:r.align,width:r.width},te({_:2},[r.prop==="goodsTaxRate"?{name:"default",fn:n(O=>[m(a(O.row[r.prop])+"%",1)]),key:"0"}:void 0]),1032,["prop","min-width","label","align","width"]))),256))]),_:1},8,["data","stripe","highlight-current-row","default-sort"])),[[H,w.value]]),e("table",Ie,[e("tr",null,[Pe,e("td",De,[e("div",Ae,a(K(U)(o.value.invoiceTotalPriceTax)),1),e("div",ze,[m(" (小写) "),e("span",Fe,"￥"+a(o.value.invoiceTotalPriceTax),1)])])])]),e("table",Re,[e("tr",null,[Ce,e("td",Le,[e("span",ke,a(o.value.remarks),1)])])])])}}},Je=G(Me,[["__scopeId","data-v-b2dfa2e5"]]);export{Je as default};
