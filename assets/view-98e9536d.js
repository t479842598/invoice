import{ai as k,aT as x,aF as Z,c as _,a as e,W as o,bD as s,U as r,bi as p,I as b,H as M,ay as ee,b9 as v,aX as c,o as d,F as te,aV as le}from"./_@vue-5ba92de9.js";const oe={class:"roadui_page"},ne={class:"roadui_toolbar"},se=["disabled"],ie=e("div",null,[e("span",null,"|")],-1),ae={key:0},de=["disabled"],ue={key:1},re=["disabled"],ce={key:2},_e=["disabled"],pe={key:3},ve=["disabled"],me={key:4},be=["disabled"],ye=e("div",null,[e("span",null,"|")],-1),fe={key:5},he=["disabled"],ge=["disabled"],ke={style:{padding:"0 8px","margin-top":"8px"}},xe={cellpadding:"0",cellspacing:"0",border:"0",style:{width:"100%"}},we={style:{"font-size":"16px","font-weight":"bold",height:"40px"}},Ce={style:{height:"40px",color:"var(--el-color-info)"}},De={key:0},Se={key:1},Me=e("tr",null,[e("td",{style:{"border-bottom":"1px dashed var(--el-border-color-light)"}})],-1),Te=["innerHTML"],Ve={key:0},je=e("div",{style:{"margin-top":"8px"}},"附件：",-1),Ee={class:"roadui_note"},qe={key:1,class:"roadui_note"},Be={__name:"view",props:{query:{type:String,default:()=>""}},setup(B){const w=k("ajax"),u=k("utils"),F=k("qs"),f=k("index_openmenu"),C=k("index_removetab"),N=k("config"),T=x(u.getPager({})),V=B,h=u.query("id",V.query),y=u.query("source",V.query),i=x(!1),t=x({});Z(()=>{if(u.length(h)>0){i.value=!0;let a="/Mail/GetViewMail?id="+h+"&source="+y;w.post(a).then(l=>{if(l.code===1){u.msg("要查看的邮件不存在，请刷新列表！",!1),C();return}else if(l.code===-1){u.msg("您无权查看该邮件！",!1),C();return}t.value=l.data,i.value=!1}).catch(()=>{i.value=!1})}});const j=a=>{u.confirm("您确定要"+(a==1?"彻底":"")+"删除邮件吗？",()=>{i.value=!0;let l="";switch(y){case"inbox":l="/Mail/DeleteIn";break;case"outbox":l="/Mail/DeleteDraft";break;case"deleted":l="/Mail/DeleteDeleted";break}w.post(l,F.stringify({ids:h,type:a})).then(g=>{let m=g.msg;u.length(m)===0&&(m=g.success?"删除成功！":"删除失败！"),u.msg(m,g.success),i.value=!1,g.success&&C()}).catch(()=>{i.value=!1})})},L=()=>{const a={title:"回复 - "+t.value.mailSubject,id:"mail_reply_"+t.value.id,url:"/system/mail/send?id="+t.value.id+"&source=inboxreply",ico:"Edit",openMode:0};f(a)},P=()=>{const a={title:"转发 - "+t.value.mailSubject,id:"mail_reply_"+t.value.id,url:"/system/mail/send?id="+t.value.id+"&source=inboxredirect",ico:"Edit",openMode:0};f(a)},R=()=>{const a={title:"转发 - "+t.value.mailSubject,id:"mail_reply_"+t.value.id,url:"/system/mail/send?id="+t.value.id+"&source=deleted",ico:"Edit",openMode:0};f(a)},z=()=>{const a={title:"编辑邮件 - "+t.value.mailSubject,id:"mail_edit_"+t.value.id,url:"/system/mail/send?id="+t.value.id+"&source="+y,ico:"Edit",openMode:0};f(a)},D=x(!1),E=x([]),I=()=>{i.value=!0,w.post("/Mail/GetInboxUsers?id="+h).then(a=>{E.value=a.data,i.value=!1,D.value=!0}).catch(()=>{i.value=!1})},H=()=>{const a={title:"打印 - "+t.value.mailSubject,id:"mail_print_"+h,url:"/system/mail/print1?id="+h+"&source="+y,ico:"Message",openMode:2,width:1e3,height:680};f(a)};return(a,l)=>{const g=c("Printer"),m=c("el-icon"),G=c("ChatLineSquare"),q=c("Position"),O=c("Edit"),W=c("View",!0),A=c("Delete"),X=c("DeleteFilled"),S=c("el-tag"),$=c("el-space"),J=c("el-link"),U=c("el-table-column"),K=c("el-table"),Q=c("el-dialog");return d(),_("div",oe,[e("div",null,[e("div",ne,[e("div",null,[e("button",{disabled:i.value,onClick:l[0]||(l[0]=n=>H()),type:"button"},[o(m,null,{default:s(()=>[o(g)]),_:1}),r("打印")],8,se)]),ie,p(y)==="inbox"?(d(),_("div",ae,[e("button",{disabled:i.value,onClick:l[1]||(l[1]=n=>L()),type:"button"},[o(m,null,{default:s(()=>[o(G)]),_:1}),r("回复")],8,de)])):b("",!0),p(y)==="inbox"?(d(),_("div",ue,[e("button",{disabled:i.value,onClick:l[2]||(l[2]=n=>P()),type:"button"},[o(m,null,{default:s(()=>[o(q)]),_:1}),r("转发")],8,re)])):b("",!0),p(y)==="deleted"?(d(),_("div",ce,[e("button",{disabled:i.value,onClick:l[3]||(l[3]=n=>R()),type:"button"},[o(m,null,{default:s(()=>[o(q)]),_:1}),r("转发")],8,_e)])):b("",!0),p(y)==="outbox"?(d(),_("div",pe,[e("button",{disabled:i.value,onClick:l[4]||(l[4]=n=>z()),type:"button"},[o(m,null,{default:s(()=>[o(O)]),_:1}),r("编辑")],8,ve)])):b("",!0),p(y)==="outbox"?(d(),_("div",me,[e("button",{disabled:i.value,onClick:l[5]||(l[5]=n=>I()),type:"button"},[o(m,null,{default:s(()=>[o(W)]),_:1}),r("阅读情况")],8,be)])):b("",!0),ye,p(y)!=="deleted"?(d(),_("div",fe,[e("button",{disabled:i.value,onClick:l[6]||(l[6]=n=>j(0)),type:"button"},[o(m,null,{default:s(()=>[o(A)]),_:1}),r("删除")],8,he)])):b("",!0),e("div",null,[e("button",{disabled:i.value,onClick:l[7]||(l[7]=n=>j(1)),type:"button"},[o(m,null,{default:s(()=>[o(X)]),_:1}),r("彻底删除")],8,ge)])])]),e("div",ke,[e("table",xe,[e("tr",null,[e("td",we,[t.value.mailType>1?(d(),M(S,{key:0,effect:"dark",style:{"margin-right":"8px","border-width":"0"},type:t.value.mailType===2?"":"success"},{default:s(()=>[r(v(t.value.mailType===2?"抄送":"密送"),1)]),_:1},8,["type"])):b("",!0),r(" 主题："),e("span",{style:ee(p(u).length(t.value.subjectColor)>0?"color:"+t.value.subjectColor:"")},v(t.value.mailSubject),5)])]),e("tr",null,[e("td",Ce,[o($,{size:30},{default:s(()=>[e("span",null,"发件人："+v(t.value.sender)+" - "+v(t.value.senderOrg),1),e("span",null,"日期："+v(t.value.receiveTime),1),p(u).length(t.value.receiveUsers)>0?(d(),_("span",De,"收件人："+v(t.value.receiveUsers),1)):b("",!0),p(u).length(t.value.carbonCopy)>0?(d(),_("span",Se,"抄送："+v(t.value.carbonCopy),1)):b("",!0)]),_:1})])]),Me,e("tr",null,[e("td",null,[e("div",{style:{margin:"12px 0 0 0"},innerHTML:t.value.content},null,8,Te)])]),p(u).length(t.value.files)>0?(d(),_("tr",Ve,[e("td",null,[je,e("div",null,[o($,{size:20},{default:s(()=>[(d(!0),_(te,null,le(t.value.files,(n,Y)=>(d(),_("span",{key:n.id},[o(J,{onClick:$e=>p(u).showFile(p(f),n,p(N).SERVER_WEBADDRESS)},{default:s(()=>[r(v(Y+1)+". "+v(n.name),1)]),_:2},1032,["onClick"])]))),128))]),_:1})])])])):b("",!0)])]),e("div",null,[o(Q,{modelValue:D.value,"onUpdate:modelValue":l[8]||(l[8]=n=>D.value=n),title:"邮件阅读情况","align-center":"","destroy-on-close":"",width:"700px",draggable:""},{default:s(()=>[o(K,{data:E.value,stripe:T.value.tableStripe,border:T.value.tableBorder,style:{width:"100%"}},{default:s(()=>[o(U,{prop:"userName",label:"收件人"},{default:s(n=>[n.row.mailType>1?(d(),M(S,{key:0,effect:"dark",style:{"margin-right":"8px","border-width":"0","vertical-align":"middle"},type:n.row.mailType===2?"":"success"},{default:s(()=>[r(v(n.row.mailType===2?"抄送":"密送"),1)]),_:2},1032,["type"])):b("",!0),e("span",null,v(n.row.userName),1),r(" - "),e("span",Ee,v(n.row.userOrg),1)]),_:1}),o(U,{prop:"readTime",label:"阅读时间",width:"160"},{default:s(n=>[n.row.isRead===0?(d(),M(S,{key:0,type:"info"},{default:s(()=>[r("未读")]),_:1})):(d(),_("span",qe,v(n.row.readTime),1))]),_:1})]),_:1},8,["data","stripe","border"])]),_:1},8,["modelValue"])])])}}};export{Be as default};
