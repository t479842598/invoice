import{d as y}from"./form-design-8c117009.js";import{ai as o,aT as h,aF as S,aK as R,bF as x,c as D,a as u,aY as T,o as I}from"./_@vue-5ba92de9.js";import"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_jquery-3a83ed9f.js";const k=["element-loading-text"],q={valign:"top"},J={__name:"design",props:{query:{type:String,default:()=>""}},setup(E){const c=o("ajax"),a=o("utils"),r=o("config"),w=o("qs"),n=E,i=window.CKEDITOR;let e=null;const f="formdesigneditor_"+a.query("formid",n.query),v=a.query("formid",n.query),m=a.query("isnew",n.query)==="1",p=h(!1),g=h(""),_=o("index_themeset");S(()=>{e=i.replace(f,{allowedContent:!0,entities_greek:!0,height:window.innerHeight-(_.value.homeType===1?218:261),contentsCss:i.basePath+"/from-design.css",image_previewText:r.CKEDITOR_IMAGE_PREVIVETEXT,filebrowserImageUploadUrl:r.SERVER_WEBADDRESS+"/Files/SaveFiles?uploadtype=1&webaddress="+encodeURIComponent(r.SERVER_WEBADDRESS),filebrowserUploadUrl:r.SERVER_WEBADDRESS+"/Files/SaveFiles?uploadtype=1&webaddress="+encodeURIComponent(r.SERVER_WEBADDRESS),toolbarGroups:[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker","editing","cleanup"]},{name:"insert",groups:["insert"]},{name:"paragraph",groups:["list","indent","paragraph"]},{name:"links",groups:["links"]},"/",{name:"styles",groups:["styles"]},{name:"colors",groups:["colors"]},{name:"basicstyles",groups:["align","basicstyles"]},{name:"tools",groups:["tools"]},{name:"about",groups:["about"]},"/",{name:"rf_plugins",groups:["rf_plugins","rf_plugins1"]}],removeButtons:"Flash,Anchor",extraPlugins:"tableresizerowandcolumn,rf_attribute,rf_text,rf_textarea,rf_number,rf_select,rf_cascader,rf_radio,rf_checkbox,rf_switch,rf_hidden,rf_datetime,rf_dictionary,rf_organize,rf_files,rf_appraise,rf_html,rf_label,rf_button,rf_serialnumber,rf_datatable,rf_selectdiv,rf_signature,rf_subtable,rf_script,rf_preview,rf_save,rf_saveas,rf_publish"}),e.on("fileUploadRequest",function(s){s.data.requestData["nroadflow-token"]=a.getToken()}),e.designjs=y,e.utils=a,e.roaduiTools={ajax:c,qs:w,isNew:m,loading:p,loadingText:g},e.iframeQueryString="&nroadflow-token="+a.getToken(),i.on("instanceReady",function(s){var l=s.editor;setTimeout(function(){if(!l.element){setTimeout(arguments.callee,100);return}if(s.removeListener("instanceReady",this.callee),m){e.formAttributeJSON={showMessage:!0,inlineMessage:!1,statusIcon:!1},e.formEventsJSON=[],e.formSubtabsJSON=[];var d=l.getCommand("rf_attribute");d.exec()}else c.post("/Form/GetDesignHtml?formid="+v).then(t=>{if(!t.success){a.msg("获取表单信息失败！",!1);return}e.setData(t.data.html),a.hasKey(t.data.attr,"showMessage")||(t.data.attr.showMessage=!0),a.hasKey(t.data.attr,"inlineMessage")||(t.data.attr.inlineMessage=!1),a.hasKey(t.data.attr,"statusIcon")||(t.data.attr.statusIcon=!1),e.formAttributeJSON=t.data.attr,e.formEventsJSON=t.data.event,e.formSubtabsJSON=t.data.subtable}).catch(()=>{})},0)}),window.addEventListener("resize",b,!1)}),R(()=>{window.removeEventListener("resize",b,!1)});const b=()=>{try{e.resize("100%",window.innerHeight-(_.value.homeType===1?77:130))}catch{}};return(s,l)=>{const d=T("loading");return x((I(),D("table",{cellpadding:"0","element-loading-text":g.value,cellspacing:"0",border:"0",style:{width:"100%"}},[u("tr",null,[u("td",q,[u("div",{ref:"formEditorRef",id:f},null,512)])])],8,k)),[[d,p.value]])}}};export{J as default};
