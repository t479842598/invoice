import{cD as h,cE as l}from"./__vendor-5e6ac033.js";import{E as c}from"./_element-plus-8c7ce171.js";function y(r,f="json"){const e=r.name.split("."),m=e.length>1?e[e.length-1]:"unknown";if(!["xlsx","xlc","xlm","xls","xlt"].some(t=>t===m)){c.error("格式错误！请重新选择");return}const o=new FileReader;return o.readAsArrayBuffer(r,"utf-8"),new Promise(function(t,d){o.onloadend=function(i){const u=i.target.result,n=h(u,{type:"buffer"}),a=n.Sheets[n.SheetNames[0]];let s="";switch(f.toLocaleLowerCase()){case"html":s=l.sheet_to_html(a);break;case"json":s=l.sheet_to_json(a);break;default:c.error("输出类型错误，只能取值为 html或者json")}t(s)}})}export{y as e};
