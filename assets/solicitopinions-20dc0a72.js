import{ai as g,aT as m,c as _,W as t,bD as l,aX as n,aY as Q,o as u,bi as v,U as s,F as X,aV as Y,bF as A,a as o,b9 as p,H as J,I as D}from"./_@vue-5ba92de9.js";const K={border:"0",cellpadding:"0",cellspacing:"0",style:{width:"100%"}},P={style:{padding:"8px 0",width:"28%"},valign:"top"},Z=o("span",{style:{"margin-right":"12px"}},"接收人",-1),ee={style:{padding:"8px 0",width:"36%"},valign:"top"},te=o("span",{style:{"margin-right":"12px"}},"接收时间",-1),le={style:{padding:"8px 0",width:"36%"},valign:"top"},oe={key:0},ae=o("span",{style:{"margin-right":"12px"}},"回复时间",-1),se={key:0},ie={colspan:"3",style:{padding:"8px 0"}},ne={style:{"margin-right":"12px"}},re=o("span",{style:{"margin-right":"12px"}},"说明",-1),de={class:"roadui_note"},ue={key:1},pe={colspan:"3",style:{padding:"8px 0"}},ce=o("span",{style:{"margin-right":"12px"}},"回复",-1),ve={__name:"solicitopinions",props:{query:{type:String,default:()=>""}},setup(F){const T=g("ajax"),r=g("utils"),N=g("ElSelectorg"),B=g("flowrun_solicitopinionsok"),h=g("flowrun_dialogshow"),b=F,O=r.getQuery(b.query),x=r.query("stepid",b.query),U=r.query("ismobile",b.query),d=m(!1),f=m(!1),w=m(null),i=m({}),j={receiver:[{required:!0,message:"请选择接收人",trigger:"blur"}],visibility:[{required:!0,message:"请选择可见性",trigger:"blur"}]},k=m([]),E=()=>{d.value=!0,f.value=!0,T.post("/Flow/GetSolicitOpinions?"+O).then(c=>{k.value=c.data,d.value=!1,f.value=!1}).catch(()=>{d.value=!1,f.value=!1})},I=c=>{c=="1"&&E()},R=async()=>{if(r.length(x)===0){r.msg("未找到步骤！",!1);return}await w.value.validate(c=>{if(c){d.value=!0;let a=[{id:x,members:i.value.receiver,visibility:i.value.visibility,note:i.value.note}];B(a),d.value=!1,h.value=!1}})};return(c,a)=>{const y=n("el-form-item"),V=n("el-radio"),W=n("el-radio-group"),$=n("el-input"),q=n("el-button"),z=n("el-form"),S=n("el-tab-pane"),C=n("el-tag"),G=n("el-tooltip"),H=n("el-tabs"),L=Q("loading");return u(),_("div",null,[t(H,{onTabChange:I},{default:l(()=>[t(S,{name:"0",label:"征求意见"},{default:l(()=>[t(z,{model:i.value,ref_key:"ruleFormRef",ref:w,rules:j,"label-width":"70px"},{default:l(()=>[t(y,{label:"接收人",prop:"receiver"},{default:l(()=>[t(v(N),{placeholder:"选择接收人",style:{width:"100%"},"show-search":v(U)!="1",modelValue:i.value.receiver,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value.receiver=e)},null,8,["show-search","modelValue"])]),_:1}),t(y,{label:"可见性",prop:"visibility"},{default:l(()=>[t(W,{modelValue:i.value.visibility,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value.visibility=e)},{default:l(()=>[t(V,{label:0},{default:l(()=>[s("仅自己可见")]),_:1}),t(V,{label:1},{default:l(()=>[s("流程参与人可见")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"说明",prop:"note"},{default:l(()=>[t($,{type:"textarea",rows:3,placeholder:"接收人可看见您在这里输入的说明",modelValue:i.value.note,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value.note=e)},null,8,["modelValue"])]),_:1}),t(y,null,{default:l(()=>[t(q,{type:"primary",disabled:d.value,onClick:a[3]||(a[3]=e=>R())},{default:l(()=>[s("确定")]),_:1},8,["disabled"]),t(q,{disabled:d.value,onClick:a[4]||(a[4]=e=>h.value=!1)},{default:l(()=>[s("取消")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])]),_:1}),t(S,{name:"1",label:"查看回复"},{default:l(()=>[(u(!0),_(X,null,Y(k.value,(e,M)=>A((u(),_("div",{class:"roadui_flowsolicitopinions",key:"comment_"+M},[o("table",K,[o("tr",null,[o("td",P,[Z,t(G,{placement:"top"},{content:l(()=>[s(p(v(r).replaceWildcard(e.receiverOrganize)),1)]),default:l(()=>[t(C,null,{default:l(()=>[s(p(e.receiverName),1)]),_:2},1024)]),_:2},1024)]),o("td",ee,[te,s(p(e.receiveTime),1)]),o("td",le,[v(r).length(e.completedTime)>0?(u(),_("span",oe,[ae,s(p(e.completedTime),1)])):(u(),J(C,{key:1,type:"info"},{default:l(()=>[s("未回复")]),_:1}))])]),v(r).length(e.note)>0?(u(),_("tr",se,[o("td",ie,[o("span",ne,[re,s(p(e.note),1)]),o("span",de,p(e.visibility==10?"仅自己可见":"参与人可见"),1)])])):D("",!0),v(r).length(e.comment)>0?(u(),_("tr",ue,[o("td",pe,[ce,s(p(e.comment),1)])])):D("",!0)])])),[[L,f.value]])),128))]),_:1})]),_:1})])}}};export{ve as default};
