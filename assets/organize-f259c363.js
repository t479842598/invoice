import{ai as V,aT as v,aF as M,H as y,bD as u,aX as m,o as p,W as a,a as t,b9 as x,c as h,aV as w,bi as _,F as U,U as d,bF as I,bv as N}from"./_@vue-5ba92de9.js";import{d as W}from"./form-design-8c117009.js";import"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_jquery-3a83ed9f.js";const X={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},G=t("th",{style:{width:"60px"}},"控件id",-1),P={class:"roadui_formfont"},Q=t("th",null,"绑定字段",-1),Y={class:"roadui_note1"},Z={style:{"margin-left":"12px"}},$=t("th",null,"默认值",-1),ee=t("th",null,"宽度",-1),le={style:{"margin-right":"12px","vertical-align":"middle"}},te={style:{"vertical-align":"middle"}},ae=t("th",null,"选择类型",-1),ne=t("th",null,"选择范围",-1),oe=t("th",null,"指定范围",-1),ue={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},de=t("th",{style:{width:"50px"}},"事件",-1),se=t("th",null,"脚本",-1),ye={__name:"organize",props:{query:{type:String,default:()=>""}},setup(R){const i=V("utils"),z=V("ElSelectorg"),D=V("ElCodemirror"),k=v(null),J=R,F=i.query("editorname",J.query),c=window.parent.CKEDITOR.instances[F],f=c.formAttributeJSON,e=v({}),s=v({}),g=v(""),A=v([]),B=W.defaultValueOptions();M(()=>{f&&i.getConnTableFields(f.dbConn,f.dbTable).then(n=>{A.value=n}),S()});const j=n=>{i.length(n)!==0&&(e.value.defaultValue+=n[n.length-1])},S=n=>{e.value={id:"",label:"",field:"",width:"",defaultValue:"",multiple:!1,selectType:[],range:"",selectRange:[]},s.value={},n||(n=c.currentSelectEditorElement),n&&(e.value.id=n.getAttribute("data-id"),e.value.label=n.getAttribute("data-label"),e.value.field=n.getAttribute("data-bindfiled"),e.value.defaultValue=i.decodeURI(n.getAttribute("data-defaultvalue")),e.value.width=n.getAttribute("data-width"),e.value.placeholder=n.getAttribute("data-placeholder"),e.value.selectType=(n.getAttribute("data-selecttype")||"unit,dept,station,user,workgroup").split(","),e.value.range=n.getAttribute("data-range"),e.value.selectRange=(n.getAttribute("data-selectrange")||"").split(","),e.value.multiple=n.getAttribute("data-multiple")=="true",parseInt(n.getAttribute("data-selectsize"))&&(e.value.selectSize=parseInt(n.getAttribute("data-selectsize"))),k.value.initTitle(e.value.range),s.value=i.getArrayObj(c.formEventsJSON,e.value.id,"id"),i.isUndef(s.value)?(s.value={id:e.value.id,events:[{name:"change",script:""}]},c.formEventsJSON.push(s.value)):i.length(s.value.events)===0&&(s.value={id:e.value.id,events:[{name:"change",script:""}]}),g.value=s.value.events[0].name),c.currentSelectEditorElementJson=e.value,c.initFunction_organize=S};return(n,o)=>{const E=m("el-option"),T=m("el-select"),b=m("el-input"),q=m("el-cascader"),r=m("el-checkbox"),H=m("el-input-number"),O=m("el-checkbox-group"),C=m("el-tab-pane"),K=m("el-tabs");return p(),y(K,null,{default:u(()=>[a(C,{name:"0",label:"属性",style:{height:"100%"}},{default:u(()=>[t("table",X,[t("tr",null,[G,t("td",P,x(e.value.id),1)]),t("tr",null,[Q,t("td",null,[a(T,{modelValue:e.value.field,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.field=l),filterable:"",style:{width:"260px"},clearable:""},{default:u(()=>[(p(!0),h(U,null,w(A.value,l=>(p(),y(E,{key:l.name,value:l.name,label:l.name+(_(i).length(l.comment)>0?" - "+l.comment:"")},{default:u(()=>[t("span",null,x(l.name),1),t("span",Y,x(_(i).length(l.comment)>0?" - "+l.comment:""),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),t("span",Z,[d(" 标签"),a(b,{modelValue:e.value.label,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value.label=l),placeholder:"控件label",style:{width:"285px","margin-left":"12px"},clearable:""},null,8,["modelValue"])])])]),t("tr",null,[$,t("td",null,[a(q,{placeholder:"选择默认值",options:_(B),props:{expandTrigger:"hover",checkStrictly:!1},clearable:"",onChange:j,style:{width:"260px","margin-right":"18px"}},null,8,["options"]),a(b,{modelValue:e.value.defaultValue,"onUpdate:modelValue":o[2]||(o[2]=l=>e.value.defaultValue=l),style:{width:"323px"},clearable:""},null,8,["modelValue"])])]),t("tr",null,[ee,t("td",null,[a(b,{modelValue:e.value.width,"onUpdate:modelValue":o[3]||(o[3]=l=>e.value.width=l),placeholder:"%或px",style:{width:"116px","margin-right":"12px"},clearable:""},null,8,["modelValue"]),d(" 背景文字"),a(b,{modelValue:e.value.placeholder,"onUpdate:modelValue":o[4]||(o[4]=l=>e.value.placeholder=l),placeholder:"placeholder",style:{width:"155px",margin:"0 12px"},clearable:""},null,8,["modelValue"]),t("span",le,[a(r,{modelValue:e.value.multiple,"onUpdate:modelValue":o[5]||(o[5]=l=>e.value.multiple=l),tyle:"vertical-align:middle;"},{default:u(()=>[d("多选")]),_:1},8,["modelValue"])]),I(t("span",te,[d(" 选择个数 "),a(H,{modelValue:e.value.selectSize,"onUpdate:modelValue":o[6]||(o[6]=l=>e.value.selectSize=l),style:{width:"90px","margin-left":"12px","vertical-align":"middle"},clearable:"","controls-position":"right"},null,8,["modelValue"])],512),[[N,e.value.multiple]])])]),t("tr",null,[ae,t("td",null,[a(O,{modelValue:e.value.selectType,"onUpdate:modelValue":o[7]||(o[7]=l=>e.value.selectType=l)},{default:u(()=>[a(r,{label:"unit"},{default:u(()=>[d("单位")]),_:1}),a(r,{label:"dept"},{default:u(()=>[d("部门")]),_:1}),a(r,{label:"station"},{default:u(()=>[d("岗位")]),_:1}),a(r,{label:"user"},{default:u(()=>[d("用户")]),_:1}),a(r,{label:"workgroup"},{default:u(()=>[d("工作组")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[ne,t("td",null,[a(O,{modelValue:e.value.selectRange,"onUpdate:modelValue":o[8]||(o[8]=l=>e.value.selectRange=l)},{default:u(()=>[a(r,{label:"{<initiatorDeptId>}"},{default:u(()=>[d("发起者部门")]),_:1}),a(r,{label:"{<initiatorUnitId>}"},{default:u(()=>[d("发起者单位")]),_:1}),a(r,{label:"{<senderDeptId>}"},{default:u(()=>[d("处理者部门")]),_:1}),a(r,{label:"{<senderUnitId>}"},{default:u(()=>[d("处理者单位")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[oe,t("td",null,[a(_(z),{ref_key:"selectOrgRef",ref:k,modelValue:e.value.range,"onUpdate:modelValue":o[9]||(o[9]=l=>e.value.range=l),style:{width:"100%"},clearable:""},null,8,["modelValue"])])])])]),_:1}),a(C,{name:"1",label:"事件",style:{height:"100%"}},{default:u(()=>[t("table",ue,[t("tr",null,[de,t("td",null,[a(T,{modelValue:g.value,"onUpdate:modelValue":o[10]||(o[10]=l=>g.value=l)},{default:u(()=>[(p(!0),h(U,null,w(s.value.events,l=>(p(),y(E,{key:l.name,value:l.name,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[se,t("td",null,[(p(!0),h(U,null,w(s.value.events,l=>I((p(),h("div",{style:{width:"620px"},key:"script_"+l.name},[a(_(D),{modelValue:l.script,"onUpdate:modelValue":L=>l.script=L,height:"320px"},null,8,["modelValue","onUpdate:modelValue"])])),[[N,g.value==l.name]])),128))])])])]),_:1})]),_:1})}}};export{ye as default};
