import{ai as b,aT as B,aF as K,A as N,c as V,W as l,bD as a,bi as r,a as L,aX as f,o as n,H as w,I as i,b9 as k,U as C}from"./_@vue-5ba92de9.js";const $=L("br",null,null,-1),j={key:1},z={key:1},A={key:1},E={__name:"custom-form",setup(J){b("ajax");const _=b("utils");b("qs");const y=b("flowrun_form"),v=b("flowrun_step"),e=y.value.formData,F=B(null),R=y.value.formRules,U=y.value.formRulesSubtable;K(()=>{e.formAttrJson={dbConn:_.emptyLong+"",dbTable:"rf_form_test",dbTablePrimaryKey:"id"},e.formSubtableJson=[{id:"rf_form_test_sub",table:"rf_form_test_sub",primaryKey:"id",primaryTableKey:"id",linkField:"mainid"}],e.titleField="title",_.hasKey(e,"rf_form_test_sub")||(e.rf_form_test_sub=[])});const m=N(()=>p=>{const o=v.value.fieldStatus;let u=o["rf_form_test-"+p.toLowerCase()];if(v.value.display>0)return _.isDef(u)&&u.status==2?2:1;if(_.isDef(u))return u.status;let s=o["rf_form_test_sub."+p.toLowerCase()];if(_.isDef(s))return s.status}),D=()=>{e.rf_form_test_sub.push({key:_.createGuid()})},S=p=>{for(let o=0;o<e.rf_form_test_sub.length;o++)if(e.rf_form_test_sub[o].key===p.key){e.rf_form_test_sub.splice(o,1);break}};return(p,o)=>{const u=f("el-input"),s=f("el-form-item"),h=f("el-input-number"),c=f("el-table-column"),x=f("el-button"),T=f("el-table"),g=f("el-form");return n(),V("div",null,[$,l(g,{model:r(e),ref_key:"customFormRef",ref:F,rules:r(R),"label-width":"80px"},{default:a(()=>[l(s,{label:"标题",prop:"title"},{default:a(()=>[m.value("title")==0?(n(),w(u,{key:0,modelValue:r(e).title,"onUpdate:modelValue":o[0]||(o[0]=t=>r(e).title=t),clearable:""},null,8,["modelValue"])):i("",!0),m.value("title")==1?(n(),V("span",j,k(r(e).title),1)):i("",!0)]),_:1}),l(s,{label:"地址",prop:"f1"},{default:a(()=>[m.value("f1")==0?(n(),w(u,{key:0,modelValue:r(e).f1,"onUpdate:modelValue":o[1]||(o[1]=t=>r(e).f1=t),clearable:""},null,8,["modelValue"])):i("",!0),m.value("f1")==1?(n(),V("span",z,k(r(e).f1),1)):i("",!0)]),_:1}),l(s,{label:"数量",prop:"f3"},{default:a(()=>[l(h,{modelValue:r(e).f3,"onUpdate:modelValue":o[2]||(o[2]=t=>r(e).f3=t),clearable:""},null,8,["modelValue"])]),_:1}),l(s,{label:"备注",prop:"f2"},{default:a(()=>[m.value("f2")==0?(n(),w(u,{key:0,modelValue:r(e).f2,"onUpdate:modelValue":o[3]||(o[3]=t=>r(e).f2=t),type:"textarea",clearable:""},null,8,["modelValue"])):i("",!0),m.value("f2")==1?(n(),V("span",A,k(r(e).f2),1)):i("",!0)]),_:1}),l(s,{label:"子表"},{default:a(()=>[l(T,{data:r(e).rf_form_test_sub,stripe:!0,border:!0,style:{width:"100%"}},{default:a(()=>[l(c,{prop:"f1",label:"名称"},{default:a(t=>[l(s,{prop:"rf_form_test_sub."+t.$index+".f1",rules:r(U)["rf_form_test_sub.f1"]},{default:a(()=>[l(u,{modelValue:t.row.f1,"onUpdate:modelValue":d=>t.row.f1=d,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),l(c,{prop:"f2",label:"标题"},{default:a(t=>[l(s,{prop:"rf_form_test_sub."+t.$index+".f2",rules:r(U)["rf_form_test_sub.f2"]},{default:a(()=>[l(u,{modelValue:t.row.f2,"onUpdate:modelValue":d=>t.row.f2=d,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),l(c,{prop:"f3",label:"备注"},{default:a(t=>[l(u,{modelValue:t.row.f3,"onUpdate:modelValue":d=>t.row.f3=d,clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(c,{width:"80"},{header:a(()=>[l(x,{size:"small",type:"primary",onClick:D},{default:a(()=>[C(" 添加 ")]),_:1})]),default:a(t=>[l(x,{size:"small",type:"primary",onClick:d=>S(t.row)},{default:a(()=>[C(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["model","rules"])])}}};export{E as default};
