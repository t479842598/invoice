import{ai as s,aT as U,aF as B,c as u,a as n,F as C,aV as F,W as r,bD as i,aX as p,o as m,U as b,b9 as j,bi as g}from"./_@vue-5ba92de9.js";const D={style:{"margin-bottom":"8px"}},E={style:{"margin-bottom":"15px"}},N={style:{"margin-top":"25px","text-align":"center"}},T={__name:"back",props:{query:{type:String,default:()=>""}},setup(h){const v=s("ajax"),t=s("utils"),_=s("ElSelectorg"),f=h,o=U([]),c=s("flowrun_dialogshow"),y=s("flowrun_backok"),x=t.getQuery(f.query),V=t.query("ismobile",f.query);B(()=>{w()});const w=()=>{v.post("/Flow/GetBackSteps?"+x).then(l=>{if(l.success){switch(l.data.code){case 0:o.value=l.data.steps;break;case 1:t.alert("未找到当前任务！",!1);break;case 2:t.alert("未找到流程运行时！",!1);break;case 3:t.alert("未找到步骤运行时！",!1);break;case 4:t.alert("当前步骤设置为不能退回！",!1);break}l.data.code>0&&(c.value=!1)}}).catch(()=>{})},S=()=>{let l=[];for(let e=0;e<o.value.length;e++)if(o.value[e].checked){if(t.length(o.value[e].members)===0){t.msg(o.value[e].name+"没有选择接收人！",!1);return}l.push({id:o.value[e].id,members:o.value[e].members})}if(l.length===0){t.msg("您没有选择要退回的步骤！",!1);return}y(l),c.value=!1};return(l,e)=>{const q=p("el-checkbox"),k=p("el-button");return m(),u("div",null,[n("div",null,[(m(!0),u(C,null,F(o.value,a=>(m(),u("div",{key:a.id},[n("div",D,[r(q,{disabled:a.disabled,modelValue:a.checked,"onUpdate:modelValue":d=>a.checked=d},{default:i(()=>[b(j(a.name),1)]),_:2},1032,["disabled","modelValue","onUpdate:modelValue"])]),n("div",E,[r(g(_),{placeholder:"选择接收人",style:{width:"100%"},disabled:a.allowSelect==0,"select-range":a.selectRange,"show-search":g(V)!="1",modelValue:a.members,"onUpdate:modelValue":d=>a.members=d},null,8,["disabled","select-range","show-search","modelValue","onUpdate:modelValue"])])]))),128))]),n("div",N,[r(k,{type:"primary",onClick:e[0]||(e[0]=a=>S())},{default:i(()=>[b("确定")]),_:1}),r(k,{onClick:e[1]||(e[1]=a=>c.value=!1)},{default:i(()=>[b("取消")]),_:1})])])}}};export{T as default};
