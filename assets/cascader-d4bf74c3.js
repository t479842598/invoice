import{ai as k,aT as g,aF as z,by as G,H as h,bD as d,aX as c,o as r,W as u,a,b9 as A,c as v,aV as _,bi as p,F as V,U as i,bF as S,bv as f}from"./_@vue-5ba92de9.js";import{d as O}from"./form-design-8c117009.js";import"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_jquery-3a83ed9f.js";const Y={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},Z=a("th",{style:{width:"60px"}},"控件id",-1),$={class:"roadui_formfont"},ee=a("th",null,"绑定字段",-1),le={class:"roadui_note1"},ae={style:{"margin-left":"12px"}},te=a("th",null,"默认值",-1),oe=a("th",null,"宽度",-1),ue={style:{"margin-right":"12px"}},de={style:{"margin-left":"12px"}},ne=a("th",null,"值类型",-1),re={style:{"padding-top":"1px","padding-bottom":"1px"}},ie=a("th",null,"选项来源",-1),se={style:{"margin-left":"12px"}},ce=a("th",null,"字典项",-1),me=a("th",null,"字符串",-1),ve=a("th",null,"SQL",-1),pe=a("th",null,"URL",-1),be={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},ge=a("th",{style:{width:"50px"}},"事件",-1),he=a("th",null,"脚本",-1),ke={__name:"cascader",props:{query:{type:String,default:()=>""}},setup(J){const n=k("utils"),j=k("ElSelectdict"),I=k("ElCodemirror"),P=J,B=n.query("editorname",P.query),b=window.parent.CKEDITOR.instances[B],q=b.formAttributeJSON,e=g({}),s=g({}),y=g(""),E=g([]),L=O.defaultValueOptions(),F=g([]),Q=O.dataSourceOptions(),H=O.dictValueFieldOptions(),T=g(null);z(()=>{q&&n.getConnTableFields(q.dbConn,q.dbTable).then(o=>{E.value=o}),N()}),G(()=>e.value.dataSource,o=>{o=="sql"&&n.getConns().then(t=>{F.value=t})});const K=o=>{n.length(o)!==0&&(e.value.defaultValue+=o[o.length-1])},N=o=>{e.value={id:"",label:"",field:"",width:"",defaultValue:"",placeholder:"",selectParent:"",dataSource:"",dataSourceDict:"",dataSourceDictValueField:"",search:!1,allowClear:!1,expandTrigger:"click",dataSourceString:"",dataSourceSqlConn:"",dataSourceSql:"",dataSourceUrl:""},s.value={},o||(o=b.currentSelectEditorElement),o&&(e.value.id=o.getAttribute("data-id"),e.value.label=o.getAttribute("data-label"),e.value.field=o.getAttribute("data-bindfiled"),e.value.defaultValue=n.decodeURI(o.getAttribute("data-defaultvalue")),e.value.width=o.getAttribute("data-width"),e.value.placeholder=o.getAttribute("data-placeholder"),e.value.expandTrigger=o.getAttribute("data-expandtrigger"),e.value.dataSource=o.getAttribute("data-datasource"),e.value.dataSourceDict=o.getAttribute("data-datasourcedict"),e.value.dataSourceDictValueField=o.getAttribute("data-datasourcedictvaluefield"),e.value.dataSourceString=n.decodeURI(o.getAttribute("data-datasourcestring")),e.value.dataSourceSqlConn=o.getAttribute("data-datasourcesqlconn"),e.value.dataSourceSql=n.decodeURI(o.getAttribute("data-datasourcesql")),e.value.dataSourceUrl=n.decodeURI(o.getAttribute("data-datasourceurl")),e.value.search=o.getAttribute("data-search")=="true",e.value.allowClear=o.getAttribute("data-allowclear")=="true",e.value.emitPath=o.getAttribute("data-emitPath"),T.value.initTitle(e.value.dataSourceDict),s.value=n.getArrayObj(b.formEventsJSON,e.value.id,"id"),n.isUndef(s.value)?(s.value={id:e.value.id,events:[{name:"change",script:""}]},b.formEventsJSON.push(s.value)):n.length(s.value.events)===0&&(s.value={id:e.value.id,events:[{name:"change",script:""}]}),y.value=s.value.events[0].name),b.currentSelectEditorElementJson=e.value,b.initFunction_cascader=N};return(o,t)=>{const w=c("el-option"),U=c("el-select"),m=c("el-input"),M=c("el-cascader"),W=c("el-checkbox"),x=c("el-radio"),C=c("el-radio-group"),R=c("el-tab-pane"),X=c("el-tabs");return r(),h(X,null,{default:d(()=>[u(R,{name:"0",label:"属性",style:{height:"100%"}},{default:d(()=>[a("table",Y,[a("tr",null,[Z,a("td",$,A(e.value.id),1)]),a("tr",null,[ee,a("td",null,[u(U,{modelValue:e.value.field,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.field=l),filterable:"",style:{width:"260px"},clearable:""},{default:d(()=>[(r(!0),v(V,null,_(E.value,l=>(r(),h(w,{key:l.name,value:l.name,label:l.name+(p(n).length(l.comment)>0?" - "+l.comment:"")},{default:d(()=>[a("span",null,A(l.name),1),a("span",le,A(p(n).length(l.comment)>0?" - "+l.comment:""),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),a("span",ae,[i(" 标签"),u(m,{modelValue:e.value.label,"onUpdate:modelValue":t[1]||(t[1]=l=>e.value.label=l),placeholder:"控件label",style:{width:"285px","margin-left":"12px"},clearable:""},null,8,["modelValue"])])])]),a("tr",null,[te,a("td",null,[u(M,{placeholder:"选择默认值",options:p(L),props:{expandTrigger:"hover",checkStrictly:!1},clearable:"",onChange:K,style:{width:"260px","margin-right":"18px"}},null,8,["options"]),u(m,{modelValue:e.value.defaultValue,"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.defaultValue=l),style:{width:"323px"},clearable:""},null,8,["modelValue"])])]),a("tr",null,[oe,a("td",null,[u(m,{modelValue:e.value.width,"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.width=l),placeholder:"px或%",clearable:"",style:{width:"100px","margin-right":"12px"}},null,8,["modelValue"]),a("span",ue,[i("背景文字"),u(m,{modelValue:e.value.placeholder,"onUpdate:modelValue":t[4]||(t[4]=l=>e.value.placeholder=l),placeholder:"placeholder",clearable:"",style:{width:"120px","margin-left":"12px"}},null,8,["modelValue"])]),u(W,{modelValue:e.value.allowClear,"onUpdate:modelValue":t[5]||(t[5]=l=>e.value.allowClear=l),style:{"vertical-align":"middle"}},{default:d(()=>[i("可清空")]),_:1},8,["modelValue"]),a("span",de,[i(" 展开方式 "),u(C,{modelValue:e.value.expandTrigger,"onUpdate:modelValue":t[6]||(t[6]=l=>e.value.expandTrigger=l),style:{"margin-left":"12px","vertical-align":"middle"}},{default:d(()=>[u(x,{label:"click"},{default:d(()=>[i("单击")]),_:1}),u(x,{label:"hover"},{default:d(()=>[i("移入")]),_:1})]),_:1},8,["modelValue"])])])]),a("tr",null,[ne,a("td",re,[u(C,{modelValue:e.value.emitPath,"onUpdate:modelValue":t[7]||(t[7]=l=>e.value.emitPath=l),style:{"vertical-align":"middle"}},{default:d(()=>[u(x,{label:"0"},{default:d(()=>[i("全路径数组")]),_:1}),u(x,{label:"1"},{default:d(()=>[i("最后节点值")]),_:1})]),_:1},8,["modelValue"])])]),a("tr",null,[ie,a("td",null,[u(C,{modelValue:e.value.dataSource,"onUpdate:modelValue":t[8]||(t[8]=l=>e.value.dataSource=l),style:{"vertical-align":"middle"}},{default:d(()=>[(r(!0),v(V,null,_(p(Q),l=>(r(),h(x,{key:l.value,label:l.value},{default:d(()=>[i(A(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),S(a("span",se,[i(" 数据连接 "),u(U,{modelValue:e.value.dataSourceSqlConn,"onUpdate:modelValue":t[9]||(t[9]=l=>e.value.dataSourceSqlConn=l),placeholder:"选择执行SQL的数据连接",clearable:"",style:{width:"200px",margin:"0 12px","vertical-align":"middle"}},{default:d(()=>[(r(!0),v(V,null,_(F.value,(l,D)=>(r(),h(w,{key:"conn_"+D,value:l.id,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])],512),[[f,e.value.dataSource=="sql"]])])]),S(a("tr",null,[ce,a("td",null,[u(p(j),{modelValue:e.value.dataSourceDict,"onUpdate:modelValue":t[10]||(t[10]=l=>e.value.dataSourceDict=l),ref_key:"dataSourceDictRef",ref:T,style:{width:"400px","margin-right":"12px"}},null,8,["modelValue"]),i(" 值字段 "),u(U,{modelValue:e.value.dataSourceDictValueField,"onUpdate:modelValue":t[11]||(t[11]=l=>e.value.dataSourceDictValueField=l),style:{width:"127px","margin-left":"12px"},clearable:""},{default:d(()=>[(r(!0),v(V,null,_(p(H),l=>(r(),h(w,{key:l.value,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])],512),[[f,e.value.dataSource=="dict"]]),S(a("tr",null,[me,a("td",null,[u(m,{type:"textarea",rows:3,modelValue:e.value.dataSourceString,"onUpdate:modelValue":t[12]||(t[12]=l=>e.value.dataSourceString=l),placeholder:"cascader控件的json格式字符串：[{value:'',label:'',children:[{value:'',label:''}]}]。"},null,8,["modelValue"])])],512),[[f,e.value.dataSource=="string"]]),S(a("tr",null,[ve,a("td",null,[u(m,{type:"textarea",rows:3,modelValue:e.value.dataSourceSql,"onUpdate:modelValue":t[13]||(t[13]=l=>e.value.dataSourceSql=l),placeholder:"通过sql查询返回一个json格式字符串：[{value:'',label:'',children:[{value:'',label:''}]}]。"},null,8,["modelValue"])])],512),[[f,e.value.dataSource=="sql"]]),S(a("tr",null,[pe,a("td",null,[u(m,{type:"textarea",rows:3,modelValue:e.value.dataSourceUrl,"onUpdate:modelValue":t[14]||(t[14]=l=>e.value.dataSourceUrl=l),placeholder:"post一个url地址，返回一个json格式字符串：[{value:'',label:'',children:[{value:'',label:''}]}]。"},null,8,["modelValue"])])],512),[[f,e.value.dataSource=="url"]])])]),_:1}),u(R,{name:"1",label:"事件",style:{height:"100%"}},{default:d(()=>[a("table",be,[a("tr",null,[ge,a("td",null,[u(U,{modelValue:y.value,"onUpdate:modelValue":t[15]||(t[15]=l=>y.value=l)},{default:d(()=>[(r(!0),v(V,null,_(s.value.events,l=>(r(),h(w,{key:l.name,value:l.name,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),a("tr",null,[he,a("td",null,[(r(!0),v(V,null,_(s.value.events,l=>S((r(),v("div",{style:{width:"620px"},key:"script_"+l.name},[u(p(I),{modelValue:l.script,"onUpdate:modelValue":D=>l.script=D,height:"340px"},null,8,["modelValue","onUpdate:modelValue"])])),[[f,y.value==l.name]])),128))])])])]),_:1})]),_:1})}}};export{ke as default};
