import{ai as A,aT as x,aF as je,aK as qe,H as C,bD as o,aX as b,o as f,W as a,U as v,a as t,b9 as N,bi as T,c as D,aV as M,F,aw as de,aZ as he,I as le,bF as Re,bv as He}from"./_@vue-5ba92de9.js";import{D as Le}from"./_vuedraggable-a473ce37.js";import"./__vendor-5e6ac033.js";const We={cellpadding:"0",cellspacing:"0",border:"0",class:"roadui_fromtable"},$e=t("th",{style:{width:"80px"}},"步骤名称",-1),Ee={style:{width:"39%"}},Ge=t("th",{style:{width:"80px","padding-left":"20px"}},"步骤id",-1),Je=t("th",null,"意见显示",-1),Ke=t("th",{style:{"padding-left":"20px"}},"工时(天)",-1),Qe=t("th",null,"审签类型",-1),ze=t("th",{style:{"padding-left":"20px"}},"超期提醒",-1),Xe={style:{"margin-left":"12px"}},Ze=t("th",null,"是否归档",-1),Ye=t("th",{style:{"padding-left":"20px"}},"超时处理",-1),el=t("th",null,"发送提示语",-1),ll=t("th",{style:{"padding-left":"20px"}},"退回提示语",-1),tl=t("th",null,"表单",-1),al={colspan:"3"},ul=t("th",null,"移动端表单",-1),ol={colspan:"3"},nl=t("th",null,"备注",-1),dl={colspan:"3"},sl={cellpadding:"0",cellspacing:"0",border:"0",class:"roadui_fromtable"},il=t("th",{style:{width:"80px"}},"流转类型",-1),rl={style:{width:"38%"}},pl=t("th",{style:{width:"80px","padding-left":"20px"}},"选择类型",-1),ml={style:{"margin-left":"12px"}},vl={style:{"margin-left":"12px"}},fl=t("th",null,"处理者类型",-1),hl=t("th",{style:{"padding-left":"20px"}},"选择范围",-1),bl=t("th",null,"处理者步骤",-1),_l=t("th",{style:{"padding-left":"20px"}},"加签范围",-1),gl={style:{"margin-left":"12px"}},cl=t("th",null,"值字段",-1),yl={class:"roadui_note1"},Vl=t("th",{style:{"padding-left":"20px"},rowspan:"2"},[v("默认处理者"),t("br"),v("SQL或方法")],-1),wl={rowspan:"2"},xl=t("th",null,"默认处理者",-1),kl=t("th",null,"处理策略",-1),Ul={style:{"margin-left":"12px"}},Tl=t("th",{style:{"padding-left":"20px"}},"退回策略",-1),Sl=t("th",null,"会签策略",-1),Cl={style:{"margin-left":"12px"}},Dl=t("th",{style:{"padding-left":"20px"}},"退回类型",-1),Bl=t("th",null,"会签起点",-1),Ml=t("th",{style:{"padding-left":"20px"}},"退回步骤",-1),Fl=t("th",null,"跳过策略",-1),Ol={colspan:"3"},Al={class:"roadui_setshortuctdiv",style:{width:"100%"}},Nl={cellpadding:"0",cellspacing:"0",border:"0"},Il={style:{width:"30%",height:"507px"},valign:"top"},Pl={class:"roadui_setshortuctlist",style:{padding:"0 0 0 12px"}},jl={style:{"padding-right":"12px"}},ql=["onDblclick","onClick"],Rl={class:"roadui_setshortuctbuttd",valign:"middle"},Hl={valign:"top",style:{width:"30%"}},Ll={class:"roadui_setshortuctlist",style:{"padding-right":"12px"}},Wl=["onDblclick","onClick"],$l={valign:"top",style:{"padding-left":"30px"}},El={class:"roadui_setshortuctlist",style:{"padding-right":"12px"}},Gl=t("div",{style:{"margin-bottom":"10px"}},"操作提示",-1),Jl=t("div",{class:"roadui_note"},"在按钮上双击可快速添加和移出按钮。",-1),Kl=t("div",{class:"roadui_note",style:{"margin-top":"5px"}},"在已选择按钮上拖动可排序。",-1),Ql=t("div",{style:{margin:"20px 0 15px 0"}},"按钮显示",-1),zl=t("div",{style:{margin:"20px 0 10px 0"}},"按钮说明",-1),Xl={class:"roadui_note"},Zl={style:{"margin-bottom":"15px"}},Yl={key:0,class:"roadui_note"},et={style:{"margin-left":"10px"}},lt={style:{"margin-left":"10px"}},tt={style:{"margin-left":"20px"}},at={style:{"margin-left":"20px"}},ut={cellpadding:"0",cellspacing:"0",border:"0",class:"roadui_fromtable"},ot=t("th",{style:{width:"90px"}},"指定接收人",-1),nt=t("th",null,"类型",-1),dt=t("th",null,"步骤处理人员",-1),st=t("th",null,"SQL或方法",-1),it=t("th",null,"抄送时间",-1),rt=t("th",null,"待办通知",-1),pt=t("th",null,"消息模板",-1),mt={cellpadding:"0",cellspacing:"0",border:"0",class:"roadui_fromtable"},vt=t("th",{style:{width:"90px"}},"提交前事件",-1),ft=t("th",null,"提交后事件",-1),ht=t("th",null,"步骤提交通过后事件",-1),bt=t("th",null,"退回前事件",-1),_t=t("th",null,"退回后事件",-1),gt=t("th",null,"步骤退回通过后事件",-1),ct=t("th",null,"数据保存前事件",-1),yt={cellpadding:"0",cellspacing:"0",border:"0",class:"roadui_fromtable"},Vt=t("th",{style:{width:"90px"}},"子流程",-1),wt=t("th",null,"子流程策略",-1),xt=t("th",null,"实例类型",-1),kt=t("th",null,"激活前事件",-1),Ct={__name:"step",props:{query:{type:String,default:()=>""}},setup(be){const E=A("ajax"),p=A("utils"),se=A("qs"),J=A("ElSelectorg"),_e=A("ElSelectflow"),ge=be,ce=A("desing_setStepText"),j=A("flowJson"),ie=p.query("stepid",ge.query),n=x({}),K=A("appTypes"),te=x([]),ae=x([]);je(()=>{if(n.value=p.getArrayObj(j.value.steps,ie,"id"),n.value===null){p.msg("没有找到步骤！",!1);return}if(document.body.ondrop=function(u){try{u.preventDefault(),u.stopPropagation()}catch{}},p.isNumber(n.value.workTime)||delete n.value.workTime,p.isNumber(n.value.expiredPrompt)||delete n.value.expiredPrompt,p.isNumber(n.value.expiredPromptDays)||delete n.value.expiredPromptDays,s.value=n.value.behavior||{},p.isDef(j.value)&&p.length(j.value.steps)>0)for(let u=0;u<j.value.steps.length;u++)j.value.steps[u].id!=n.value.id&&G.value.push({value:j.value.steps[u].id,title:p.replace(j.value.steps[u].name,"\\\\n","")});W.value=n.value.fieldStatus,k.value=n.value.copyFor||{},U.value=n.value.event||{},I.value=n.value.subflow||{},ye(),we(),xe(),ke()}),qe(()=>{document.body.ondrop=null});const ye=()=>{if(p.length(K.value)>0){ue(n.value.formType);return}const u=[{id:"system_applibrary_type",key:"type",children:!0,valueField:"id"}];E.post("/Dictionary/GetMultipleOptions",se.stringify({json:JSON.stringify(u)})).then(e=>{K.value=e.data.type,ue(n.value.formType)}).catch(()=>{})},ue=u=>{p.length(u)>0?E.post("/Applibrary/GetOptions?typeid="+u[u.length-1]).then(e=>{te.value=e.data,oe(n.value.formType_mobile)}).catch(()=>{}):(n.value.formId="",te.value=[],oe(n.value.formType_mobile))},oe=u=>{p.length(u)>0?E.post("/Applibrary/GetOptions?typeid="+u[u.length-1]).then(e=>{ae.value=e.data}).catch(()=>{}):(n.value.formId_mobile="",ae.value=[])},Ve=u=>{ce(n.value.id,u)},s=x({}),B=A("workRoles"),G=x([]),re=x([]),q=x([{value:"0",title:"发起者"},{value:"1",title:"某一步骤处理者"},{value:"2",title:"字段值"},{value:"3",title:"发起者 - 部门"},{value:"4",title:"发起者 - 单位"},{value:"5",title:"前一步处理者 - 部门"},{value:"6",title:"前一步处理者 - 单位"}]),we=()=>{if(p.length(B.value)>0){let u=0,e=0;for(let d=0;d<B.value.length;d++)p.startWith(B.value[d].value,"initiator_")?(q.value.splice(u+5,0,B.value[d]),R.value.splice(u+2,0,B.value[d]),u++):p.startWith(B.value[d].value,"parents_initiator_")?(q.value.splice(e+5+u,0,B.value[d]),R.value.splice(e+2+u,0,B.value[d]),e++):(q.value.push(B.value[d]),R.value.push(B.value[d]))}else{const u=[{id:"system_organize_workrole",key:"workrole",children:!1,valueField:"value"}];E.post("/Dictionary/GetMultipleOptions",se.stringify({json:JSON.stringify(u)})).then(e=>{let d=[],m=e.data.workrole;for(let r=0;r<m.length;r++){let h={value:"initiator_"+m[r].value,title:"发起者 - "+m[r].label};d.push(h),q.value.splice(r+5,0,h),R.value.splice(r+2,0,h)}for(let r=0;r<m.length;r++){let h={value:"parents_initiator_"+m[r].value,title:"发起者 - 所有上级"+m[r].label};d.push(h),q.value.splice(r+5+m.length,0,h),R.value.splice(r+2+m.length,0,h)}for(let r=0;r<m.length;r++){let h={value:"sender_"+m[r].value,title:"前一步处理者 - "+m[r].label};d.push(h),q.value.push(h),R.value.push(h)}for(let r=0;r<m.length;r++){let h={value:"parents_sender_"+m[r].value,title:"前一步处理者 - 所有上级"+m[r].label};d.push(h),q.value.push(h),R.value.push(h)}B.value=d}).catch(()=>{})}},xe=()=>{p.getFromFields(j.value.id,ie,n.value.formId).then(u=>{for(let e=0;e<u.length;e++){if(ne.value.push({value:u[e].id,title:(p.length(u[e].label)>0?u[e].label+" - ":"")+u[e].id,tableName:u[e].tableName||""}),u[e].type==="main")for(let d=0;d<u[e].fields.length;d++)re.value.push({value:u[e].fields[d].id,label:u[e].fields[d].id,comment:u[e].fields[d].label});for(let d=0;d<u[e].fields.length;d++){let m=0,r=0,h="";if(p.length(W.value)>0)for(let y=0;y<W.value.length;y++){let $=u[e].type=="subtable"?(u[e].id+"."+u[e].fields[d].id).toLowerCase():u[e].fields[d].id.toLowerCase();if(W.value[y].field.toLowerCase()===$){m=W.value[y].status,r=W.value[y].check;break}}let c=u[e].fields[d].id.split("-");c.length===2&&(h=c[0]),h=h||u[e].label||u[e].id,_.push({table:u[e].id,tableName:h,type:u[e].type,field:u[e].fields[d].id,comment:u[e].fields[d].label,fieldStatus:m,check:r}),w.value.push({table:u[e].id,tableName:h,type:u[e].type,field:u[e].fields[d].id,comment:u[e].fields[d].label,fieldStatus:m,check:r})}}})},Q=A("buttons"),S=x([]),V=x({id:"",name:"",showTitle:"",note:""}),L=x({}),ke=()=>{if(p.length(Q.value)>0){let u=n.value.buttons||[];for(let e=0;e<u.length;e++){let d=p.getArrayObj(Q.value,u[e].id,"id");if(d===null)continue;let m=p.hasKey(u[e],"showTitle")?u[e].showTitle:"";S.value.push({id:d.id,key:p.createGuid(!1),name:d.name,showTitle:m,ico:d.ico,note:d.note,current:!1})}}else E.post("/FlowButton/getList").then(u=>{u.data.splice(0,0,{id:p.emptyLong+"",name:"分隔线",scripts:"",ico:"Minus",note:"",sort:0}),Q.value=u.data;let e=n.value.buttons||[];for(let d=0;d<e.length;d++){let m=p.getArrayObj(u.data,e[d].id,"id");if(m===null)continue;let r=p.hasKey(e[d],"showTitle")?e[d].showTitle:"";S.value.push({id:m.id,key:p.createGuid(!1),name:m.name,showTitle:r,ico:m.ico,note:m.note,current:!1})}}).catch(()=>{})},z=u=>{V.value=u},pe=()=>{if(p.length(V.value.id)===0){p.msg("请选择要添加的按钮！",!1);return}if(V.value.id!==p.emptyLong+""&&p.inArray(S.value,V.value.id,"id")){p.msg(V.value.name+"按钮已经选择了！",!1);return}S.value.push({id:V.value.id,key:p.createGuid(!1),name:V.value.name,showTitle:"",ico:V.value.ico,note:V.value.note,current:!1}),X()},me=()=>{if(p.length(V.value.id)===0){p.msg("请选择要移出的按钮！",!1);return}for(let u=0;u<S.value.length;u++)(S.value[u]===V.value||V.value.id!=p.emptyLong.toString()&&V.value.id==S.value[u].id)&&S.value.splice(u,1);X()},X=()=>{let u=[];for(let e=0;e<S.value.length;e++)u.push({id:S.value[e].id,sort:(e+1)*5,showTitle:p.hasKey(S.value[e],"showTitle")&&p.length(S.value[e].showTitle)>0?S.value[e].showTitle:""});n.value.buttons=u},k=x([]),R=x([]),ne=x([]),W=x([]),_=[],w=x([]),Ue=u=>{w.value=p.length(u)===0?[..._]:[..._].filter(e=>e.table==u);for(let e=0;e<w.value.length;e++){let d=w.value[e].type=="subtable"?w.value[e].table+"."+w.value[e].field:w.value[e].field,m=p.getArrayObj(n.value.fieldStatus,d.toLowerCase(),"field");m!==null&&(w.value[e].check=m.check,w.value[e].fieldStatus=m.status)}},Te=u=>{for(let e=0;e<w.value.length;e++){w.value[e].fieldStatus=u;for(let d=0;d<_.length;d++)if(_[d].table==w.value[e].table&&_[d].field==w.value[e].field){_[d].fieldStatus=u;break}}Z()},Se=u=>{for(let e=0;e<w.value.length;e++){w.value[e].check=u;for(let d=0;d<_.length;d++)if(_[d].table==w.value[e].table&&_[d].field==w.value[e].field){_[d].check=u;break}}Z()},Z=u=>{let e=[];for(let d=0;d<_.length;d++){p.isDef(u)&&_[d].table==u.table&&_[d].field==u.field&&(_[d].fieldStatus=u.fieldStatus,_[d].check=u.check);let m=_[d].type=="subtable"?_[d].table+"."+_[d].field:_[d].field;e.push({field:m.toLowerCase(),status:_[d].fieldStatus,check:_[d].check})}n.value.fieldStatus=e},U=x({}),I=x({});return(u,e)=>{const d=b("Setting"),m=b("el-icon"),r=b("el-input"),h=b("el-switch"),c=b("el-checkbox"),y=b("el-tooltip"),$=b("el-input-number"),i=b("el-option"),g=b("el-select"),O=b("el-radio"),Y=b("el-radio-group"),ve=b("el-cascader"),H=b("el-tab-pane"),Ce=b("Cpu"),De=b("TurnOff"),Be=b("el-scrollbar"),fe=b("el-button"),Me=b("Coin"),ee=b("el-table-column"),Fe=b("el-table"),Oe=b("Edit"),Ae=b("el-checkbox-group"),Ne=b("Mouse"),Ie=b("Files"),Pe=b("el-tabs");return f(),C(Pe,null,{default:o(()=>[a(H,{name:"0",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(d)]),_:1}),v("基本 ")]),default:o(()=>[t("table",We,[t("tr",null,[$e,t("td",Ee,[a(r,{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>n.value.name=l),onInput:Ve},null,8,["modelValue"])]),Ge,t("td",null,N(n.value.id),1)]),t("tr",null,[Je,t("td",null,[a(h,{modelValue:n.value.opinionDisplay,"onUpdate:modelValue":e[1]||(e[1]=l=>n.value.opinionDisplay=l),style:{"margin-right":"12px"}},null,8,["modelValue"]),a(y,{content:"填写处理意见时是否可以上传附件",placement:"top-start"},{default:o(()=>[a(c,{modelValue:n.value.attachment,"onUpdate:modelValue":e[2]||(e[2]=l=>n.value.attachment=l),label:"可传附件",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1}),a(y,{content:"下一步有默认处理人时直接发送，不弹出发送确认窗口。",placement:"top-start"},{default:o(()=>[a(c,{modelValue:n.value.autoConfirm,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value.autoConfirm=l),label:"有处理人直接发送",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1})]),Ke,t("td",null,[a($,{modelValue:n.value.workTime,"onUpdate:modelValue":e[4]||(e[4]=l=>n.value.workTime=l),style:{width:"100px","margin-right":"12px"},"controls-position":"right"},null,8,["modelValue"]),a(c,{modelValue:n.value.sendSetWorkTime,"onUpdate:modelValue":e[5]||(e[5]=l=>n.value.sendSetWorkTime=l),label:"发送时指定完成时间",style:{"vertical-align":"middle"}},null,8,["modelValue"])])]),t("tr",null,[Qe,t("td",null,[a(g,{modelValue:n.value.signatureType,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value.signatureType=l),style:{width:"100%"}},{default:o(()=>[a(i,{value:"0",label:"无签批意见栏"}),a(i,{value:"1",label:"有签批意见 - 无签章"}),a(i,{value:"2",label:"有签批意见 - 须签章"}),a(i,{value:"3",label:"有签批意见 - 须密码签章"})]),_:1},8,["modelValue"])]),ze,t("td",null,[a(h,{modelValue:n.value.expiredPrompt,"onUpdate:modelValue":e[7]||(e[7]=l=>n.value.expiredPrompt=l),style:{"margin-right":"12px"}},null,8,["modelValue"]),t("span",null,[v("提前 "),a($,{modelValue:n.value.expiredPromptDays,"onUpdate:modelValue":e[8]||(e[8]=l=>n.value.expiredPromptDays=l),style:{width:"90px"},"controls-position":"right"},null,8,["modelValue"]),v(" 天")]),t("span",Xe,[v("间隔 "),a($,{modelValue:n.value.intervalPromptDays,"onUpdate:modelValue":e[9]||(e[9]=l=>n.value.intervalPromptDays=l),style:{width:"90px"},"controls-position":"right"},null,8,["modelValue"]),v(" 天")])])]),t("tr",null,[Ze,t("td",null,[a(h,{modelValue:n.value.archives,"onUpdate:modelValue":e[10]||(e[10]=l=>n.value.archives=l),style:{"margin-right":"12px"}},null,8,["modelValue"]),a(y,{content:"设置开启该步骤任务才在批量处理列表中显示",placement:"top-start"},{default:o(()=>[a(c,{modelValue:n.value.batch,"onUpdate:modelValue":e[11]||(e[11]=l=>n.value.batch=l),label:"批量处理",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1}),a(y,{content:"步骤有多人处理时，是否同时只能有一人处理。",placement:"top-start"},{default:o(()=>[a(c,{modelValue:n.value.concurrentModel,"onUpdate:modelValue":e[12]||(e[12]=l=>n.value.concurrentModel=l),label:"并发控制",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1})]),Ye,t("td",null,[a(Y,{modelValue:n.value.timeOutModel,"onUpdate:modelValue":e[13]||(e[13]=l=>n.value.timeOutModel=l)},{default:o(()=>[a(O,{label:0},{default:o(()=>[v("不处理")]),_:1}),a(O,{label:1},{default:o(()=>[v("自动提交")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[el,t("td",null,[a(r,{modelValue:n.value.sendShowMsg,"onUpdate:modelValue":e[14]||(e[14]=l=>n.value.sendShowMsg=l)},null,8,["modelValue"])]),ll,t("td",null,[a(r,{modelValue:n.value.backShowMsg,"onUpdate:modelValue":e[15]||(e[15]=l=>n.value.backShowMsg=l)},null,8,["modelValue"])])]),t("tr",null,[tl,t("td",al,[a(ve,{modelValue:n.value.formType,"onUpdate:modelValue":e[16]||(e[16]=l=>n.value.formType=l),options:T(K),style:{width:"341px","margin-right":"19px"},onChange:ue,props:{expandTrigger:"hover",checkStrictly:!0},clearable:""},null,8,["modelValue","options"]),a(g,{modelValue:n.value.formId,"onUpdate:modelValue":e[17]||(e[17]=l=>n.value.formId=l),style:{width:"458px"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(te.value,l=>(f(),C(i,{key:l.id,value:l.id,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[ul,t("td",ol,[a(ve,{modelValue:n.value.formType_mobile,"onUpdate:modelValue":e[18]||(e[18]=l=>n.value.formType_mobile=l),options:T(K),style:{width:"341px","margin-right":"19px"},onChange:oe,props:{expandTrigger:"hover",checkStrictly:!0},clearable:""},null,8,["modelValue","options"]),a(g,{modelValue:n.value.formId_mobile,"onUpdate:modelValue":e[19]||(e[19]=l=>n.value.formId_mobile=l),style:{width:"458px"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(ae.value,l=>(f(),C(i,{key:l.id,value:l.id,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[nl,t("td",dl,[a(r,{modelValue:n.value.note,"onUpdate:modelValue":e[20]||(e[20]=l=>n.value.note=l)},null,8,["modelValue"])])])])]),_:1}),a(H,{name:"1",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(Ce)]),_:1}),v("策略 ")]),default:o(()=>[t("table",sl,[t("tr",null,[il,t("td",rl,[a(g,{modelValue:s.value.flowType,"onUpdate:modelValue":e[21]||(e[21]=l=>s.value.flowType=l),style:{width:"100%"},clearable:""},{default:o(()=>[a(i,{value:"0",label:"单选一个步骤"}),a(i,{value:"1",label:"多选几个步骤 - 默认选中第一个"}),a(i,{value:"2",label:"多选几个步骤 - 默认全部选中"}),a(i,{value:"3",label:"多选几个步骤 - 默认全部选中不能取消"}),a(i,{value:"4",label:"根据条件判断 - 无后续步骤时提示"}),a(i,{value:"5",label:"根据条件判断 - 无后续步骤时完成"})]),_:1},8,["modelValue"])]),pl,t("td",null,[a(g,{placeholder:"组织选择类型",modelValue:s.value.selectType,"onUpdate:modelValue":e[22]||(e[22]=l=>s.value.selectType=l),multiple:"",style:{width:"181px"},clearable:""},{default:o(()=>[a(i,{value:"unit",label:"单位"}),a(i,{value:"dept",label:"部门"}),a(i,{value:"station",label:"岗位"}),a(i,{value:"user",label:"人员"}),a(i,{value:"workgroup",label:"工作组"})]),_:1},8,["modelValue"]),t("span",ml,[a(y,{content:"是否允许发送人在处理时自己选择该步骤的接收人",placement:"top-start"},{default:o(()=>[a(c,{modelValue:s.value.runSelect,"onUpdate:modelValue":e[23]||(e[23]=l=>s.value.runSelect=l),label:"允许选择",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1})]),t("span",vl,[a(y,{content:"发送时允许选择的组织人员数量，0或空表示不限制。",placement:"top-start"},{default:o(()=>[a($,{modelValue:s.value.selectQuantity,"onUpdate:modelValue":e[24]||(e[24]=l=>s.value.selectQuantity=l),placeholder:"数量",style:{width:"86px"},"controls-position":"right"},null,8,["modelValue"])]),_:1})])])]),t("tr",null,[fl,t("td",null,[a(g,{multiple:"",modelValue:s.value.handlerType,"onUpdate:modelValue":e[25]||(e[25]=l=>s.value.handlerType=l),style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(q.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),hl,t("td",null,[a(g,{modelValue:s.value.selectRangeForDefaultHandler,"onUpdate:modelValue":e[26]||(e[26]=l=>s.value.selectRangeForDefaultHandler=l),style:{width:"155px"},clearable:""},{default:o(()=>[a(i,{value:"1",label:"默认处理者选中"}),a(i,{value:"2",label:"默认处理者不选中"})]),_:1},8,["modelValue"]),a(T(J),{modelValue:s.value.selectRange,"onUpdate:modelValue":e[27]||(e[27]=l=>s.value.selectRange=l),placeholder:"指定选择范围",style:{width:"205px","margin-left":"12px"}},null,8,["modelValue"])])]),t("tr",null,[bl,t("td",null,[a(g,{modelValue:s.value.handlerStep,"onUpdate:modelValue":e[28]||(e[28]=l=>s.value.handlerStep=l),style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(G.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_l,t("td",null,[a(T(J),{modelValue:s.value.addWriteRange,"onUpdate:modelValue":e[29]||(e[29]=l=>s.value.addWriteRange=l),placeholder:"指定加签选择范围",style:{width:"265px"}},null,8,["modelValue"]),t("span",gl,[a(y,{content:"将该步骤的默认处理人作为加签选择范围",placement:"top-start"},{default:o(()=>[a(c,{modelValue:s.value.addWriteDefaultIsRange,"onUpdate:modelValue":e[30]||(e[30]=l=>s.value.addWriteDefaultIsRange=l),label:"默认处理人",style:{"vertical-align":"middle"}},null,8,["modelValue"])]),_:1})])])]),t("tr",null,[cl,t("td",null,[a(g,{modelValue:s.value.valueField,"onUpdate:modelValue":e[31]||(e[31]=l=>s.value.valueField=l),style:{width:"220px"},filterable:"",clearable:""},{default:o(()=>[(f(!0),D(F,null,M(re.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.label},{default:o(()=>[t("span",null,N(l.label),1),t("span",yl,N(T(p).length(l.comment)>0?" - "+l.comment:""),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),a(y,{content:"如果没有找到默认处理者，则读取步骤上次的处理人作为默认处理者。",placement:"top-start"},{default:o(()=>[a(c,{modelValue:s.value.lastHandler,"onUpdate:modelValue":e[32]||(e[32]=l=>s.value.lastHandler=l),style:{"margin-left":"12px"},label:"上次处理者"},null,8,["modelValue"])]),_:1})]),Vl,t("td",wl,[a(r,{modelValue:s.value.defaultHandlerSqlOrMethod,"onUpdate:modelValue":e[33]||(e[33]=l=>s.value.defaultHandlerSqlOrMethod=l),style:{width:"100%"},type:"textarea",rows:4,placeholder:"[sql]开头的字符串表示为sql语句，否则表示为方法。",clearable:""},null,8,["modelValue"])])]),t("tr",null,[xl,t("td",null,[a(T(J),{modelValue:s.value.defaultHandler,"onUpdate:modelValue":e[34]||(e[34]=l=>s.value.defaultHandler=l),placeholder:"指定默认处理者",style:{width:"100%"},clearable:""},null,8,["modelValue"])])]),t("tr",null,[kl,t("td",null,[a(g,{modelValue:s.value.hanlderModel,"onUpdate:modelValue":e[35]||(e[35]=l=>s.value.hanlderModel=l),style:{width:"190px"},clearable:""},{default:o(()=>[a(i,{value:"0",label:"所有人同意"}),a(i,{value:"1",label:"一人同意即可"}),a(i,{value:"2",label:"依据人数比例"}),a(i,{value:"3",label:"按选择人员顺序处理"}),a(i,{value:"4",label:"独立处理"})]),_:1},8,["modelValue"]),t("span",Ul,[v("百分比"),a(r,{modelValue:s.value.percentage,"onUpdate:modelValue":e[36]||(e[36]=l=>s.value.percentage=l),style:{width:"54px","margin-left":"12px"}},null,8,["modelValue"]),v(" %")])]),Tl,t("td",null,[a(g,{modelValue:s.value.backModel,"onUpdate:modelValue":e[37]||(e[37]=l=>s.value.backModel=l),style:{width:"185px"},clearable:""},{default:o(()=>[a(i,{value:"1",label:"根据处理策略退回"}),a(i,{value:"2",label:"一人退回全部退回"}),a(i,{value:"3",label:"所有人退回才退回"}),a(i,{value:"4",label:"独立退回"}),a(i,{value:"0",label:"不能退回"})]),_:1},8,["modelValue"]),a(y,{content:"退回时处理人自己选择接收人",placement:"top-start"},{default:o(()=>[a(c,{modelValue:s.value.backSelectUser,"onUpdate:modelValue":e[38]||(e[38]=l=>s.value.backSelectUser=l),style:{"margin-left":"12px"},label:"选择退回接收人"},null,8,["modelValue"])]),_:1})])]),t("tr",null,[Sl,t("td",null,[a(g,{modelValue:s.value.countersignature,"onUpdate:modelValue":e[39]||(e[39]=l=>s.value.countersignature=l),style:{width:"190px"},clearable:""},{default:o(()=>[a(i,{value:"0",label:"不会签"}),a(i,{value:"1",label:"所有步骤同意"}),a(i,{value:"2",label:"一个步骤同意即可"}),a(i,{value:"3",label:"依据比例"})]),_:1},8,["modelValue"]),t("span",Cl,[v("百分比"),a(r,{modelValue:s.value.countersignaturePercentage,"onUpdate:modelValue":e[40]||(e[40]=l=>s.value.countersignaturePercentage=l),style:{width:"54px","margin-left":"12px"}},null,8,["modelValue"]),v(" %")])]),Dl,t("td",null,[a(g,{modelValue:s.value.backType,"onUpdate:modelValue":e[41]||(e[41]=l=>s.value.backType=l),style:{width:"185px"},clearable:""},{default:o(()=>[a(i,{value:"0",label:"退回前一步"}),a(i,{value:"1",label:"退回第一步"}),a(i,{value:"2",label:"退回某一步"})]),_:1},8,["modelValue"]),a(y,{content:"如果是退回任务时直接发送到退回的步骤",placement:"top-start"},{default:o(()=>[a(c,{modelValue:s.value.sendToBackStep,"onUpdate:modelValue":e[42]||(e[42]=l=>s.value.sendToBackStep=l),style:{"margin-left":"12px"}},{default:o(()=>[v("发送到退回步骤")]),_:1},8,["modelValue"])]),_:1})])]),t("tr",null,[Bl,t("td",null,[a(g,{modelValue:s.value.countersignatureStartStep,"onUpdate:modelValue":e[43]||(e[43]=l=>s.value.countersignatureStartStep=l),style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(G.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),Ml,t("td",null,[a(g,{multiple:"",modelValue:s.value.backStep,"onUpdate:modelValue":e[44]||(e[44]=l=>s.value.backStep=l),placeholder:'选择退回类型为"退回某一步"时的步骤',style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(G.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[Fl,t("td",Ol,[a(y,{content:"上一步发送人和该步接收人为同一人时跳过",placement:"top-start"},{default:o(()=>[a(c,{style:{"margin-right":"12px","vertical-align":"middle"},modelValue:s.value.skipIdenticalUser,"onUpdate:modelValue":e[45]||(e[45]=l=>s.value.skipIdenticalUser=l),label:"同一处理人"},null,8,["modelValue"])]),_:1}),a(y,{content:"没有找到默认处理人时跳过",placement:"top-start"},{default:o(()=>[a(c,{style:{"margin-right":"12px","vertical-align":"middle"},modelValue:s.value.skipNoHandler,"onUpdate:modelValue":e[46]||(e[46]=l=>s.value.skipNoHandler=l),label:"无默认处理人"},null,8,["modelValue"])]),_:1}),t("span",null,[v("方法"),a(r,{modelValue:s.value.skipMethod,"onUpdate:modelValue":e[47]||(e[47]=l=>s.value.skipMethod=l),placeholder:'方法返回布尔true或字符串"1"或"true"时跳过',style:{width:"554px","margin-left":"12px"}},null,8,["modelValue"])])])])])]),_:1}),a(H,{name:"2",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(De)]),_:1}),v("按钮 ")]),default:o(()=>[t("div",Al,[t("table",Nl,[t("tbody",null,[t("tr",null,[t("td",Il,[t("div",Pl,[a(Be,{style:{height:"100%"}},{default:o(()=>[t("div",jl,[(f(!0),D(F,null,M(T(Q),l=>(f(),D("div",{key:l.id,class:de(`roadui_draggable_item${l.id==V.value.id?" roadui_draggable_itemhover":""}`),onDblclick:P=>{z(l),pe()},onClick:P=>z(l)},[T(p).length(l.ico)>0?(f(),C(he(l.ico),{key:0})):le("",!0),v(" "+N(l.name),1)],42,ql))),128))])]),_:1})])]),t("td",Rl,[t("div",null,[t("div",null,[a(fe,{type:"primary",onClick:e[48]||(e[48]=l=>pe())},{default:o(()=>[v("添加")]),_:1})]),t("div",null,[a(fe,{type:"primary",onClick:e[49]||(e[49]=l=>me())},{default:o(()=>[v("移出")]),_:1})])])]),t("td",Hl,[t("div",Ll,[a(T(Le),{list:S.value,onSort:X,"item-key":"key",animation:200,group:{name:"stepButton",pull:!0}},{item:o(({element:l})=>[t("div",{class:de(`roadui_draggable_item${l.id==V.value.id?" roadui_draggable_itemhover":""}`),onDblclick:P=>{z(l),me()},onClick:P=>z(l)},[t("div",null,[T(p).length(l.ico)>0?(f(),C(he(l.ico),{key:0})):le("",!0),v(" "+N(l.name),1)])],42,Wl)]),_:1},8,["list"])])]),t("td",$l,[t("div",El,[Gl,Jl,Kl,Ql,t("div",null,[a(r,{modelValue:V.value.showTitle,"onUpdate:modelValue":e[50]||(e[50]=l=>V.value.showTitle=l),onChange:X},null,8,["modelValue"])]),zl,t("div",Xl,N(V.value.note),1)])])])])])])]),_:1}),a(H,{name:"3",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(Me)]),_:1}),v("数据 ")]),default:o(()=>[t("div",Zl,[t("span",null,[v(" 数据表 "),a(g,{style:{width:"200px","margin-left":"6px"},modelValue:L.value.table,"onUpdate:modelValue":e[51]||(e[51]=l=>L.value.table=l),onChange:Ue,clearable:""},{default:o(()=>[(f(!0),D(F,null,M(ne.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},{default:o(()=>[t("span",null,N(l.title),1),T(p).length(l.tableName)>0?(f(),D("span",Yl," ("+N(l.tableName)+")",1)):le("",!0)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),t("span",et,[v(" 状态 "),a(g,{style:{width:"86px","margin-left":"6px"},modelValue:L.value.status,"onUpdate:modelValue":e[52]||(e[52]=l=>L.value.status=l),onChange:Te},{default:o(()=>[a(i,{value:0,label:"编辑"}),a(i,{value:1,label:"只读"}),a(i,{value:2,label:"隐藏"})]),_:1},8,["modelValue"])]),t("span",lt,[v(" 数据验证 "),a(g,{style:{width:"90px","margin-left":"6px"},modelValue:L.value.check,"onUpdate:modelValue":e[53]||(e[53]=l=>L.value.check=l),onChange:Se},{default:o(()=>[a(i,{value:0,label:"不验证"}),a(i,{value:2,label:"验证"})]),_:1},8,["modelValue"])]),t("span",tt,[a(y,{content:"此步骤执行流程时是否将表单数据同步更新到绑定的数据表",placement:"top-start"},{default:o(()=>[a(c,{modelValue:n.value.dataToDb,"onUpdate:modelValue":e[54]||(e[54]=l=>n.value.dataToDb=l),label:"更新表"},null,8,["modelValue"])]),_:1})]),Re(t("span",at,[a(r,{modelValue:n.value.subtableWhere,"onUpdate:modelValue":e[55]||(e[55]=l=>n.value.subtableWhere=l),style:{width:"240px"},placeholder:"子表数据过滤条件"},null,8,["modelValue"])],512),[[He,ne.value.length>1]])]),a(Fe,{data:w.value,style:{width:"100%"},height:"468px"},{default:o(()=>[a(ee,{label:"数据表",prop:"tableName"}),a(ee,{label:"字段",prop:"field"},{default:o(l=>[t("span",null,N(l.row.comment),1),t("span",{class:de(T(p).length(l.row.comment)>0?"roadui_note":"")},N(T(p).length(l.row.comment)>0?"("+l.row.field+")":l.row.field),3)]),_:1}),a(ee,{label:"字段状态",width:"110"},{default:o(l=>[a(g,{modelValue:l.row.fieldStatus,"onUpdate:modelValue":P=>l.row.fieldStatus=P,onChange:P=>Z(l.row)},{default:o(()=>[a(i,{value:0,label:"编辑"}),a(i,{value:1,label:"只读"}),a(i,{value:2,label:"隐藏"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(ee,{label:"数据验证",width:"110"},{default:o(l=>[a(g,{modelValue:l.row.check,"onUpdate:modelValue":P=>l.row.check=P,onChange:P=>Z(l.row)},{default:o(()=>[a(i,{value:0,label:"不验证"}),a(i,{value:2,label:"验证"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1})]),_:1},8,["data"])]),_:1}),a(H,{name:"4",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(Oe)]),_:1}),v("抄送 ")]),default:o(()=>[t("table",ut,[t("tr",null,[ot,t("td",null,[a(T(J),{modelValue:k.value.memberId,"onUpdate:modelValue":e[56]||(e[56]=l=>k.value.memberId=l),placeholder:"抄送给指定的接收人",style:{width:"100%"},clearable:""},null,8,["modelValue"])])]),t("tr",null,[nt,t("td",null,[a(g,{modelValue:k.value.handlerType,"onUpdate:modelValue":e[57]||(e[57]=l=>k.value.handlerType=l),multiple:"",style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(R.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[dt,t("td",null,[a(g,{modelValue:k.value.steps,"onUpdate:modelValue":e[58]||(e[58]=l=>k.value.steps=l),placeholder:"抄送给某一步骤的处理人员",multiple:"",style:{width:"100%"},clearable:""},{default:o(()=>[(f(!0),D(F,null,M(G.value,l=>(f(),C(i,{key:l.value,value:l.value,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),t("tr",null,[st,t("td",null,[a(r,{type:"textarea",rows:3,placeholder:"通过sql或方法返回接收人，[sql]开头表示sql语句，否则表示方法。",modelValue:k.value.methodOrSql,"onUpdate:modelValue":e[59]||(e[59]=l=>k.value.methodOrSql=l)},null,8,["modelValue"])])]),t("tr",null,[it,t("td",null,[a(Y,{modelValue:k.value.time,"onUpdate:modelValue":e[60]||(e[60]=l=>k.value.time=l)},{default:o(()=>[a(O,{label:0},{default:o(()=>[v("步骤接收时")]),_:1}),a(O,{label:1},{default:o(()=>[v("步骤完成时")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[rt,t("td",null,[a(Ae,{modelValue:k.value.messageType,"onUpdate:modelValue":e[61]||(e[61]=l=>k.value.messageType=l)},{default:o(()=>[a(c,{label:0},{default:o(()=>[v("站内消息")]),_:1}),a(c,{label:1},{default:o(()=>[v("手机短信")]),_:1}),a(c,{label:2},{default:o(()=>[v("微信")]),_:1}),a(c,{label:4},{default:o(()=>[v("邮件")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[pt,t("td",null,[a(r,{type:"textarea",rows:3,modelValue:k.value.messageTemplate,"onUpdate:modelValue":e[62]||(e[62]=l=>k.value.messageTemplate=l)},null,8,["modelValue"])])])])]),_:1}),a(H,{name:"5",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(Ne)]),_:1}),v("事件 ")]),default:o(()=>[t("table",mt,[t("tr",null,[vt,t("td",null,[a(r,{type:"textarea",modelValue:U.value.submitBefore,"onUpdate:modelValue":e[63]||(e[63]=l=>U.value.submitBefore=l),placeholder:"方法返回字符串1、true以外的其他字符，表示为错误信息，返回客户端提示，任务不提交。"},null,8,["modelValue"])])]),t("tr",null,[ft,t("td",null,[a(r,{type:"textarea",modelValue:U.value.submitAfter,"onUpdate:modelValue":e[64]||(e[64]=l=>U.value.submitAfter=l),placeholder:"任务提交后执行"},null,8,["modelValue"])])]),t("tr",null,[ht,t("td",null,[a(r,{type:"textarea",modelValue:U.value.submitPassAfter,"onUpdate:modelValue":e[65]||(e[65]=l=>U.value.submitPassAfter=l),placeholder:"步骤提交通过后执行"},null,8,["modelValue"])])]),t("tr",null,[bt,t("td",null,[a(r,{type:"textarea",modelValue:U.value.backBefore,"onUpdate:modelValue":e[66]||(e[66]=l=>U.value.backBefore=l),placeholder:"方法返回字符串1、true以外的其他字符，表示为错误信息，返回客户端提示，任务不退回。"},null,8,["modelValue"])])]),t("tr",null,[_t,t("td",null,[a(r,{type:"textarea",modelValue:U.value.backAfter,"onUpdate:modelValue":e[67]||(e[67]=l=>U.value.backAfter=l),placeholder:"任务退回后执行"},null,8,["modelValue"])])]),t("tr",null,[gt,t("td",null,[a(r,{type:"textarea",modelValue:U.value.backPassAfter,"onUpdate:modelValue":e[68]||(e[68]=l=>U.value.backPassAfter=l),placeholder:"步骤退回通过后执行"},null,8,["modelValue"])])]),t("tr",null,[ct,t("td",null,[a(r,{type:"textarea",modelValue:U.value.dataSaveBefore,"onUpdate:modelValue":e[69]||(e[69]=l=>U.value.dataSaveBefore=l),placeholder:"表单数据保存前执行。方法返回字符串1、true以外的其他字符，表示为错误信息，返回客户端提示，任务不提交。"},null,8,["modelValue"])])])])]),_:1}),n.value.type==="subflow"?(f(),C(H,{key:0,name:"6",style:{height:"100%"}},{label:o(()=>[a(m,{class:"roadui_main_tabsvg"},{default:o(()=>[a(Ie)]),_:1}),v("子流程 ")]),default:o(()=>[t("table",yt,[t("tr",null,[Vt,t("td",null,[a(T(_e),{style:{width:"100%"},modelValue:I.value.flowId,"onUpdate:modelValue":e[70]||(e[70]=l=>I.value.flowId=l)},null,8,["modelValue"])])]),t("tr",null,[wt,t("td",null,[a(Y,{modelValue:I.value.flowStrategy,"onUpdate:modelValue":e[71]||(e[71]=l=>I.value.flowStrategy=l)},{default:o(()=>[a(O,{label:0},{default:o(()=>[v("子流程完成才能提交")]),_:1}),a(O,{label:1},{default:o(()=>[v("子流程发起即可提交")]),_:1}),a(O,{label:2},{default:o(()=>[v("子流程发起后自动提交")]),_:1}),a(O,{label:3},{default:o(()=>[v("子流程完成后自动提交")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[xt,t("td",null,[a(Y,{modelValue:I.value.taskType,"onUpdate:modelValue":e[72]||(e[72]=l=>I.value.taskType=l)},{default:o(()=>[a(O,{label:0},{default:o(()=>[v("所有人同一实例")]),_:1}),a(O,{label:1},{default:o(()=>[v("每个人单独实例")]),_:1})]),_:1},8,["modelValue"])])]),t("tr",null,[kt,t("td",null,[a(r,{type:"textarea",rows:3,placeholder:"发起子流程任务前设置子流程业务数据，任务标题等操作。",modelValue:I.value.activationBeforeEvent,"onUpdate:modelValue":e[73]||(e[73]=l=>I.value.activationBeforeEvent=l)},null,8,["modelValue"])])])])]),_:1})):le("",!0)]),_:1})}}};export{Ct as default};
