import{ai as _,aT as m,aF as W,c as X,a as h,W as e,bD as a,bI as Y,aX as i,aY as Z,o as B,U as r,bF as J,H as N,bi as S,aZ as K,I as Q}from"./_@vue-5ba92de9.js";const ee={class:"roadui_page"},le={style:{height:"calc(100% - 60px)",overflow:"auto"}},ae=h("span",null,"操作",-1),te={class:"dialog-footer"},ue={__name:"index",setup(oe){const g=_("ajax"),u=_("utils"),w=_("qs"),R=_("ElSelectico"),T=_("ElCodemirror"),s=m(!1),C=m(!1),x=m([]),k=m({}),o=m({});let V=[];const j=m({prop:"sort",order:"ascending"}),U=m(u.getPager(j.value)),q=m(null),c=m(!1),D=m(""),$={name:[{required:!0,message:"请输入按钮名称",trigger:"blur"}],scripts:[{required:!0,message:"请输入按钮脚本",trigger:"blur"}]};W(()=>{y()});const I=n=>{V=n},y=()=>{C.value=!0,s.value=!0,g.post("/Button/GetList",w.stringify({findname:k.value.name})).then(n=>{x.value=n.data,s.value=!1,C.value=!1}).catch(()=>{s.value=!1})},E=n=>{if(u.isUndef(n)||u.length(n.id)===0){o.value={id:u.emptyLong,name:"",type:"primary",sort:u.getArrayMax(x.value,"sort")+5},D.value="添加",c.value=!0;return}u.length(n.id)>0&&g.post("/Button/Get?buttonid="+n.id).then(l=>{l.success?(o.value=l.data,D.value="编辑 - "+l.data.name,c.value=!0):u.msg("获取数据失败！",!1)}).catch(()=>{})},M=async n=>{n&&await n.validate(l=>{if(l){s.value=!0;const f=o.value.id||"";g.post("/Button/Save?buttonid="+f,w.stringify(o.value)).then(d=>{let p=d.msg;u.length(p)===0&&(p=d.success?"保存成功！":"保存失败！"),u.msg(p,d.success),s.value=!1,d.success&&(c.value=!1,y()),s.value=!1}).catch(()=>{s.value=!1})}})},A=()=>{if(V.length===0){u.msg("请选择要删除的按钮！","error");return}u.confirm("您确定要删除所选按钮吗？",()=>{s.value=!0,g.post("/Button/Delete",w.stringify({ids:u.getArrayValues(V,"id").join(",")})).then(n=>{u.msg(n.success?"删除成功！":"删除失败！",n.success),s.value=!1,n.success&&(V=[],y())}).catch(()=>{s.value=!1})})};return(n,l)=>{const f=i("el-input"),d=i("el-form-item"),p=i("el-button"),F=i("el-form"),v=i("el-table-column"),G=i("el-table"),H=i("el-scrollbar"),b=i("el-radio"),L=i("el-radio-group"),z=i("el-input-number"),O=i("el-dialog"),P=Z("loading");return B(),X("div",ee,[h("div",null,[e(F,{inline:!0,onSubmit:l[2]||(l[2]=Y(()=>{},["prevent"]))},{default:a(()=>[e(d,{label:"名称"},{default:a(()=>[e(f,{modelValue:k.value.name,"onUpdate:modelValue":l[0]||(l[0]=t=>k.value.name=t),placeholder:"按钮名称",style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(p,{type:"primary",disabled:s.value,onClick:y},{default:a(()=>[r("查询")]),_:1},8,["disabled"]),e(p,{type:"primary",disabled:s.value,onClick:l[1]||(l[1]=t=>E(null))},{default:a(()=>[r("添加")]),_:1},8,["disabled"]),e(p,{type:"danger",disabled:s.value,onClick:A},{default:a(()=>[r("删除")]),_:1},8,["disabled"])]),_:1})]),_:1})]),h("div",le,[e(H,null,{default:a(()=>[J((B(),N(G,{data:x.value,stripe:U.value.tableStripe,border:U.value.tableBorder,style:{width:"100%"},"highlight-current-row":U.value.tableHighlightCurrentRow,onSelectionChange:I,"default-sort":j.value},{default:a(()=>[e(v,{type:"selection",width:"45"}),e(v,{prop:"name",label:"名称",sortable:""}),e(v,{prop:"ico",label:"图标",width:"200",sortable:""},{default:a(t=>[S(u).length(t.row.ico)>0?(B(),N(K(t.row.ico),{key:0,style:{width:"18px",height:"18px"}})):Q("",!0)]),_:1}),e(v,{prop:"note",label:"备注",sortable:""}),e(v,{prop:"sort",label:"排序",width:"90",sortable:""}),e(v,{width:"100"},{header:a(()=>[ae]),default:a(t=>[e(p,{size:"small",disabled:s.value,type:"primary",onClick:se=>E(t.row)},{default:a(()=>[r("编辑")]),_:2},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[P,C.value]])]),_:1})]),e(O,{modelValue:c.value,"onUpdate:modelValue":l[12]||(l[12]=t=>c.value=t),title:D.value,"align-center":"","destroy-on-close":"",width:"700px",draggable:"","close-on-click-modal":!1},{footer:a(()=>[h("span",te,[e(p,{disabled:s.value,type:"primary",onClick:l[10]||(l[10]=t=>M(q.value))},{default:a(()=>[r("保存")]),_:1},8,["disabled"]),e(p,{disabled:s.value,onClick:l[11]||(l[11]=t=>c.value=!1)},{default:a(()=>[r("关闭")]),_:1},8,["disabled"])])]),default:a(()=>[e(F,{model:o.value,ref_key:"ruleFormRef",ref:q,rules:$,"label-width":"80px"},{default:a(()=>[e(d,{label:"名称",prop:"name"},{default:a(()=>[e(f,{modelValue:o.value.name,"onUpdate:modelValue":l[3]||(l[3]=t=>o.value.name=t),placeholder:"按钮显示名称",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"脚本",prop:"scripts"},{default:a(()=>[e(S(T),{modelValue:o.value.scripts,"onUpdate:modelValue":l[4]||(l[4]=t=>o.value.scripts=t),placeholder:"按钮点击执行的js脚本",height:"120px"},null,8,["modelValue"])]),_:1}),e(d,{label:"图标",prop:"ico"},{default:a(()=>[e(S(R),{modelValue:o.value.ico,"onUpdate:modelValue":l[5]||(l[5]=t=>o.value.ico=t),clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"类型",prop:"type"},{default:a(()=>[e(L,{modelValue:o.value.type,"onUpdate:modelValue":l[6]||(l[6]=t=>o.value.type=t)},{default:a(()=>[e(b,{label:"primary"},{default:a(()=>[r("主要")]),_:1}),e(b,{label:""},{default:a(()=>[r("次要")]),_:1}),e(b,{label:"success"},{default:a(()=>[r("成功")]),_:1}),e(b,{label:"warning"},{default:a(()=>[r("警告")]),_:1}),e(b,{label:"danger "},{default:a(()=>[r("危险")]),_:1}),e(b,{label:"info "},{default:a(()=>[r("信息")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"操作地址",prop:"address"},{default:a(()=>[e(f,{modelValue:o.value.address,"onUpdate:modelValue":l[7]||(l[7]=t=>o.value.address=t),placeholder:"按钮对应的后端操作地址，验证权限用。"},null,8,["modelValue"])]),_:1}),e(d,{label:"备注",prop:"note"},{default:a(()=>[e(f,{modelValue:o.value.note,"onUpdate:modelValue":l[8]||(l[8]=t=>o.value.note=t),placeholder:"备注说明"},null,8,["modelValue"])]),_:1}),e(d,{label:"排序",prop:"sort"},{default:a(()=>[e(z,{modelValue:o.value.sort,"onUpdate:modelValue":l[9]||(l[9]=t=>o.value.sort=t),step:5,min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{ue as default};
