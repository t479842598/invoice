import{ai as w,aT as c,aF as $,A as E,c as G,a as C,W as a,bD as o,bF as L,H as k,aX as u,aY as W,o as b,bi as z,U as m,b9 as B}from"./_@vue-5ba92de9.js";const X={class:"roadui_page"},I={class:"roadui_pagerdiv"},Q={__name:"sendlist",setup(J){const D=w("ajax"),s=w("utils"),T=w("qs"),i=c(!1),h=c(!1),d=c({}),p=c([]);let _=[];const S=c([]),V=c({prop:"groupid",order:"descending"}),t=c(s.getPager(V.value));$(()=>{v(!1)});const M=E(()=>n=>{const e=n.split(",");let g=[];for(let r=0;r<e.length;r++)e[r]==0?g.push("站内消息"):e[r]==1?g.push("手机短信"):e[r]==2&&g.push("企业微信");return g.join(" ")}),U=n=>{_=n},Y=n=>{t.value.size=n,v(!1)},N=n=>{t.value.number=n,v(!1)},P=n=>{t.value.order=s.getOrder(n),v(!1)},v=n=>{n&&(t.value.number=1),h.value=!0,i.value=!0,d.value.size=t.value.size,d.value.number=t.value.number,d.value.order=t.value.order,d.value.date1=s.length(p.value)>0?p.value[0]:"",d.value.date2=s.length(p.value)>1?p.value[1]:"",D.post("/Message/GetSendList",T.stringify(d.value)).then(e=>{S.value=e.data.rows,t.value.total=e.data.total,i.value=!1,h.value=!1}).catch(()=>{i.value=!1})},A=()=>{if(_.length===0){s.msg("您没有选择要删除的消息！",!1);return}s.confirm("您确定要删除所选消息吗？",()=>{i.value=!0,D.post("/Message/Delete?type=0",T.stringify({ids:s.getArrayValues(_,"id").join(",")})).then(n=>{let e=n.msg;s.length(e)===0&&(e=n.success?"删除成功！":"删除失败！"),s.msg(e,n.success),i.value=!1,n.success&&(_=[],v(!1))}).catch(()=>{})})};return(n,e)=>{const g=u("el-input"),r=u("el-form-item"),O=u("el-date-picker"),x=u("el-button"),R=u("el-form"),f=u("el-table-column"),y=u("el-tag"),j=u("el-tooltip"),q=u("el-table"),F=u("el-pagination"),H=W("loading");return b(),G("div",X,[C("div",null,[a(R,{inline:!0},{default:o(()=>[a(r,{label:"内容"},{default:o(()=>[a(g,{modelValue:d.value.contents,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value.contents=l),style:{width:"200px"},placeholder:"消息内容",clearable:""},null,8,["modelValue"])]),_:1}),a(r,{label:"日期"},{default:o(()=>[a(O,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),style:{width:"220px"},type:"daterange","value-format":"YYYY-MM-DD","unlink-panels":"","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:z(s).dateShortucts},null,8,["modelValue","shortcuts"])]),_:1}),a(r,null,{default:o(()=>[a(x,{type:"primary",disabled:i.value,onClick:e[2]||(e[2]=l=>v(!0))},{default:o(()=>[m("查询")]),_:1},8,["disabled"]),a(x,{type:"danger",disabled:i.value,onClick:e[3]||(e[3]=l=>A())},{default:o(()=>[m("删除")]),_:1},8,["disabled"])]),_:1})]),_:1})]),C("div",null,[L((b(),k(q,{data:S.value,stripe:t.value.tableStripe,border:t.value.tableBorder,style:{width:"100%"},"highlight-current-row":t.value.tableHighlightCurrentRow,"default-sort":V.value,onSortChange:P,onSelectionChange:U},{default:o(()=>[a(f,{type:"selection",width:"45",selectable:l=>z(s).length(l.readTime)===0},null,8,["selectable"]),a(f,{prop:"contents",label:"消息内容",sortable:"custom"}),a(f,{prop:"sendTime",label:"发送日期",sortable:"custom",width:"150"}),a(f,{prop:"sendType",label:"接收人",sortable:"custom",width:"120"},{default:o(l=>[a(j,{placement:"left",content:l.row.receiverOrganize},{default:o(()=>[a(y,null,{default:o(()=>[m(B(l.row.receiverName),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(f,{prop:"sendType",label:"接收方式",sortable:"custom",width:"220"},{default:o(l=>[m(B(M.value(l.row.sendType)),1)]),_:1}),a(f,{prop:"type",label:"状态",sortable:"custom",width:"80"},{default:o(l=>[z(s).length(l.row.readTime)===0?(b(),k(y,{key:0,type:"info"},{default:o(()=>[m("未读")]),_:1})):(b(),k(j,{key:1,placement:"left",content:"阅读时间 "+l.row.readTime},{default:o(()=>[a(y,{type:"success",effect:"dark"},{default:o(()=>[m("已读")]),_:1})]),_:2},1032,["content"]))]),_:1})]),_:1},8,["data","stripe","border","highlight-current-row","default-sort"])),[[H,h.value]]),C("div",I,[a(F,{currentPage:t.value.number,"onUpdate:currentPage":e[4]||(e[4]=l=>t.value.number=l),"page-size":t.value.size,"onUpdate:pageSize":e[5]||(e[5]=l=>t.value.size=l),"page-sizes":t.value.sizes,background:t.value.background,layout:t.value.layout,total:t.value.total,disabled:i.value,onSizeChange:Y,onCurrentChange:N},null,8,["currentPage","page-size","page-sizes","background","layout","total","disabled"])])])])}}};export{Q as default};
