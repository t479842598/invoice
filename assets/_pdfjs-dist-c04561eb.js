import{c as commonjsGlobal,r as require$$5}from"./__vendor-5e6ac033.js";import{c as commonjsRequire}from"./_crypto-js-0812dcff.js";var pdfExports={},pdf={get exports(){return pdfExports},set exports(Q){pdfExports=Q}};(function(module,exports){(function(h,d){module.exports=d()})(commonjsGlobal,function(){return(()=>{var __webpack_modules__=[,(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.addLinkAttributes=F,h.deprecated=m,h.getFilenameFromUrl=P,h.getPdfFilenameFromUrl=r,h.getXfaPageViewport=Z,h.isDataScheme=V,h.isPdfFile=U,h.isValidFetchUrl=f,h.loadScript=x,h.StatTimer=h.RenderingCancelledException=h.PixelsPerInch=h.PDFDateString=h.PageViewport=h.LinkTarget=h.DOMSVGFactory=h.DOMStandardFontDataFactory=h.DOMCMapReaderFactory=h.DOMCanvasFactory=void 0;var e=d(2),p=d(5);const S="noopener noreferrer nofollow",T="http://www.w3.org/2000/svg",b={CSS:96,PDF:72,get PDF_TO_CSS_UNITS(){return(0,e.shadow)(this,"PDF_TO_CSS_UNITS",this.CSS/this.PDF)}};h.PixelsPerInch=b;class y extends p.BaseCanvasFactory{constructor({ownerDocument:E=globalThis.document}={}){super(),this._document=E}_createCanvas(E,O){const G=this._document.createElement("canvas");return G.width=E,G.height=O,G}}h.DOMCanvasFactory=y;async function u($,E=!1){if(f($,document.baseURI)){const O=await fetch($);if(!O.ok)throw new Error(O.statusText);return E?new Uint8Array(await O.arrayBuffer()):(0,e.stringToBytes)(await O.text())}return new Promise((O,G)=>{const H=new XMLHttpRequest;H.open("GET",$,!0),E&&(H.responseType="arraybuffer"),H.onreadystatechange=()=>{if(H.readyState===XMLHttpRequest.DONE){if(H.status===200||H.status===0){let B;if(E&&H.response?B=new Uint8Array(H.response):!E&&H.responseText&&(B=(0,e.stringToBytes)(H.responseText)),B){O(B);return}}G(new Error(H.statusText))}},H.send(null)})}class g extends p.BaseCMapReaderFactory{_fetchData(E,O){return u(E,this.isCompressed).then(G=>({cMapData:G,compressionType:O}))}}h.DOMCMapReaderFactory=g;class v extends p.BaseStandardFontDataFactory{_fetchData(E){return u(E,!0)}}h.DOMStandardFontDataFactory=v;class k extends p.BaseSVGFactory{_createSVG(E){return document.createElementNS(T,E)}}h.DOMSVGFactory=k;class _{constructor({viewBox:E,scale:O,rotation:G,offsetX:H=0,offsetY:B=0,dontFlip:K=!1}){this.viewBox=E,this.scale=O,this.rotation=G,this.offsetX=H,this.offsetY=B;const w=(E[2]+E[0])/2,o=(E[3]+E[1])/2;let t,s,n,l;switch(G%=360,G<0&&(G+=360),G){case 180:t=-1,s=0,n=0,l=1;break;case 90:t=0,s=1,n=1,l=0;break;case 270:t=0,s=-1,n=-1,l=0;break;case 0:t=1,s=0,n=0,l=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}K&&(n=-n,l=-l);let a,A,C,I;t===0?(a=Math.abs(o-E[1])*O+H,A=Math.abs(w-E[0])*O+B,C=Math.abs(E[3]-E[1])*O,I=Math.abs(E[2]-E[0])*O):(a=Math.abs(w-E[0])*O+H,A=Math.abs(o-E[1])*O+B,C=Math.abs(E[2]-E[0])*O,I=Math.abs(E[3]-E[1])*O),this.transform=[t*O,s*O,n*O,l*O,a-t*O*w-n*O*o,A-s*O*w-l*O*o],this.width=C,this.height=I}clone({scale:E=this.scale,rotation:O=this.rotation,offsetX:G=this.offsetX,offsetY:H=this.offsetY,dontFlip:B=!1}={}){return new _({viewBox:this.viewBox.slice(),scale:E,rotation:O,offsetX:G,offsetY:H,dontFlip:B})}convertToViewportPoint(E,O){return e.Util.applyTransform([E,O],this.transform)}convertToViewportRectangle(E){const O=e.Util.applyTransform([E[0],E[1]],this.transform),G=e.Util.applyTransform([E[2],E[3]],this.transform);return[O[0],O[1],G[0],G[1]]}convertToPdfPoint(E,O){return e.Util.applyInverseTransform([E,O],this.transform)}}h.PageViewport=_;class M extends e.BaseException{constructor(E,O){super(E,"RenderingCancelledException"),this.type=O}}h.RenderingCancelledException=M;const c={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};h.LinkTarget=c;function F($,{url:E,target:O,rel:G,enabled:H=!0}={}){(0,e.assert)(E&&typeof E=="string",'addLinkAttributes: A valid "url" parameter must provided.');const B=(0,e.removeNullCharacters)(E);H?$.href=$.title=B:($.href="",$.title=`Disabled: ${B}`,$.onclick=()=>!1);let K="";switch(O){case c.NONE:break;case c.SELF:K="_self";break;case c.BLANK:K="_blank";break;case c.PARENT:K="_parent";break;case c.TOP:K="_top";break}$.target=K,$.rel=typeof G=="string"?G:S}function V($){const E=$.length;let O=0;for(;O<E&&$[O].trim()==="";)O++;return $.substring(O,O+5).toLowerCase()==="data:"}function U($){return typeof $=="string"&&/\.pdf$/i.test($)}function P($){const E=$.indexOf("#"),O=$.indexOf("?"),G=Math.min(E>0?E:$.length,O>0?O:$.length);return $.substring($.lastIndexOf("/",G)+1,G)}function r($,E="document.pdf"){if(typeof $!="string")return E;if(V($))return(0,e.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),E;const O=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,G=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,H=O.exec($);let B=G.exec(H[1])||G.exec(H[2])||G.exec(H[3]);if(B&&(B=B[0],B.includes("%")))try{B=G.exec(decodeURIComponent(B))[0]}catch{}return B||E}class i{constructor(){this.started=Object.create(null),this.times=[]}time(E){E in this.started&&(0,e.warn)(`Timer is already running for ${E}`),this.started[E]=Date.now()}timeEnd(E){E in this.started||(0,e.warn)(`Timer has not been started for ${E}`),this.times.push({name:E,start:this.started[E],end:Date.now()}),delete this.started[E]}toString(){const E=[];let O=0;for(const G of this.times){const H=G.name;H.length>O&&(O=H.length)}for(const G of this.times){const H=G.end-G.start;E.push(`${G.name.padEnd(O)} ${H}ms
`)}return E.join("")}}h.StatTimer=i;function f($,E){try{const{protocol:O}=E?new URL($,E):new URL($);return O==="http:"||O==="https:"}catch{return!1}}function x($,E=!1){return new Promise((O,G)=>{const H=document.createElement("script");H.src=$,H.onload=function(B){E&&H.remove(),O(B)},H.onerror=function(){G(new Error(`Cannot load script at: ${H.src}`))},(document.head||document.documentElement).appendChild(H)})}function m($){}let D;class L{static toDateObject(E){if(!E||!(0,e.isString)(E))return null;D||(D=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const O=D.exec(E);if(!O)return null;const G=parseInt(O[1],10);let H=parseInt(O[2],10);H=H>=1&&H<=12?H-1:0;let B=parseInt(O[3],10);B=B>=1&&B<=31?B:1;let K=parseInt(O[4],10);K=K>=0&&K<=23?K:0;let w=parseInt(O[5],10);w=w>=0&&w<=59?w:0;let o=parseInt(O[6],10);o=o>=0&&o<=59?o:0;const t=O[7]||"Z";let s=parseInt(O[8],10);s=s>=0&&s<=23?s:0;let n=parseInt(O[9],10)||0;return n=n>=0&&n<=59?n:0,t==="-"?(K+=s,w+=n):t==="+"&&(K-=s,w-=n),new Date(Date.UTC(G,H,B,K,w,o))}}h.PDFDateString=L;function Z($,{scale:E=1,rotation:O=0}){const{width:G,height:H}=$.attributes.style,B=[0,0,parseInt(G),parseInt(H)];return new _({viewBox:B,scale:E,rotation:O})}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.arrayByteLength=it,h.arraysToBytes=st,h.assert=K,h.bytesToString=Y,h.createObjectURL=Mt,h.createPromiseCapability=Ot,h.createValidAbsoluteUrl=t,h.escapeString=bt,h.getModificationDate=Ft,h.getVerbosityLevel=O,h.info=G,h.isArrayBuffer=wt,h.isArrayEqual=Rt,h.isAscii=_t,h.isBool=Pt,h.isNum=Et,h.isSameOrigin=w,h.isString=kt,h.objectFromMap=ht,h.objectSize=nt,h.removeNullCharacters=z,h.setVerbosityLevel=E,h.shadow=s,h.string32=at,h.stringToBytes=J,h.stringToPDFString=gt,h.stringToUTF16BEString=yt,h.stringToUTF8String=ut,h.unreachable=B,h.utf8StringToString=Ct,h.warn=H,h.VerbosityLevel=h.Util=h.UNSUPPORTED_FEATURES=h.UnknownErrorException=h.UnexpectedResponseException=h.TextRenderingMode=h.StreamType=h.RenderingIntentFlag=h.PermissionFlag=h.PasswordResponses=h.PasswordException=h.PageActionEventType=h.OPS=h.MissingPDFException=h.IsLittleEndianCached=h.IsEvalSupportedCached=h.InvalidPDFException=h.ImageKind=h.IDENTITY_MATRIX=h.FormatError=h.FontType=h.FONT_IDENTITY_MATRIX=h.DocumentActionEventType=h.CMapCompressionType=h.BaseException=h.AnnotationType=h.AnnotationStateModelType=h.AnnotationReviewState=h.AnnotationReplyType=h.AnnotationMode=h.AnnotationMarkedState=h.AnnotationFlag=h.AnnotationFieldFlag=h.AnnotationBorderStyleType=h.AnnotationActionEventType=h.AbortException=void 0,d(3);const e=[1,0,0,1,0,0];h.IDENTITY_MATRIX=e;const p=[.001,0,0,.001,0,0];h.FONT_IDENTITY_MATRIX=p;const S={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};h.RenderingIntentFlag=S;const T={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};h.AnnotationMode=T;const b={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};h.PermissionFlag=b;const y={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};h.TextRenderingMode=y;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};h.ImageKind=u;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};h.AnnotationType=g;const v={MARKED:"Marked",REVIEW:"Review"};h.AnnotationStateModelType=v;const k={MARKED:"Marked",UNMARKED:"Unmarked"};h.AnnotationMarkedState=k;const _={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};h.AnnotationReviewState=_;const M={GROUP:"Group",REPLY:"R"};h.AnnotationReplyType=M;const c={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};h.AnnotationFlag=c;const F={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};h.AnnotationFieldFlag=F;const V={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};h.AnnotationBorderStyleType=V;const U={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};h.AnnotationActionEventType=U;const P={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};h.DocumentActionEventType=P;const r={O:"PageOpen",C:"PageClose"};h.PageActionEventType=r;const i={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};h.StreamType=i;const f={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};h.FontType=f;const x={ERRORS:0,WARNINGS:1,INFOS:5};h.VerbosityLevel=x;const m={NONE:0,BINARY:1,STREAM:2};h.CMapCompressionType=m;const D={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};h.OPS=D;const L={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};h.UNSUPPORTED_FEATURES=L;const Z={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};h.PasswordResponses=Z;let $=x.WARNINGS;function E(X){Number.isInteger(X)&&($=X)}function O(){return $}function G(X){$>=x.INFOS}function H(X){$>=x.WARNINGS}function B(X){throw new Error(X)}function K(X,j){X||B(j)}function w(X,j){let W;try{if(W=new URL(X),!W.origin||W.origin==="null")return!1}catch{return!1}const et=new URL(j,W);return W.origin===et.origin}function o(X){if(!X)return!1;switch(X.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function t(X,j=null,W=null){if(!X)return null;try{if(W&&typeof X=="string"){if(W.addDefaultProtocol&&X.startsWith("www.")){const rt=X.match(/\./g);rt&&rt.length>=2&&(X=`http://${X}`)}if(W.tryConvertEncoding)try{X=ut(X)}catch{}}const et=j?new URL(X,j):new URL(X);if(o(et))return et}catch{}return null}function s(X,j,W){return Object.defineProperty(X,j,{value:W,enumerable:!0,configurable:!0,writable:!1}),W}const n=function(){function j(W,et){this.constructor===j&&B("Cannot initialize BaseException."),this.message=W,this.name=et}return j.prototype=new Error,j.constructor=j,j}();h.BaseException=n;class l extends n{constructor(j,W){super(j,"PasswordException"),this.code=W}}h.PasswordException=l;class a extends n{constructor(j,W){super(j,"UnknownErrorException"),this.details=W}}h.UnknownErrorException=a;class A extends n{constructor(j){super(j,"InvalidPDFException")}}h.InvalidPDFException=A;class C extends n{constructor(j){super(j,"MissingPDFException")}}h.MissingPDFException=C;class I extends n{constructor(j,W){super(j,"UnexpectedResponseException"),this.status=W}}h.UnexpectedResponseException=I;class N extends n{constructor(j){super(j,"FormatError")}}h.FormatError=N;class R extends n{constructor(j){super(j,"AbortException")}}h.AbortException=R;const q=/\x00/g;function z(X){return typeof X!="string"?(H("The argument for removeNullCharacters must be a string."),X):X.replace(q,"")}function Y(X){K(X!==null&&typeof X=="object"&&X.length!==void 0,"Invalid argument for bytesToString");const j=X.length,W=8192;if(j<W)return String.fromCharCode.apply(null,X);const et=[];for(let rt=0;rt<j;rt+=W){const ot=Math.min(rt+W,j),ct=X.subarray(rt,ot);et.push(String.fromCharCode.apply(null,ct))}return et.join("")}function J(X){K(typeof X=="string","Invalid argument for stringToBytes");const j=X.length,W=new Uint8Array(j);for(let et=0;et<j;++et)W[et]=X.charCodeAt(et)&255;return W}function it(X){return X.length!==void 0?X.length:(K(X.byteLength!==void 0,"arrayByteLength - invalid argument."),X.byteLength)}function st(X){const j=X.length;if(j===1&&X[0]instanceof Uint8Array)return X[0];let W=0;for(let ot=0;ot<j;ot++)W+=it(X[ot]);let et=0;const rt=new Uint8Array(W);for(let ot=0;ot<j;ot++){let ct=X[ot];ct instanceof Uint8Array||(typeof ct=="string"?ct=J(ct):ct=new Uint8Array(ct));const St=ct.byteLength;rt.set(ct,et),et+=St}return rt}function at(X){return String.fromCharCode(X>>24&255,X>>16&255,X>>8&255,X&255)}function nt(X){return Object.keys(X).length}function ht(X){const j=Object.create(null);for(const[W,et]of X)j[W]=et;return j}function dt(){const X=new Uint8Array(4);return X[0]=1,new Uint32Array(X.buffer,0,1)[0]===1}const tt={get value(){return s(this,"value",dt())}};h.IsLittleEndianCached=tt;function lt(){try{return new Function(""),!0}catch{return!1}}const mt={get value(){return s(this,"value",lt())}};h.IsEvalSupportedCached=mt;const pt=[...Array(256).keys()].map(X=>X.toString(16).padStart(2,"0"));class ft{static makeHexColor(j,W,et){return`#${pt[j]}${pt[W]}${pt[et]}`}static transform(j,W){return[j[0]*W[0]+j[2]*W[1],j[1]*W[0]+j[3]*W[1],j[0]*W[2]+j[2]*W[3],j[1]*W[2]+j[3]*W[3],j[0]*W[4]+j[2]*W[5]+j[4],j[1]*W[4]+j[3]*W[5]+j[5]]}static applyTransform(j,W){const et=j[0]*W[0]+j[1]*W[2]+W[4],rt=j[0]*W[1]+j[1]*W[3]+W[5];return[et,rt]}static applyInverseTransform(j,W){const et=W[0]*W[3]-W[1]*W[2],rt=(j[0]*W[3]-j[1]*W[2]+W[2]*W[5]-W[4]*W[3])/et,ot=(-j[0]*W[1]+j[1]*W[0]+W[4]*W[1]-W[5]*W[0])/et;return[rt,ot]}static getAxialAlignedBoundingBox(j,W){const et=ft.applyTransform(j,W),rt=ft.applyTransform(j.slice(2,4),W),ot=ft.applyTransform([j[0],j[3]],W),ct=ft.applyTransform([j[2],j[1]],W);return[Math.min(et[0],rt[0],ot[0],ct[0]),Math.min(et[1],rt[1],ot[1],ct[1]),Math.max(et[0],rt[0],ot[0],ct[0]),Math.max(et[1],rt[1],ot[1],ct[1])]}static inverseTransform(j){const W=j[0]*j[3]-j[1]*j[2];return[j[3]/W,-j[1]/W,-j[2]/W,j[0]/W,(j[2]*j[5]-j[4]*j[3])/W,(j[4]*j[1]-j[5]*j[0])/W]}static apply3dTransform(j,W){return[j[0]*W[0]+j[1]*W[1]+j[2]*W[2],j[3]*W[0]+j[4]*W[1]+j[5]*W[2],j[6]*W[0]+j[7]*W[1]+j[8]*W[2]]}static singularValueDecompose2dScale(j){const W=[j[0],j[2],j[1],j[3]],et=j[0]*W[0]+j[1]*W[2],rt=j[0]*W[1]+j[1]*W[3],ot=j[2]*W[0]+j[3]*W[2],ct=j[2]*W[1]+j[3]*W[3],St=(et+ct)/2,xt=Math.sqrt((et+ct)**2-4*(et*ct-ot*rt))/2,vt=St+xt||1,Tt=St-xt||1;return[Math.sqrt(vt),Math.sqrt(Tt)]}static normalizeRect(j){const W=j.slice(0);return j[0]>j[2]&&(W[0]=j[2],W[2]=j[0]),j[1]>j[3]&&(W[1]=j[3],W[3]=j[1]),W}static intersect(j,W){function et(St,xt){return St-xt}const rt=[j[0],j[2],W[0],W[2]].sort(et),ot=[j[1],j[3],W[1],W[3]].sort(et),ct=[];if(j=ft.normalizeRect(j),W=ft.normalizeRect(W),rt[0]===j[0]&&rt[1]===W[0]||rt[0]===W[0]&&rt[1]===j[0])ct[0]=rt[1],ct[2]=rt[2];else return null;if(ot[0]===j[1]&&ot[1]===W[1]||ot[0]===W[1]&&ot[1]===j[1])ct[1]=ot[1],ct[3]=ot[2];else return null;return ct}}h.Util=ft;const At=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function gt(X){const j=X.length,W=[];if(X[0]==="þ"&&X[1]==="ÿ")for(let et=2;et<j;et+=2)W.push(String.fromCharCode(X.charCodeAt(et)<<8|X.charCodeAt(et+1)));else if(X[0]==="ÿ"&&X[1]==="þ")for(let et=2;et<j;et+=2)W.push(String.fromCharCode(X.charCodeAt(et+1)<<8|X.charCodeAt(et)));else for(let et=0;et<j;++et){const rt=At[X.charCodeAt(et)];W.push(rt?String.fromCharCode(rt):X.charAt(et))}return W.join("")}function bt(X){return X.replace(/([()\\\n\r])/g,j=>j===`
`?"\\n":j==="\r"?"\\r":`\\${j}`)}function _t(X){return/^[\x00-\x7F]*$/.test(X)}function yt(X){const j=["þÿ"];for(let W=0,et=X.length;W<et;W++){const rt=X.charCodeAt(W);j.push(String.fromCharCode(rt>>8&255),String.fromCharCode(rt&255))}return j.join("")}function ut(X){return decodeURIComponent(escape(X))}function Ct(X){return unescape(encodeURIComponent(X))}function Pt(X){return typeof X=="boolean"}function Et(X){return typeof X=="number"}function kt(X){return typeof X=="string"}function wt(X){return typeof X=="object"&&X!==null&&X.byteLength!==void 0}function Rt(X,j){if(X.length!==j.length)return!1;for(let W=0,et=X.length;W<et;W++)if(X[W]!==j[W])return!1;return!0}function Ft(X=new Date){return[X.getUTCFullYear().toString(),(X.getUTCMonth()+1).toString().padStart(2,"0"),X.getUTCDate().toString().padStart(2,"0"),X.getUTCHours().toString().padStart(2,"0"),X.getUTCMinutes().toString().padStart(2,"0"),X.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ot(){const X=Object.create(null);let j=!1;return Object.defineProperty(X,"settled",{get(){return j}}),X.promise=new Promise(function(W,et){X.resolve=function(rt){j=!0,W(rt)},X.reject=function(rt){j=!0,et(rt)}}),X}function Mt(X,j="",W=!1){if(URL.createObjectURL&&!W)return URL.createObjectURL(new Blob([X],{type:j}));const et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let rt=`data:${j};base64,`;for(let ot=0,ct=X.length;ot<ct;ot+=3){const St=X[ot]&255,xt=X[ot+1]&255,vt=X[ot+2]&255,Tt=St>>2,Lt=(St&3)<<4|xt>>4,Dt=ot+1<ct?(xt&15)<<2|vt>>6:64,It=ot+2<ct?vt&63:64;rt+=et[Tt]+et[Lt]+et[Dt]+et[It]}return rt}},(Q,h,d)=>{d(4)},(Q,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.isNodeJS=void 0;const d=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");h.isNodeJS=d},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BaseSVGFactory=h.BaseStandardFontDataFactory=h.BaseCMapReaderFactory=h.BaseCanvasFactory=void 0;var e=d(2);class p{constructor(){this.constructor===p&&(0,e.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,g){if(u<=0||g<=0)throw new Error("Invalid canvas size");const v=this._createCanvas(u,g);return{canvas:v,context:v.getContext("2d")}}reset(u,g,v){if(!u.canvas)throw new Error("Canvas is not specified");if(g<=0||v<=0)throw new Error("Invalid canvas size");u.canvas.width=g,u.canvas.height=v}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,g){(0,e.unreachable)("Abstract method `_createCanvas` called.")}}h.BaseCanvasFactory=p;class S{constructor({baseUrl:u=null,isCompressed:g=!1}){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=u,this.isCompressed=g}async fetch({name:u}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!u)throw new Error("CMap name must be specified.");const g=this.baseUrl+u+(this.isCompressed?".bcmap":""),v=this.isCompressed?e.CMapCompressionType.BINARY:e.CMapCompressionType.NONE;return this._fetchData(g,v).catch(k=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${g}`)})}_fetchData(u,g){(0,e.unreachable)("Abstract method `_fetchData` called.")}}h.BaseCMapReaderFactory=S;class T{constructor({baseUrl:u=null}){this.constructor===T&&(0,e.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=u}async fetch({filename:u}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!u)throw new Error("Font filename must be specified.");const g=`${this.baseUrl}${u}`;return this._fetchData(g).catch(v=>{throw new Error(`Unable to load font data at: ${g}`)})}_fetchData(u){(0,e.unreachable)("Abstract method `_fetchData` called.")}}h.BaseStandardFontDataFactory=T;class b{constructor(){this.constructor===b&&(0,e.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,g){if(u<=0||g<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),v.setAttribute("width",`${u}px`),v.setAttribute("height",`${g}px`),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${u} ${g}`),v}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,e.unreachable)("Abstract method `_createSVG` called.")}}h.BaseSVGFactory=b},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Q;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.RenderTask=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(7),_node_utils=__w_pdfjs_require__(8),_annotation_storage=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_xfa_text=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?_node_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(h){createPDFNetworkStream=h}function getDocument(h){const d=new PDFDocumentLoadingTask;let e;if(typeof h=="string"||h instanceof URL)e={url:h};else if((0,_util.isArrayBuffer)(h))e={data:h};else if(h instanceof PDFDataRangeTransport)e={range:h};else{if(typeof h!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!h.url&&!h.data&&!h.range)throw new Error("Invalid parameter object: need either .data, .range or .url");e=h}const p=Object.create(null);let S=null,T=null;for(const y in e){const u=e[y];switch(y){case"url":if(typeof window<"u")try{p[y]=new URL(u,window.location).href;continue}catch(g){(0,_util.warn)(`Cannot create valid URL: "${g}".`)}else if(typeof u=="string"||u instanceof URL){p[y]=u.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":S=u;continue;case"worker":T=u;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&u instanceof Buffer)p[y]=new Uint8Array(u);else{if(u instanceof Uint8Array)break;if(typeof u=="string")p[y]=(0,_util.stringToBytes)(u);else if(typeof u=="object"&&u!==null&&!isNaN(u.length))p[y]=new Uint8Array(u);else if((0,_util.isArrayBuffer)(u))p[y]=new Uint8Array(u);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}p[y]=u}if(p.rangeChunkSize=p.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,p.CMapReaderFactory=p.CMapReaderFactory||DefaultCMapReaderFactory,p.StandardFontDataFactory=p.StandardFontDataFactory||DefaultStandardFontDataFactory,p.ignoreErrors=p.stopAtErrors!==!0,p.fontExtraProperties=p.fontExtraProperties===!0,p.pdfBug=p.pdfBug===!0,p.enableXfa=p.enableXfa===!0,(typeof p.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(p.docBaseUrl))&&(p.docBaseUrl=null),Number.isInteger(p.maxImageSize)||(p.maxImageSize=-1),typeof p.useWorkerFetch!="boolean"&&(p.useWorkerFetch=p.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&p.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof p.isEvalSupported!="boolean"&&(p.isEvalSupported=!0),typeof p.disableFontFace!="boolean"&&(p.disableFontFace=_is_node.isNodeJS),typeof p.useSystemFonts!="boolean"&&(p.useSystemFonts=!_is_node.isNodeJS&&!p.disableFontFace),typeof p.ownerDocument>"u"&&(p.ownerDocument=globalThis.document),typeof p.disableRange!="boolean"&&(p.disableRange=!1),typeof p.disableStream!="boolean"&&(p.disableStream=!1),typeof p.disableAutoFetch!="boolean"&&(p.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(p.verbosity),!T){const y={verbosity:p.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};T=y.port?_PDFWorker.fromPort(y):new _PDFWorker(y),d._worker=T}const b=d.docId;return T.promise.then(function(){if(d.destroyed)throw new Error("Loading aborted");const y=_fetchDocument(T,p,S,b),u=new Promise(function(g){let v;S?v=new _transport_stream.PDFDataTransportStream({length:p.length,initialData:p.initialData,progressiveDone:p.progressiveDone,contentDispositionFilename:p.contentDispositionFilename,disableRange:p.disableRange,disableStream:p.disableStream},S):p.data||(v=createPDFNetworkStream({url:p.url,length:p.length,httpHeaders:p.httpHeaders,withCredentials:p.withCredentials,rangeChunkSize:p.rangeChunkSize,disableRange:p.disableRange,disableStream:p.disableStream})),g(v)});return Promise.all([y,u]).then(function([g,v]){if(d.destroyed)throw new Error("Loading aborted");const k=new _message_handler.MessageHandler(b,g,T.port);k.postMessageTransfers=T.postMessageTransfers;const _=new WorkerTransport(k,d,v,p);d._transport=_,k.send("Ready",null)})}).catch(d._capability.reject),d}async function _fetchDocument(h,d,e,p){if(h.destroyed)throw new Error("Worker was destroyed");e&&(d.length=e.length,d.initialData=e.initialData,d.progressiveDone=e.progressiveDone,d.contentDispositionFilename=e.contentDispositionFilename);const S=await h.messageHandler.sendWithPromise("GetDocRequest",{docId:p,apiVersion:"2.11.338",source:{data:d.data,url:d.url,password:d.password,disableAutoFetch:d.disableAutoFetch,rangeChunkSize:d.rangeChunkSize,length:d.length},maxImageSize:d.maxImageSize,disableFontFace:d.disableFontFace,postMessageTransfers:h.postMessageTransfers,docBaseUrl:d.docBaseUrl,ignoreErrors:d.ignoreErrors,isEvalSupported:d.isEvalSupported,fontExtraProperties:d.fontExtraProperties,enableXfa:d.enableXfa,useSystemFonts:d.useSystemFonts,cMapUrl:d.useWorkerFetch?d.cMapUrl:null,standardFontDataUrl:d.useWorkerFetch?d.standardFontDataUrl:null});if(h.destroyed)throw new Error("Worker was destroyed");return S}class PDFDocumentLoadingTask{static get idCounters(){return(0,_util.shadow)(this,"idCounters",{doc:0})}constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.idCounters.doc++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var d;this.destroyed=!0,await((d=this._transport)==null?void 0:d.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(d,e,p=!1,S=null){this.length=d,this.initialData=e,this.progressiveDone=p,this.contentDispositionFilename=S,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(d){this._rangeListeners.push(d)}addProgressListener(d){this._progressListeners.push(d)}addProgressiveReadListener(d){this._progressiveReadListeners.push(d)}addProgressiveDoneListener(d){this._progressiveDoneListeners.push(d)}onDataRange(d,e){for(const p of this._rangeListeners)p(d,e)}onDataProgress(d,e){this._readyCapability.promise.then(()=>{for(const p of this._progressListeners)p(d,e)})}onDataProgressiveRead(d){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(d)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const d of this._progressiveDoneListeners)d()})}transportReady(){this._readyCapability.resolve()}requestDataRange(d,e){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(d,e){this._pdfInfo=d,this._transport=e,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(d){return this._transport.getPage(d)}getPageIndex(d){return this._transport.getPageIndex(d)}getDestinations(){return this._transport.getDestinations()}getDestination(d){return this._transport.getDestination(d)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(d=!1){return this._transport.startCleanup(d||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(d,e,p,S,T=!1){this._pageIndex=d,this._pageInfo=e,this._ownerDocument=S,this._transport=p,this._stats=T?new _display_utils.StatTimer:null,this._pdfBug=T,this.commonObjs=p.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:d,rotation:e=this.rotate,offsetX:p=0,offsetY:S=0,dontFlip:T=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:d,rotation:e,offsetX:p,offsetY:S,dontFlip:T})}getAnnotations({intent:d="display"}={}){const e=this._transport.getRenderingIntent(d);let p=this._annotationPromises.get(e.cacheKey);return p||(p=this._transport.getAnnotations(this._pageIndex,e.renderingIntent),this._annotationPromises.set(e.cacheKey,p),p=p.then(S=>{for(const T of S)T.titleObj!==void 0&&Object.defineProperty(T,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),T.titleObj.str}}),T.contentsObj!==void 0&&Object.defineProperty(T,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),T.contentsObj.str}});return S})),p}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var d;return((d=this._transport._htmlForXfa)==null?void 0:d.children[this._pageIndex])||null}render({canvasContext:d,viewport:e,intent:p="display",annotationMode:S=_util.AnnotationMode.ENABLE,transform:T=null,imageLayer:b=null,canvasFactory:y=null,background:u=null,optionalContentConfigPromise:g=null}){var U,P;((U=arguments[0])==null?void 0:U.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&S===_util.AnnotationMode.ENABLE&&(S=_util.AnnotationMode.ENABLE_FORMS)),((P=arguments[0])==null?void 0:P.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&S===_util.AnnotationMode.ENABLE&&(S=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const v=this._transport.getRenderingIntent(p,S);this.pendingCleanup=!1,g||(g=this._transport.getOptionalContentConfig());let k=this._intentStates.get(v.cacheKey);k||(k=Object.create(null),this._intentStates.set(v.cacheKey,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const _=y||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),M=!!(v.renderingIntent&_util.RenderingIntentFlag.PRINT);k.displayReadyCapability||(k.displayReadyCapability=(0,_util.createPromiseCapability)(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(v));const c=r=>{k.renderTasks.delete(F),(this.cleanupAfterRender||M)&&(this.pendingCleanup=!0),this._tryCleanup(),r?(F.capability.reject(r),this._abortOperatorList({intentState:k,reason:r instanceof Error?r:new Error(r)})):F.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},F=new InternalRenderTask({callback:c,params:{canvasContext:d,viewport:e,transform:T,imageLayer:b,background:u},objs:this.objs,commonObjs:this.commonObjs,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:_,useRequestAnimationFrame:!M,pdfBug:this._pdfBug});(k.renderTasks||(k.renderTasks=new Set)).add(F);const V=F.task;return Promise.all([k.displayReadyCapability.promise,g]).then(([r,i])=>{if(this.pendingCleanup){c();return}this._stats&&this._stats.time("Rendering"),F.initializeGraphics({transparency:r,optionalContentConfig:i}),F.operatorListChanged()}).catch(c),V}getOperatorList({intent:d="display",annotationMode:e=_util.AnnotationMode.ENABLE}={}){function p(){T.operatorList.lastChunk&&(T.opListReadCapability.resolve(T.operatorList),T.renderTasks.delete(b))}const S=this._transport.getRenderingIntent(d,e,!0);let T=this._intentStates.get(S.cacheKey);T||(T=Object.create(null),this._intentStates.set(S.cacheKey,T));let b;return T.opListReadCapability||(b=Object.create(null),b.operatorListChanged=p,T.opListReadCapability=(0,_util.createPromiseCapability)(),(T.renderTasks||(T.renderTasks=new Set)).add(b),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(S)),T.opListReadCapability.promise}streamTextContent({normalizeWhitespace:d=!1,disableCombineTextItems:e=!1,includeMarkedContent:p=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:d===!0,combineTextItems:e!==!0,includeMarkedContent:p===!0},{highWaterMark:100,size(T){return T.items.length}})}getTextContent(d={}){if(this._transport._htmlForXfa)return this.getXfa().then(p=>_xfa_text.XfaText.textContent(p));const e=this.streamTextContent(d);return new Promise(function(p,S){function T(){b.read().then(function({value:u,done:g}){if(g){p(y);return}Object.assign(y.styles,u.styles),y.items.push(...u.items),T()},S)}const b=e.getReader(),y={items:[],styles:Object.create(null)};T()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const d=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const p of e.renderTasks)d.push(p.completed),p.cancel();return this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(d)}cleanup(d=!1){return this.pendingCleanup=!0,this._tryCleanup(d)}_tryCleanup(d=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:e,operatorList:p}of this._intentStates.values())if(e.size>0||!p.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,d&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(d,e){const p=this._intentStates.get(e);p&&(this._stats&&this._stats.timeEnd("Page Request"),p.displayReadyCapability&&p.displayReadyCapability.resolve(d))}_renderPageChunk(d,e){for(let p=0,S=d.length;p<S;p++)e.operatorList.fnArray.push(d.fnArray[p]),e.operatorList.argsArray.push(d.argsArray[p]);e.operatorList.lastChunk=d.lastChunk;for(const p of e.renderTasks)p.operatorListChanged();d.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:d,cacheKey:e}){const S=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:d,cacheKey:e,annotationStorage:d&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),T=this._intentStates.get(e);T.streamReader=S;const b=()=>{S.read().then(({value:y,done:u})=>{if(u){T.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,T),b())},y=>{if(T.streamReader=null,!this._transport.destroyed){if(T.operatorList){T.operatorList.lastChunk=!0;for(const u of T.renderTasks)u.operatorListChanged();this._tryCleanup()}if(T.displayReadyCapability)T.displayReadyCapability.reject(y);else if(T.opListReadCapability)T.opListReadCapability.reject(y);else throw y}})};b()}_abortOperatorList({intentState:d,reason:e,force:p=!1}){if(d.streamReader){if(!p){if(d.renderTasks.size>0)return;if(e instanceof _display_utils.RenderingCancelledException){d.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:d,reason:e,force:!0}),d.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(d.streamReader.cancel(new _util.AbortException(e.message)).catch(()=>{}),d.streamReader=null,!this._transport.destroyed){for(const[S,T]of this._intentStates)if(T===d){this._intentStates.delete(S);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(d,e){function p(b){var g;if(typeof b=="function"||typeof b=="symbol"||b instanceof URL)throw new Error(`LoopbackPort.postMessage - cannot clone: ${b==null?void 0:b.toString()}`);if(typeof b!="object"||b===null)return b;if(S.has(b))return S.get(b);let y,u;if((y=b.buffer)&&(0,_util.isArrayBuffer)(y))return e!=null&&e.includes(y)?u=new b.constructor(y,b.byteOffset,b.byteLength):u=new b.constructor(b),S.set(b,u),u;if(b instanceof Map){u=new Map,S.set(b,u);for(const[v,k]of b)u.set(v,p(k));return u}if(b instanceof Set){u=new Set,S.set(b,u);for(const v of b)u.add(p(v));return u}u=Array.isArray(b)?[]:Object.create(null),S.set(b,u);for(const v in b){let k,_=b;for(;!(k=Object.getOwnPropertyDescriptor(_,v));)_=Object.getPrototypeOf(_);typeof k.value>"u"||typeof k.value=="function"&&!((g=b.hasOwnProperty)!=null&&g.call(b,v))||(u[v]=p(k.value))}return u}const S=new WeakMap,T={data:p(d)};this._deferred.then(()=>{for(const b of this._listeners)b.call(this,T)})}addEventListener(d,e){this._listeners.push(e)}removeEventListener(d,e){const p=this._listeners.indexOf(e);this._listeners.splice(p,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const h=(Q=document==null?void 0:document.currentScript)==null?void 0:Q.src;h&&(PDFWorkerUtil.fallbackWorkerSrc=h.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.createCDNWrapper=function(h){const d=`importScripts("${h}");`;return URL.createObjectURL(new Blob([d]))}}class _PDFWorker{static get _workerPorts(){return(0,_util.shadow)(this,"_workerPorts",new WeakMap)}constructor({name:h=null,port:d=null,verbosity:e=(0,_util.getVerbosityLevel)()}={}){if(d&&_PDFWorker._workerPorts.has(d))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=h,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=e,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,d){_PDFWorker._workerPorts.set(d,this),this._initializeFromPort(d);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(h){this._port=h,this._messageHandler=new _message_handler.MessageHandler("main","worker",h),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let h=_PDFWorker.workerSrc;try{(0,_util.isSameOrigin)(window.location.href,h)||(h=PDFWorkerUtil.createCDNWrapper(new URL(h,window.location).href));const d=new Worker(h),e=new _message_handler.MessageHandler("main","worker",d),p=()=>{d.removeEventListener("error",S),e.destroy(),d.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},S=()=>{this._webWorker||p()};d.addEventListener("error",S),e.on("test",b=>{if(d.removeEventListener("error",S),this.destroyed){p();return}b?(this._messageHandler=e,this._port=d,this._webWorker=d,b.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),e.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),e.destroy(),d.terminate())}),e.on("ready",b=>{if(d.removeEventListener("error",S),this.destroyed){p();return}try{T()}catch{this._setupFakeWorker()}});const T=()=>{const b=new Uint8Array([this.postMessageTransfers?255:0]);try{e.send("test",b,[b.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),b[0]=0,e.send("test",b)}};T();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(h=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const d=new LoopbackPort;this._port=d;const e=`fake${PDFWorkerUtil.fakeWorkerId++}`,p=new _message_handler.MessageHandler(e+"_worker",e,d);h.setup(p,d);const S=new _message_handler.MessageHandler(e,e+"_worker",d);this._messageHandler=S,this._readyCapability.resolve(),S.send("configure",{verbosity:this.verbosity})}).catch(h=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${h.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_PDFWorker._workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(h){if(!(h!=null&&h.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return this._workerPorts.has(h.port)?this._workerPorts.get(h.port):new _PDFWorker(h)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var h;try{return((h=globalThis.pdfjsWorker)==null?void 0:h.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=_PDFWorker,_PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(d,e,p,S){this.messageHandler=d,this.loadingTask=e,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:e.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:S.ownerDocument,styleElement:S.styleElement}),this._params=S,S.useWorkerFetch||(this.CMapReaderFactory=new S.CMapReaderFactory({baseUrl:S.cMapUrl,isCompressed:S.cMapPacked}),this.StandardFontDataFactory=new S.StandardFontDataFactory({baseUrl:S.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=p,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(d,e=_util.AnnotationMode.ENABLE,p=!1){let S=_util.RenderingIntentFlag.DISPLAY,T="";switch(d){case"any":S=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":S=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${d}`)}switch(e){case _util.AnnotationMode.DISABLE:S+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:S+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:S+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,T=this.annotationStorage.lastModified;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${e}`)}return p&&(S+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:S,cacheKey:`${S}_${T}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const d=[];for(const p of this.pageCache)p&&d.push(p._destroy());this.pageCache.length=0,this.pagePromises.length=0,this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return d.push(e),Promise.all(d).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:d,loadingTask:e}=this;d.on("GetReader",(p,S)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=T=>{this._lastProgress={loaded:T.loaded,total:T.total}},S.onPull=()=>{this._fullReader.read().then(function({value:T,done:b}){if(b){S.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(T),"GetReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{S.error(T)})},S.onCancel=T=>{this._fullReader.cancel(T),S.ready.catch(b=>{if(!this.destroyed)throw b})}}),d.on("ReaderHeadersReady",p=>{const S=(0,_util.createPromiseCapability)(),T=this._fullReader;return T.headersReady.then(()=>{(!T.isStreamingSupported||!T.isRangeSupported)&&(this._lastProgress&&e.onProgress&&e.onProgress(this._lastProgress),T.onProgress=b=>{e.onProgress&&e.onProgress({loaded:b.loaded,total:b.total})}),S.resolve({isStreamingSupported:T.isStreamingSupported,isRangeSupported:T.isRangeSupported,contentLength:T.contentLength})},S.reject),S.promise}),d.on("GetRangeReader",(p,S)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const T=this._networkStream.getRangeReader(p.begin,p.end);if(!T){S.close();return}S.onPull=()=>{T.read().then(function({value:b,done:y}){if(y){S.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(b),"GetRangeReader - expected an ArrayBuffer."),S.enqueue(new Uint8Array(b),1,[b])}).catch(b=>{S.error(b)})},S.onCancel=b=>{T.cancel(b),S.ready.catch(y=>{if(!this.destroyed)throw y})}}),d.on("GetDoc",({pdfInfo:p})=>{this._numPages=p.numPages,this._htmlForXfa=p.htmlForXfa,delete p.htmlForXfa,e._capability.resolve(new PDFDocumentProxy(p,this))}),d.on("DocException",function(p){let S;switch(p.name){case"PasswordException":S=new _util.PasswordException(p.message,p.code);break;case"InvalidPDFException":S=new _util.InvalidPDFException(p.message);break;case"MissingPDFException":S=new _util.MissingPDFException(p.message);break;case"UnexpectedResponseException":S=new _util.UnexpectedResponseException(p.message,p.status);break;case"UnknownErrorException":S=new _util.UnknownErrorException(p.message,p.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}e._capability.reject(S)}),d.on("PasswordRequest",p=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),e.onPassword){const S=T=>{this._passwordCapability.resolve({password:T})};try{e.onPassword(S,p.code)}catch(T){this._passwordCapability.reject(T)}}else this._passwordCapability.reject(new _util.PasswordException(p.message,p.code));return this._passwordCapability.promise}),d.on("DataLoaded",p=>{e.onProgress&&e.onProgress({loaded:p.length,total:p.length}),this.downloadInfoCapability.resolve(p)}),d.on("StartRenderPage",p=>{if(this.destroyed)return;this.pageCache[p.pageIndex]._startRenderPage(p.transparency,p.cacheKey)}),d.on("commonobj",p=>{var y;if(this.destroyed)return;const[S,T,b]=p;if(!this.commonObjs.has(S))switch(T){case"Font":const u=this._params;if("error"in b){const k=b.error;(0,_util.warn)(`Error during font loading: ${k}`),this.commonObjs.resolve(S,k);break}let g=null;u.pdfBug&&((y=globalThis.FontInspector)!=null&&y.enabled)&&(g={registerFont(k,_){globalThis.FontInspector.fontAdded(k,_)}});const v=new _font_loader.FontFaceObject(b,{isEvalSupported:u.isEvalSupported,disableFontFace:u.disableFontFace,ignoreErrors:u.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:g});this.fontLoader.bind(v).catch(k=>d.sendWithPromise("FontFallback",{id:S})).finally(()=>{!u.fontExtraProperties&&v.data&&(v.data=null),this.commonObjs.resolve(S,v)});break;case"FontPath":case"Image":this.commonObjs.resolve(S,b);break;default:throw new Error(`Got unknown common object type ${T}`)}}),d.on("obj",p=>{var g;if(this.destroyed)return;const[S,T,b,y]=p,u=this.pageCache[T];if(!u.objs.has(S))switch(b){case"Image":u.objs.resolve(S,y);const v=8e6;((g=y==null?void 0:y.data)==null?void 0:g.length)>v&&(u.cleanupAfterRender=!0);break;case"Pattern":u.objs.resolve(S,y);break;default:throw new Error(`Got unknown object type ${b}`)}}),d.on("DocProgress",p=>{this.destroyed||e.onProgress&&e.onProgress({loaded:p.loaded,total:p.total})}),d.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),d.on("FetchBuiltInCMap",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(p):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),d.on("FetchStandardFontData",p=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(p):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:d}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(d)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(d){if(!Number.isInteger(d)||d<=0||d>this._numPages)return Promise.reject(new Error("Invalid page request"));const e=d-1;if(e in this.pagePromises)return this.pagePromises[e];const p=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(S=>{if(this.destroyed)throw new Error("Transport destroyed");const T=new PDFPageProxy(e,S,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[e]=T,T});return this.pagePromises[e]=p,p}getPageIndex(d){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:d})}getAnnotations(d,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:d,intent:e})}saveDocument(){var d;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((d=this._fullReader)==null?void 0:d.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(d){return typeof d!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:d})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(d){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:d})}getStructTree(d){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:d})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(d=>new _optional_content_config.OptionalContentConfig(d))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(d=>{var e,p;return{info:d[0],metadata:d[1]?new _metadata.Metadata(d[1]):null,contentDispositionFilename:((e=this._fullReader)==null?void 0:e.filename)??null,contentLength:((p=this._fullReader)==null?void 0:p.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(d=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let e=0,p=this.pageCache.length;e<p;e++){const S=this.pageCache[e];if(!S)continue;if(!S.cleanup())throw new Error(`startCleanup: Page ${e+1} is currently rendering.`)}this.commonObjs.clear(),d||this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const d=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:d.disableAutoFetch,enableXfa:d.enableXfa})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(d){return this._objs[d]?this._objs[d]:this._objs[d]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(d,e=null){if(e)return this._ensureObj(d).capability.promise.then(e),null;const p=this._objs[d];if(!p||!p.resolved)throw new Error(`Requesting object that isn't resolved yet ${d}.`);return p.data}has(d){const e=this._objs[d];return(e==null?void 0:e.resolved)||!1}resolve(d,e){const p=this._ensureObj(d);p.resolved=!0,p.data=e,p.capability.resolve(e)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(d){this._internalRenderTask=d,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;class InternalRenderTask{static get canvasInUse(){return(0,_util.shadow)(this,"canvasInUse",new WeakSet)}constructor({callback:d,params:e,objs:p,commonObjs:S,operatorList:T,pageIndex:b,canvasFactory:y,useRequestAnimationFrame:u=!1,pdfBug:g=!1}){this.callback=d,this.params=e,this.objs=p,this.commonObjs=S,this.operatorListIdx=null,this.operatorList=T,this._pageIndex=b,this.canvasFactory=y,this._pdfBug=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:d=!1,optionalContentConfig:e}){var u;if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.canvasInUse.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.canvasInUse.add(this._canvas)}this._pdfBug&&((u=globalThis.StepperManager)!=null&&u.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:p,viewport:S,transform:T,imageLayer:b,background:y}=this.params;this.gfx=new _canvas.CanvasGraphics(p,this.commonObjs,this.objs,this.canvasFactory,b,e),this.gfx.beginDrawing({transform:T,viewport:S,transparency:d,background:y}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(d=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback(d||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback())))}}const version="2.11.338";exports.version=version;const build="dedff3c98";exports.build=build},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.FontLoader=h.FontFaceObject=void 0;var e=d(2);class p{constructor({docId:y,onUnsupportedFeature:u,ownerDocument:g=globalThis.document,styleElement:v=null}){this.constructor===p&&(0,e.unreachable)("Cannot initialize BaseFontLoader."),this.docId=y,this._onUnsupportedFeature=u,this._document=g,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(y){this.nativeFontFaces.push(y),this._document.fonts.add(y)}insertRule(y){let u=this.styleElement;u||(u=this.styleElement=this._document.createElement("style"),u.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(u));const g=u.sheet;g.insertRule(y,g.cssRules.length)}clear(){for(const y of this.nativeFontFaces)this._document.fonts.delete(y);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(y){if(y.attached||y.missingFile)return;if(y.attached=!0,this.isFontLoadingAPISupported){const g=y.createNativeFontFace();if(g){this.addNativeFontFace(g);try{await g.loaded}catch(v){throw this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,e.warn)(`Failed to load font '${g.family}': '${v}'.`),y.disableFontFace=!0,v}}return}const u=y.createFontFaceRule();if(u){if(this.insertRule(u),this.isSyncFontLoadingSupported)return;await new Promise(g=>{const v=this._queueLoadingCallback(g);this._prepareFontLoadEvent([u],[y],v)})}}_queueLoadingCallback(y){(0,e.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var u;const y=!!((u=this._document)!=null&&u.fonts);return(0,e.shadow)(this,"isFontLoadingAPISupported",y)}get isSyncFontLoadingSupported(){(0,e.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,e.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(y,u,g){(0,e.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let S;h.FontLoader=S,h.FontLoader=S=class extends p{constructor(y){super(y),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let y=!1;if(typeof navigator>"u")y=!0;else{const u=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(u==null?void 0:u[1])>=14&&(y=!0)}return(0,e.shadow)(this,"isSyncFontLoadingSupported",y)}_queueLoadingCallback(y){function u(){for((0,e.assert)(!v.done,"completeRequest() cannot be called twice."),v.done=!0;g.requests.length>0&&g.requests[0].done;){const k=g.requests.shift();setTimeout(k.callback,0)}}const g=this.loadingContext,v={id:`pdfjs-font-loading-${g.nextRequestId++}`,done:!1,complete:u,callback:y};return g.requests.push(v),v}get _loadTestFont(){const y=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,e.shadow)(this,"_loadTestFont",y())}_prepareFontLoadEvent(y,u,g){function v(E,O){return E.charCodeAt(O)<<24|E.charCodeAt(O+1)<<16|E.charCodeAt(O+2)<<8|E.charCodeAt(O+3)&255}function k(E,O,G,H){const B=E.substring(0,O),K=E.substring(O+G);return B+H+K}let _,M;const c=this._document.createElement("canvas");c.width=1,c.height=1;const F=c.getContext("2d");let V=0;function U(E,O){if(V++,V>30){(0,e.warn)("Load test font never loaded."),O();return}if(F.font="30px "+E,F.fillText(".",0,20),F.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(U.bind(null,E,O))}const P=`lt${Date.now()}${this.loadTestFontId++}`;let r=this._loadTestFont;r=k(r,976,P.length,P);const f=16,x=1482184792;let m=v(r,f);for(_=0,M=P.length-3;_<M;_+=4)m=m-x+v(P,_)|0;_<P.length&&(m=m-x+v(P+"XXX",_)|0),r=k(r,f,4,(0,e.string32)(m));const D=`url(data:font/opentype;base64,${btoa(r)});`,L=`@font-face {font-family:"${P}";src:${D}}`;this.insertRule(L);const Z=[];for(const E of u)Z.push(E.loadedName);Z.push(P);const $=this._document.createElement("div");$.style.visibility="hidden",$.style.width=$.style.height="10px",$.style.position="absolute",$.style.top=$.style.left="0px";for(const E of Z){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=E,$.appendChild(O)}this._document.body.appendChild($),U(P,()=>{this._document.body.removeChild($),g.complete()})}};class T{constructor(y,{isEvalSupported:u=!0,disableFontFace:g=!1,ignoreErrors:v=!1,onUnsupportedFeature:k,fontRegistry:_=null}){this.compiledGlyphs=Object.create(null);for(const M in y)this[M]=y[M];this.isEvalSupported=u!==!1,this.disableFontFace=g===!0,this.ignoreErrors=v===!0,this._onUnsupportedFeature=k,this.fontRegistry=_}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let y;if(!this.cssFontInfo)y=new FontFace(this.loadedName,this.data,{});else{const u={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(u.style=`oblique ${this.cssFontInfo.italicAngle}deg`),y=new FontFace(this.cssFontInfo.fontFamily,this.data,u)}return this.fontRegistry&&this.fontRegistry.registerFont(this),y}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const y=(0,e.bytesToString)(this.data),u=`url(data:${this.mimetype};base64,${btoa(y)});`;let g;if(!this.cssFontInfo)g=`@font-face {font-family:"${this.loadedName}";src:${u}}`;else{let v=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(v+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),g=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${v}src:${u}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,u),g}getPathGenerator(y,u){if(this.compiledGlyphs[u]!==void 0)return this.compiledGlyphs[u];let g;try{g=y.get(this.loadedName+"_path_"+u)}catch(v){if(!this.ignoreErrors)throw v;return this._onUnsupportedFeature({featureId:e.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,e.warn)(`getPathGenerator - ignoring character: "${v}".`),this.compiledGlyphs[u]=function(k,_){}}if(this.isEvalSupported&&e.IsEvalSupportedCached.value){const v=[];for(const k of g){const _=k.args!==void 0?k.args.join(","):"";v.push("c.",k.cmd,"(",_,`);
`)}return this.compiledGlyphs[u]=new Function("c","size",v.join(""))}return this.compiledGlyphs[u]=function(v,k){for(const _ of g)_.cmd==="scale"&&(_.args=[k,-k]),v[_.cmd].apply(v,_.args)}}}h.FontFaceObject=T},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.NodeStandardFontDataFactory=h.NodeCMapReaderFactory=h.NodeCanvasFactory=void 0;var e=d(5),p=d(4),S=d(2);let T=class{constructor(){(0,S.unreachable)("Not implemented: NodeCanvasFactory")}};h.NodeCanvasFactory=T;let b=class{constructor(){(0,S.unreachable)("Not implemented: NodeCMapReaderFactory")}};h.NodeCMapReaderFactory=b;let y=class{constructor(){(0,S.unreachable)("Not implemented: NodeStandardFontDataFactory")}};if(h.NodeStandardFontDataFactory=y,p.isNodeJS){const u=function(g){return new Promise((v,k)=>{require$$5.readFile(g,(M,c)=>{if(M||!c){k(new Error(M));return}v(new Uint8Array(c))})})};h.NodeCanvasFactory=T=class extends e.BaseCanvasFactory{_createCanvas(g,v){return require$$5.createCanvas(g,v)}},h.NodeCMapReaderFactory=b=class extends e.BaseCMapReaderFactory{_fetchData(g,v){return u(g).then(k=>({cMapData:k,compressionType:v}))}},h.NodeStandardFontDataFactory=y=class extends e.BaseStandardFontDataFactory{_fetchData(g){return u(g)}}}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.AnnotationStorage=void 0;var e=d(2);class p{constructor(){this._storage=new Map,this._timeStamp=Date.now(),this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(T,b){const y=this._storage.get(T);return y===void 0?b:Object.assign(b,y)}setValue(T,b){const y=this._storage.get(T);let u=!1;if(y!==void 0)for(const[g,v]of Object.entries(b))y[g]!==v&&(u=!0,y[g]=v);else u=!0,this._storage.set(T,b);u&&(this._timeStamp=Date.now(),this._setModified())}getAll(){return this._storage.size>0?(0,e.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get lastModified(){return this._timeStamp.toString()}}h.AnnotationStorage=p},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.CanvasGraphics=void 0;var e=d(2),p=d(11),S=d(1);const T=16,b=100,y=4096,u=2,g=15,v=10,k=1e3,_=16,M=1.000001;function c(w){if(!w.mozCurrentTransform){w._originalSave=w.save,w._originalRestore=w.restore,w._originalRotate=w.rotate,w._originalScale=w.scale,w._originalTranslate=w.translate,w._originalTransform=w.transform,w._originalSetTransform=w.setTransform,w._originalResetTransform=w.resetTransform,w._transformMatrix=w._transformMatrix||[1,0,0,1,0,0],w._transformStack=[];try{const o=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(w),"lineWidth");w._setLineWidth=o.set,w._getLineWidth=o.get,Object.defineProperty(w,"lineWidth",{set:function(s){this._setLineWidth(s*M)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(w,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(w,"mozCurrentTransformInverse",{get:function(){const[t,s,n,l,a,A]=this._transformMatrix,C=t*l-s*n,I=s*n-t*l;return[l/C,s/I,n/I,t/C,(l*a-n*A)/I,(s*a-t*A)/C]}}),w.save=function(){const t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},w.restore=function(){const t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},w.translate=function(t,s){const n=this._transformMatrix;n[4]=n[0]*t+n[2]*s+n[4],n[5]=n[1]*t+n[3]*s+n[5],this._originalTranslate(t,s)},w.scale=function(t,s){const n=this._transformMatrix;n[0]*=t,n[1]*=t,n[2]*=s,n[3]*=s,this._originalScale(t,s)},w.transform=function(t,s,n,l,a,A){const C=this._transformMatrix;this._transformMatrix=[C[0]*t+C[2]*s,C[1]*t+C[3]*s,C[0]*n+C[2]*l,C[1]*n+C[3]*l,C[0]*a+C[2]*A+C[4],C[1]*a+C[3]*A+C[5]],w._originalTransform(t,s,n,l,a,A)},w.setTransform=function(t,s,n,l,a,A){this._transformMatrix=[t,s,n,l,a,A],w._originalSetTransform(t,s,n,l,a,A)},w.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],w._originalResetTransform()},w.rotate=function(t){const s=Math.cos(t),n=Math.sin(t),l=this._transformMatrix;this._transformMatrix=[l[0]*s+l[2]*n,l[1]*s+l[3]*n,l[0]*-n+l[2]*s,l[1]*-n+l[3]*s,l[4],l[5]],this._originalRotate(t)}}}class F{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,t,s,n){let l;return this.cache[o]!==void 0?(l=this.cache[o],this.canvasFactory.reset(l,t,s),l.context.setTransform(1,0,0,1,0,0)):(l=this.canvasFactory.create(t,s),this.cache[o]=l),n&&c(l.context),l}clear(){for(const o in this.cache){const t=this.cache[o];this.canvasFactory.destroy(t),delete this.cache[o]}}}class V{constructor(o=0){this._cache=new Map,this._maxSize=o}has(o){return this._cache.has(o)}get(o){if(this._cache.has(o)){const t=this._cache.get(o);this._cache.delete(o),this._cache.set(o,t)}return this._cache.get(o)}set(o,t){this._maxSize<=0||(this._cache.size+1>this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(o,t))}clear(){this._cache.clear()}}function U(w){const t=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=w.width,n=w.height,l=s+1;let a,A,C,I;const N=new Uint8Array(l*(n+1)),R=s+7&-8,q=w.data,z=new Uint8Array(R*n);let Y=0;for(a=0,A=q.length;a<A;a++){const nt=q[a];let ht=128;for(;ht>0;)z[Y++]=nt&ht?0:255,ht>>=1}let J=0;for(Y=0,z[Y]!==0&&(N[0]=1,++J),C=1;C<s;C++)z[Y]!==z[Y+1]&&(N[C]=z[Y]?2:1,++J),Y++;for(z[Y]!==0&&(N[C]=2,++J),a=1;a<n;a++){Y=a*R,I=a*l,z[Y-R]!==z[Y]&&(N[I]=z[Y]?1:8,++J);let nt=(z[Y]?4:0)+(z[Y-R]?8:0);for(C=1;C<s;C++)nt=(nt>>2)+(z[Y+1]?4:0)+(z[Y-R+1]?8:0),t[nt]&&(N[I+C]=t[nt],++J),Y++;if(z[Y-R]!==z[Y]&&(N[I+C]=z[Y]?2:4,++J),J>1e3)return null}for(Y=R*(n-1),I=a*l,z[Y]!==0&&(N[I]=8,++J),C=1;C<s;C++)z[Y]!==z[Y+1]&&(N[I+C]=z[Y]?4:8,++J),Y++;if(z[Y]!==0&&(N[I+C]=4,++J),J>1e3)return null;const it=new Int32Array([0,l,-1,0,-l,0,0,0,1]),st=[];for(a=0;J&&a<=n;a++){let nt=a*l;const ht=nt+s;for(;nt<ht&&!N[nt];)nt++;if(nt===ht)continue;const dt=[nt%l,a],tt=nt;let lt=N[nt];do{const mt=it[lt];do nt+=mt;while(!N[nt]);const pt=N[nt];pt!==5&&pt!==10?(lt=pt,N[nt]=0):(lt=pt&51*lt>>4,N[nt]&=lt>>2|lt<<2),dt.push(nt%l,nt/l|0),N[nt]||--J}while(tt!==nt);st.push(dt),--a}return function(nt){nt.save(),nt.scale(1/s,-1/n),nt.translate(0,-n),nt.beginPath();for(let ht=0,dt=st.length;ht<dt;ht++){const tt=st[ht];nt.moveTo(tt[0],tt[1]);for(let lt=2,mt=tt.length;lt<mt;lt+=2)nt.lineTo(tt[lt],tt[lt+1])}nt.fill(),nt.beginPath(),nt.restore()}}class P{constructor(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=e.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=e.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}clone(){return Object.create(this)}setCurrentPoint(o,t){this.x=o,this.y=t}}function r(w,o,t=null){if(typeof ImageData<"u"&&o instanceof ImageData){w.putImageData(o,0,0);return}const s=o.height,n=o.width,l=s%_,a=(s-l)/_,A=l===0?a:a+1,C=w.createImageData(n,_);let I=0,N;const R=o.data,q=C.data;let z,Y,J,it,st,at,nt,ht;if(t)switch(t.length){case 1:st=t[0],at=t[0],nt=t[0],ht=t[0];break;case 4:st=t[0],at=t[1],nt=t[2],ht=t[3];break}if(o.kind===e.ImageKind.GRAYSCALE_1BPP){const dt=R.byteLength,tt=new Uint32Array(q.buffer,0,q.byteLength>>2),lt=tt.length,mt=n+7>>3;let pt=4294967295,ft=e.IsLittleEndianCached.value?4278190080:255;for(ht&&ht[0]===255&&ht[255]===0&&([pt,ft]=[ft,pt]),z=0;z<A;z++){for(J=z<a?_:l,N=0,Y=0;Y<J;Y++){const At=dt-I;let gt=0;const bt=At>mt?n:At*8-7,_t=bt&-8;let yt=0,ut=0;for(;gt<_t;gt+=8)ut=R[I++],tt[N++]=ut&128?pt:ft,tt[N++]=ut&64?pt:ft,tt[N++]=ut&32?pt:ft,tt[N++]=ut&16?pt:ft,tt[N++]=ut&8?pt:ft,tt[N++]=ut&4?pt:ft,tt[N++]=ut&2?pt:ft,tt[N++]=ut&1?pt:ft;for(;gt<bt;gt++)yt===0&&(ut=R[I++],yt=128),tt[N++]=ut&yt?pt:ft,yt>>=1}for(;N<lt;)tt[N++]=0;w.putImageData(C,0,z*_)}}else if(o.kind===e.ImageKind.RGBA_32BPP){const dt=!!(st||at||nt);for(Y=0,it=n*_*4,z=0;z<a;z++){if(q.set(R.subarray(I,I+it)),I+=it,dt)for(let tt=0;tt<it;tt+=4)st&&(q[tt+0]=st[q[tt+0]]),at&&(q[tt+1]=at[q[tt+1]]),nt&&(q[tt+2]=nt[q[tt+2]]);w.putImageData(C,0,Y),Y+=_}if(z<A){if(it=n*l*4,q.set(R.subarray(I,I+it)),dt)for(let tt=0;tt<it;tt+=4)st&&(q[tt+0]=st[q[tt+0]]),at&&(q[tt+1]=at[q[tt+1]]),nt&&(q[tt+2]=nt[q[tt+2]]);w.putImageData(C,0,Y)}}else if(o.kind===e.ImageKind.RGB_24BPP){const dt=!!(st||at||nt);for(J=_,it=n*J,z=0;z<A;z++){for(z>=a&&(J=l,it=n*J),N=0,Y=it;Y--;)q[N++]=R[I++],q[N++]=R[I++],q[N++]=R[I++],q[N++]=255;if(dt)for(let tt=0;tt<N;tt+=4)st&&(q[tt+0]=st[q[tt+0]]),at&&(q[tt+1]=at[q[tt+1]]),nt&&(q[tt+2]=nt[q[tt+2]]);w.putImageData(C,0,z*_)}}else throw new Error(`bad image kind: ${o.kind}`)}function i(w,o){const t=o.height,s=o.width,n=t%_,l=(t-n)/_,a=n===0?l:l+1,A=w.createImageData(s,_);let C=0;const I=o.data,N=A.data;for(let R=0;R<a;R++){const q=R<l?_:n;let z=3;for(let Y=0;Y<q;Y++){let J,it=0;for(let st=0;st<s;st++)it||(J=I[C++],it=128),N[z]=J&it?0:255,z+=4,it>>=1}w.putImageData(A,0,R*_)}}function f(w,o){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let s=0,n=t.length;s<n;s++){const l=t[s];w[l]!==void 0&&(o[l]=w[l])}w.setLineDash!==void 0&&(o.setLineDash(w.getLineDash()),o.lineDashOffset=w.lineDashOffset)}function x(w){w.strokeStyle="#000000",w.fillStyle="#000000",w.fillRule="nonzero",w.globalAlpha=1,w.lineWidth=1,w.lineCap="butt",w.lineJoin="miter",w.miterLimit=10,w.globalCompositeOperation="source-over",w.font="10px sans-serif",w.setLineDash!==void 0&&(w.setLineDash([]),w.lineDashOffset=0)}function m(w,o,t,s){const n=w.length;for(let l=3;l<n;l+=4){const a=w[l];if(a===0)w[l-3]=o,w[l-2]=t,w[l-1]=s;else if(a<255){const A=255-a;w[l-3]=w[l-3]*a+o*A>>8,w[l-2]=w[l-2]*a+t*A>>8,w[l-1]=w[l-1]*a+s*A>>8}}}function D(w,o,t){const s=w.length,n=1/255;for(let l=3;l<s;l+=4){const a=t?t[w[l]]:w[l];o[l]=o[l]*a*n|0}}function L(w,o,t){const s=w.length;for(let n=3;n<s;n+=4){const l=w[n-3]*77+w[n-2]*152+w[n-1]*28;o[n]=t?o[n]*t[l>>8]>>8:o[n]*l>>16}}function Z(w,o,t,s,n,l,a){const A=!!l,C=A?l[0]:0,I=A?l[1]:0,N=A?l[2]:0;let R;n==="Luminosity"?R=L:R=D;const z=Math.min(s,Math.ceil(1048576/t));for(let Y=0;Y<s;Y+=z){const J=Math.min(z,s-Y),it=w.getImageData(0,Y,t,J),st=o.getImageData(0,Y,t,J);A&&m(it.data,C,I,N),R(it.data,st.data,a),w.putImageData(st,0,Y)}}function $(w,o,t){const s=o.canvas,n=o.context;w.setTransform(o.scaleX,0,0,o.scaleY,o.offsetX,o.offsetY),Z(n,t,s.width,s.height,o.subtype,o.backdrop,o.transferMap),w.drawImage(s,0,0)}function E(w,o){const t=e.Util.singularValueDecompose2dScale(w);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*S.PixelsPerInch.PDF_TO_CSS_UNITS);return o!==void 0?o:t[0]<=s||t[1]<=s}const O=["butt","round","square"],G=["miter","round","bevel"],H={},B={};class K{constructor(o,t,s,n,l,a){this.ctx=o,this.current=new P,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.imageLayer=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=a,this.cachedCanvases=new F(this.canvasFactory),this.cachedCanvasPatterns=new V(u),this.cachedPatterns=new Map,o&&c(o),this._cachedGetSinglePixelWidth=null}beginDrawing({transform:o,viewport:t,transparency:s=!1,background:n=null}){const l=this.ctx.canvas.width,a=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=n||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,l,a),this.ctx.restore(),s){const A=this.cachedCanvases.getCanvas("transparent",l,a,!0);this.compositeCtx=this.ctx,this.transparentCanvas=A.canvas,this.ctx=A.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),x(this.ctx),o&&this.ctx.transform.apply(this.ctx,o),this.ctx.transform.apply(this.ctx,t.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(o,t,s,n){const l=o.argsArray,a=o.fnArray;let A=t||0;const C=l.length;if(C===A)return A;const I=C-A>v&&typeof s=="function",N=I?Date.now()+g:0;let R=0;const q=this.commonObjs,z=this.objs;let Y;for(;;){if(n!==void 0&&A===n.nextBreakPoint)return n.breakIt(A,s),A;if(Y=a[A],Y!==e.OPS.dependency)this[Y].apply(this,l[A]);else for(const J of l[A]){const it=J.startsWith("g_")?q:z;if(!it.has(J))return it.get(J,s),A}if(A++,A===C)return A;if(I&&++R>v){if(Date.now()>N)return s(),A;R=0}}}endDrawing(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedCanvasPatterns.clear(),this.cachedPatterns.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(o,t){const s=o.width,n=o.height;let l=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),A=s,C=n,I="prescale1",N,R;for(;l>2&&A>1||a>2&&C>1;){let q=A,z=C;l>2&&A>1&&(q=Math.ceil(A/2),l/=A/q),a>2&&C>1&&(z=Math.ceil(C/2),a/=C/z),N=this.cachedCanvases.getCanvas(I,q,z),R=N.context,R.clearRect(0,0,q,z),R.drawImage(o,0,0,A,C,0,0,q,z),o=N.canvas,A=q,C=z,I=I==="prescale1"?"prescale2":"prescale1"}return{img:o,paintWidth:A,paintHeight:C}}_createMaskCanvas(o){const t=this.ctx,s=o.width,n=o.height,l=this.current.fillColor,a=this.current.patternFill,A=this.cachedCanvases.getCanvas("maskCanvas",s,n),C=A.context;i(C,o);const I=t.mozCurrentTransform;let N=e.Util.transform(I,[1/s,0,0,-1/n,0,0]);N=e.Util.transform(N,[1,0,0,1,0,-n]);const R=e.Util.applyTransform([0,0],N),q=e.Util.applyTransform([s,n],N),z=e.Util.normalizeRect([R[0],R[1],q[0],q[1]]),Y=Math.ceil(z[2]-z[0]),J=Math.ceil(z[3]-z[1]),it=this.cachedCanvases.getCanvas("fillCanvas",Y,J,!0),st=it.context,at=Math.min(R[0],q[0]),nt=Math.min(R[1],q[1]);st.translate(-at,-nt),st.transform.apply(st,N);const ht=this._scaleImage(A.canvas,st.mozCurrentTransformInverse);st.imageSmoothingEnabled=E(st.mozCurrentTransform,o.interpolate),st.drawImage(ht.img,0,0,ht.img.width,ht.img.height,0,0,s,n),st.globalCompositeOperation="source-in";const dt=e.Util.transform(st.mozCurrentTransformInverse,[1,0,0,1,-at,-nt]);return st.fillStyle=a?l.getPattern(t,this,dt,!1):l,st.fillRect(0,0,s,n),{canvas:it.canvas,offsetX:Math.round(at),offsetY:Math.round(nt)}}setLineWidth(o){this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=O[o]}setLineJoin(o){this.ctx.lineJoin=G[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(o),s.lineDashOffset=t)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(let t=0,s=o.length;t<s;t++){const n=o[t],l=n[0],a=n[1];switch(l){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=n[1];break;case"ca":this.current.fillAlpha=n[1],this.ctx.globalAlpha=n[1];break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=a?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=a}}}beginSMaskGroup(){const o=this.current.activeSMask,t=o.canvas.width,s=o.canvas.height,n="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(n,t,s,!0),a=this.ctx,A=a.mozCurrentTransform;this.ctx.save();const C=l.context;C.scale(1/o.scaleX,1/o.scaleY),C.translate(-o.offsetX,-o.offsetY),C.transform.apply(C,A),o.startTransformInverse=C.mozCurrentTransformInverse,f(a,C),this.ctx=C,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}suspendSMaskGroup(){const o=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),$(this.ctx,this.current.activeSMask,o),this.ctx.restore(),this.ctx.save(),f(o,this.ctx),this.current.resumeSMaskCtx=o;const t=e.Util.transform(this.current.activeSMask.startTransformInverse,o.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),o.save(),o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,o.canvas.width,o.canvas.height),o.restore()}resumeSMaskGroup(){const o=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=o,this.groupStack.push(t),this.groupLevel++}endSMaskGroup(){const o=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),$(this.ctx,this.current.activeSMask,o),this.ctx.restore(),f(o,this.ctx);const t=e.Util.transform(this.current.activeSMask.startTransformInverse,o.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)}save(){this.ctx.save();const o=this.current;this.stateStack.push(o),this.current=o.clone(),this.current.resumeSMaskCtx=null}restore(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null}transform(o,t,s,n,l,a){this.ctx.transform(o,t,s,n,l,a),this._cachedGetSinglePixelWidth=null}constructPath(o,t){const s=this.ctx,n=this.current;let l=n.x,a=n.y;for(let A=0,C=0,I=o.length;A<I;A++)switch(o[A]|0){case e.OPS.rectangle:l=t[C++],a=t[C++];const N=t[C++],R=t[C++],q=l+N,z=a+R;s.moveTo(l,a),N===0||R===0?s.lineTo(q,z):(s.lineTo(q,a),s.lineTo(q,z),s.lineTo(l,z)),s.closePath();break;case e.OPS.moveTo:l=t[C++],a=t[C++],s.moveTo(l,a);break;case e.OPS.lineTo:l=t[C++],a=t[C++],s.lineTo(l,a);break;case e.OPS.curveTo:l=t[C+4],a=t[C+5],s.bezierCurveTo(t[C],t[C+1],t[C+2],t[C+3],l,a),C+=6;break;case e.OPS.curveTo2:s.bezierCurveTo(l,a,t[C],t[C+1],t[C+2],t[C+3]),l=t[C+2],a=t[C+3],C+=4;break;case e.OPS.curveTo3:l=t[C+2],a=t[C+3],s.bezierCurveTo(t[C],t[C+1],l,a,l,a),C+=4;break;case e.OPS.closePath:s.closePath();break}n.setCurrentPoint(l,a)}closePath(){this.ctx.closePath()}stroke(o){o=typeof o<"u"?o:!0;const t=this.ctx,s=this.current.strokeColor;if(t.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&(s!=null&&s.getPattern)){const n=this.getSinglePixelWidth();t.save(),t.strokeStyle=s.getPattern(t,this,t.mozCurrentTransformInverse),t.lineWidth=Math.max(n,this.current.lineWidth),t.stroke(),t.restore()}else{const n=this.getSinglePixelWidth();n<0&&-n>=this.current.lineWidth?(t.save(),t.resetTransform(),t.lineWidth=Math.round(this._combinedScaleFactor),t.stroke(),t.restore()):(t.lineWidth=Math.max(n,this.current.lineWidth),t.stroke())}o&&this.consumePath(),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o){o=typeof o<"u"?o:!0;const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;let l=!1;n&&(t.save(),t.fillStyle=s.getPattern(t,this,t.mozCurrentTransformInverse),l=!0),this.contentVisible&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),l&&t.restore(),o&&this.consumePath()}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=H}eoClip(){this.pendingClip=B}beginText(){this.current.textMatrix=e.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const o=this.pendingTextPaths,t=this.ctx;if(o===void 0){t.beginPath();return}t.save(),t.beginPath();for(let s=0;s<o.length;s++){const n=o[s];t.setTransform.apply(t,n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,t){const s=this.commonObjs.get(o),n=this.current;if(!s)throw new Error(`Can't find font for ${o}`);if(n.fontMatrix=s.fontMatrix||e.FONT_IDENTITY_MATRIX,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&(0,e.warn)("Invalid font matrix for font "+o),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const l=s.loadedName||"sans-serif";let a="normal";s.black?a="900":s.bold&&(a="bold");const A=s.italic?"italic":"normal",C=`"${l}", ${s.fallbackName}`;let I=t;t<T?I=T:t>b&&(I=b),this.current.fontSizeScale=t/I,this.ctx.font=`${A} ${a} ${I}px ${C}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,t){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=t}setLeadingMoveText(o,t){this.setLeading(-t),this.moveText(o,t)}setTextMatrix(o,t,s,n,l,a){this.current.textMatrix=[o,t,s,n,l,a],this.current.textMatrixScale=Math.hypot(o,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,t,s,n,l){const a=this.ctx,A=this.current,C=A.font,I=A.textRenderingMode,N=A.fontSize/A.fontSizeScale,R=I&e.TextRenderingMode.FILL_STROKE_MASK,q=!!(I&e.TextRenderingMode.ADD_TO_PATH_FLAG),z=A.patternFill&&!C.missingFile;let Y;(C.disableFontFace||q||z)&&(Y=C.getPathGenerator(this.commonObjs,o)),C.disableFontFace||z?(a.save(),a.translate(t,s),a.beginPath(),Y(a,N),n&&a.setTransform.apply(a,n),(R===e.TextRenderingMode.FILL||R===e.TextRenderingMode.FILL_STROKE)&&a.fill(),(R===e.TextRenderingMode.STROKE||R===e.TextRenderingMode.FILL_STROKE)&&(l&&(a.resetTransform(),a.lineWidth=Math.round(this._combinedScaleFactor)),a.stroke()),a.restore()):((R===e.TextRenderingMode.FILL||R===e.TextRenderingMode.FILL_STROKE)&&a.fillText(o,t,s),(R===e.TextRenderingMode.STROKE||R===e.TextRenderingMode.FILL_STROKE)&&(l?(a.save(),a.moveTo(t,s),a.resetTransform(),a.lineWidth=Math.round(this._combinedScaleFactor),a.strokeText(o,0,0),a.restore()):a.strokeText(o,t,s))),q&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:a.mozCurrentTransform,x:t,y:s,fontSize:N,addToPath:Y})}get isFontSubpixelAAEnabled(){const{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);const t=o.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return(0,e.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(o){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(o);const n=t.fontSize;if(n===0)return;const l=this.ctx,a=t.fontSizeScale,A=t.charSpacing,C=t.wordSpacing,I=t.fontDirection,N=t.textHScale*I,R=o.length,q=s.vertical,z=q?1:-1,Y=s.defaultVMetrics,J=n*t.fontMatrix[0],it=t.textRenderingMode===e.TextRenderingMode.FILL&&!s.disableFontFace&&!t.patternFill;l.save();let st;if(t.patternFill){l.save();const lt=t.fillColor.getPattern(l,this,l.mozCurrentTransformInverse);st=l.mozCurrentTransform,l.restore(),l.fillStyle=lt}l.transform.apply(l,t.textMatrix),l.translate(t.x,t.y+t.textRise),I>0?l.scale(N,-1):l.scale(N,1);let at=t.lineWidth,nt=!1;const ht=t.textMatrixScale;if(ht===0||at===0){const lt=t.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;(lt===e.TextRenderingMode.STROKE||lt===e.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,at=this.getSinglePixelWidth(),nt=at<0)}else at/=ht;a!==1&&(l.scale(a,a),at/=a),l.lineWidth=at;let dt=0,tt;for(tt=0;tt<R;++tt){const lt=o[tt];if((0,e.isNum)(lt)){dt+=z*lt*n/1e3;continue}let mt=!1;const pt=(lt.isSpace?C:0)+A,ft=lt.fontChar,At=lt.accent;let gt,bt,_t=lt.width;if(q){const ut=lt.vmetric||Y,Ct=-(lt.vmetric?ut[1]:_t*.5)*J,Pt=ut[2]*J;_t=ut?-ut[0]:_t,gt=Ct/a,bt=(dt+Pt)/a}else gt=dt/a,bt=0;if(s.remeasure&&_t>0){const ut=l.measureText(ft).width*1e3/n*a;if(_t<ut&&this.isFontSubpixelAAEnabled){const Ct=_t/ut;mt=!0,l.save(),l.scale(Ct,1),gt/=Ct}else _t!==ut&&(gt+=(_t-ut)/2e3*n/a)}if(this.contentVisible&&(lt.isInFont||s.missingFile)){if(it&&!At)l.fillText(ft,gt,bt);else if(this.paintChar(ft,gt,bt,st,nt),At){const ut=gt+n*At.offset.x/a,Ct=bt-n*At.offset.y/a;this.paintChar(At.fontChar,ut,Ct,st,nt)}}let yt;q?yt=_t*J-pt*I:yt=_t*J+pt*I,dt+=yt,mt&&l.restore()}q?t.y-=dt:t.x+=dt*N,l.restore()}showType3Text(o){const t=this.ctx,s=this.current,n=s.font,l=s.fontSize,a=s.fontDirection,A=n.vertical?1:-1,C=s.charSpacing,I=s.wordSpacing,N=s.textHScale*a,R=s.fontMatrix||e.FONT_IDENTITY_MATRIX,q=o.length,z=s.textRenderingMode===e.TextRenderingMode.INVISIBLE;let Y,J,it,st;if(!(z||l===0)){for(this._cachedGetSinglePixelWidth=null,t.save(),t.transform.apply(t,s.textMatrix),t.translate(s.x,s.y),t.scale(N,a),Y=0;Y<q;++Y){if(J=o[Y],(0,e.isNum)(J)){st=A*J*l/1e3,this.ctx.translate(st,0),s.x+=st*N;continue}const at=(J.isSpace?I:0)+C,nt=n.charProcOperatorList[J.operatorListId];if(!nt){(0,e.warn)(`Type3 character "${J.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=J,this.save(),t.scale(l,l),t.transform.apply(t,R),this.executeOperatorList(nt),this.restore()),it=e.Util.applyTransform([J.width,0],R)[0]*l+at,t.translate(it,0),s.x+=it*N}t.restore(),this.processingType3=null}}setCharWidth(o,t){}setCharWidthAndBounds(o,t,s,n,l,a){this.ctx.rect(s,n,l-s,a-n),this.clip(),this.endPath()}getColorN_Pattern(o){let t;if(o[0]==="TilingPattern"){const s=o[1],n=this.baseTransform||this.ctx.mozCurrentTransform.slice(),l={createCanvasGraphics:a=>new K(a,this.commonObjs,this.objs,this.canvasFactory)};t=new p.TilingPattern(o,s,this.ctx,l,n)}else t=this._getPattern(o[1],o[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,t,s){const n=e.Util.makeHexColor(o,t,s);this.ctx.strokeStyle=n,this.current.strokeColor=n}setFillRGBColor(o,t,s){const n=e.Util.makeHexColor(o,t,s);this.ctx.fillStyle=n,this.current.fillColor=n,this.current.patternFill=!1}_getPattern(o,t=null){let s;return this.cachedPatterns.has(o)?s=this.cachedPatterns.get(o):(s=(0,p.getShadingPattern)(this.objs.get(o),this.cachedCanvasPatterns),this.cachedPatterns.set(o,s)),t&&(s.matrix=t),s}shadingFill(o){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(o);t.fillStyle=s.getPattern(t,this,t.mozCurrentTransformInverse,!0);const n=t.mozCurrentTransformInverse;if(n){const l=t.canvas,a=l.width,A=l.height,C=e.Util.applyTransform([0,0],n),I=e.Util.applyTransform([0,A],n),N=e.Util.applyTransform([a,0],n),R=e.Util.applyTransform([a,A],n),q=Math.min(C[0],I[0],N[0],R[0]),z=Math.min(C[1],I[1],N[1],R[1]),Y=Math.max(C[0],I[0],N[0],R[0]),J=Math.max(C[1],I[1],N[1],R[1]);this.ctx.fillRect(q,z,Y-q,J-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}beginInlineImage(){(0,e.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,e.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&o.length===6&&this.transform.apply(this,o),this.baseTransform=this.ctx.mozCurrentTransform,t)){const s=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],s,n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save();const t=this.ctx;o.isolated||(0,e.info)("TODO: Support non-isolated groups."),o.knockout&&(0,e.warn)("Knockout groups not supported.");const s=t.mozCurrentTransform;if(o.matrix&&t.transform.apply(t,o.matrix),!o.bbox)throw new Error("Bounding box is required.");let n=e.Util.getAxialAlignedBoundingBox(o.bbox,t.mozCurrentTransform);const l=[0,0,t.canvas.width,t.canvas.height];n=e.Util.intersect(n,l)||[0,0,0,0];const a=Math.floor(n[0]),A=Math.floor(n[1]);let C=Math.max(Math.ceil(n[2])-a,1),I=Math.max(Math.ceil(n[3])-A,1),N=1,R=1;C>y&&(N=C/y,C=y),I>y&&(R=I/y,I=y);let q="groupAt"+this.groupLevel;o.smask&&(q+="_smask_"+this.smaskCounter++%2);const z=this.cachedCanvases.getCanvas(q,C,I,!0),Y=z.context;Y.scale(1/N,1/R),Y.translate(-a,-A),Y.transform.apply(Y,s),o.smask?this.smaskStack.push({canvas:z.canvas,context:Y,offsetX:a,offsetY:A,scaleX:N,scaleY:R,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,A),t.scale(N,R)),f(t,Y),this.ctx=Y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled=!1,o.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(o,t,s,n){if(this.save(),x(this.ctx),this.current=new P,Array.isArray(t)&&t.length===4){const l=t[2]-t[0],a=t[3]-t[1];this.ctx.rect(t[0],t[1],l,a),this.clip(),this.endPath()}this.transform.apply(this,s),this.transform.apply(this,n)}endAnnotation(){this.restore()}paintImageMaskXObject(o){if(!this.contentVisible)return;const t=this.ctx,s=o.width,n=o.height,l=this.processingType3;if(l&&l.compiled===void 0&&(s<=k&&n<=k?l.compiled=U({data:o.data,width:s,height:n}):l.compiled=null),l!=null&&l.compiled){l.compiled(t);return}const a=this._createMaskCanvas(o),A=a.canvas;t.save(),t.setTransform(1,0,0,1,0,0),t.drawImage(A,a.offsetX,a.offsetY),t.restore()}paintImageMaskXObjectRepeat(o,t,s=0,n=0,l,a){if(!this.contentVisible)return;const A=this.ctx;A.save();const C=A.mozCurrentTransform;A.transform(t,s,n,l,0,0);const I=this._createMaskCanvas(o);A.setTransform(1,0,0,1,0,0);for(let N=0,R=a.length;N<R;N+=2){const q=e.Util.transform(C,[t,s,n,l,a[N],a[N+1]]),[z,Y]=e.Util.applyTransform([0,0],q);A.drawImage(I.canvas,z,Y)}A.restore()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(let l=0,a=o.length;l<a;l++){const A=o[l],C=A.width,I=A.height,N=this.cachedCanvases.getCanvas("maskCanvas",C,I),R=N.context;R.save(),i(R,A),R.globalCompositeOperation="source-in",R.fillStyle=n?s.getPattern(R,this,t.mozCurrentTransformInverse,!1):s,R.fillRect(0,0,C,I),R.restore(),t.save(),t.transform.apply(t,A.transform),t.scale(1,-1),t.drawImage(N.canvas,0,0,C,I,0,-1,1,1),t.restore()}}paintImageXObject(o){if(!this.contentVisible)return;const t=o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o);if(!t){(0,e.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(o,t,s,n){if(!this.contentVisible)return;const l=o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o);if(!l){(0,e.warn)("Dependent image isn't ready yet");return}const a=l.width,A=l.height,C=[];for(let I=0,N=n.length;I<N;I+=2)C.push({transform:[t,0,0,s,n[I],n[I+1]],x:0,y:0,w:a,h:A});this.paintInlineImageXObjectGroup(l,C)}paintInlineImageXObject(o){if(!this.contentVisible)return;const t=o.width,s=o.height,n=this.ctx;this.save(),n.scale(1/t,-1/s);let l;if(typeof HTMLElement=="function"&&o instanceof HTMLElement||!o.data)l=o;else{const A=this.cachedCanvases.getCanvas("inlineImage",t,s),C=A.context;r(C,o,this.current.transferMaps),l=A.canvas}const a=this._scaleImage(l,n.mozCurrentTransformInverse);if(n.imageSmoothingEnabled=E(n.mozCurrentTransform,o.interpolate),n.drawImage(a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.imageLayer){const A=this.getCanvasPosition(0,-s);this.imageLayer.appendImage({imgData:o,left:A[0],top:A[1],width:t/n.mozCurrentTransformInverse[0],height:s/n.mozCurrentTransformInverse[3]})}this.restore()}paintInlineImageXObjectGroup(o,t){if(!this.contentVisible)return;const s=this.ctx,n=o.width,l=o.height,a=this.cachedCanvases.getCanvas("inlineImage",n,l),A=a.context;r(A,o,this.current.transferMaps);for(let C=0,I=t.length;C<I;C++){const N=t[C];if(s.save(),s.transform.apply(s,N.transform),s.scale(1,-1),s.drawImage(a.canvas,N.x,N.y,N.w,N.h,0,-1,1,1),this.imageLayer){const R=this.getCanvasPosition(N.x,N.y);this.imageLayer.appendImage({imgData:o,left:R[0],top:R[1],width:n,height:l})}s.restore()}}paintSolidColorImageMask(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)}markPoint(o){}markPointProps(o,t){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,t){o==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(){const o=this.ctx;this.pendingClip&&(this.pendingClip===B?o.clip("evenodd"):o.clip(),this.pendingClip=null),o.beginPath()}getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const o=this.ctx.mozCurrentTransform,t=Math.abs(o[0]*o[3]-o[2]*o[1]),s=o[0]**2+o[2]**2,n=o[1]**2+o[3]**2,l=Math.sqrt(Math.max(s,n))/t;s!==n&&this._combinedScaleFactor*l>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*l):t>Number.EPSILON?this._cachedGetSinglePixelWidth=l:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth}getCanvasPosition(o,t){const s=this.ctx.mozCurrentTransform;return[s[0]*o+s[2]*t+s[4],s[1]*o+s[3]*t+s[5]]}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}}h.CanvasGraphics=K;for(const w in e.OPS)K.prototype[w]!==void 0&&(K.prototype[e.OPS[w]]=K.prototype[w])},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getShadingPattern=v,h.TilingPattern=void 0;var e=d(2);function p(M,c){if(!c||typeof Path2D>"u")return;const F=c[2]-c[0],V=c[3]-c[1],U=new Path2D;U.rect(c[0],c[1],F,V),M.clip(U)}class S{constructor(){this.constructor===S&&(0,e.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,e.unreachable)("Abstract method `getPattern` called.")}}class T extends S{constructor(c,F){super(),this._type=c[1],this._bbox=c[2],this._colorStops=c[3],this._p0=c[4],this._p1=c[5],this._r0=c[6],this._r1=c[7],this.matrix=null,this.cachedCanvasPatterns=F}_createGradient(c){let F;this._type==="axial"?F=c.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(F=c.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const V of this._colorStops)F.addColorStop(V[0],V[1]);return F}getPattern(c,F,V,U=!1){let P;if(U)p(c,this._bbox),P=this._createGradient(c);else if(this.cachedCanvasPatterns.has(this))P=this.cachedCanvasPatterns.get(this);else{const r=F.cachedCanvases.getCanvas("pattern",F.ctx.canvas.width,F.ctx.canvas.height,!0),i=r.context;i.clearRect(0,0,i.canvas.width,i.canvas.height),i.beginPath(),i.rect(0,0,i.canvas.width,i.canvas.height),i.setTransform.apply(i,F.baseTransform),this.matrix&&i.transform.apply(i,this.matrix),p(i,this._bbox),i.fillStyle=this._createGradient(i),i.fill(),P=c.createPattern(r.canvas,"repeat"),this.cachedCanvasPatterns.set(this,P)}if(!U){const r=new DOMMatrix(V);try{P.setTransform(r)}catch(i){(0,e.warn)(`RadialAxialShadingPattern.getPattern: "${i==null?void 0:i.message}".`)}}return P}}function b(M,c,F,V,U,P,r,i){const f=c.coords,x=c.colors,m=M.data,D=M.width*4;let L;f[F+1]>f[V+1]&&(L=F,F=V,V=L,L=P,P=r,r=L),f[V+1]>f[U+1]&&(L=V,V=U,U=L,L=r,r=i,i=L),f[F+1]>f[V+1]&&(L=F,F=V,V=L,L=P,P=r,r=L);const Z=(f[F]+c.offsetX)*c.scaleX,$=(f[F+1]+c.offsetY)*c.scaleY,E=(f[V]+c.offsetX)*c.scaleX,O=(f[V+1]+c.offsetY)*c.scaleY,G=(f[U]+c.offsetX)*c.scaleX,H=(f[U+1]+c.offsetY)*c.scaleY;if($>=H)return;const B=x[P],K=x[P+1],w=x[P+2],o=x[r],t=x[r+1],s=x[r+2],n=x[i],l=x[i+1],a=x[i+2],A=Math.round($),C=Math.round(H);let I,N,R,q,z,Y,J,it;for(let st=A;st<=C;st++){if(st<O){let tt;st<$?tt=0:tt=($-st)/($-O),I=Z-(Z-E)*tt,N=B-(B-o)*tt,R=K-(K-t)*tt,q=w-(w-s)*tt}else{let tt;st>H?tt=1:O===H?tt=0:tt=(O-st)/(O-H),I=E-(E-G)*tt,N=o-(o-n)*tt,R=t-(t-l)*tt,q=s-(s-a)*tt}let at;st<$?at=0:st>H?at=1:at=($-st)/($-H),z=Z-(Z-G)*at,Y=B-(B-n)*at,J=K-(K-l)*at,it=w-(w-a)*at;const nt=Math.round(Math.min(I,z)),ht=Math.round(Math.max(I,z));let dt=D*st+nt*4;for(let tt=nt;tt<=ht;tt++)at=(I-tt)/(I-z),at<0?at=0:at>1&&(at=1),m[dt++]=N-(N-Y)*at|0,m[dt++]=R-(R-J)*at|0,m[dt++]=q-(q-it)*at|0,m[dt++]=255}}function y(M,c,F){const V=c.coords,U=c.colors;let P,r;switch(c.type){case"lattice":const i=c.verticesPerRow,f=Math.floor(V.length/i)-1,x=i-1;for(P=0;P<f;P++){let m=P*i;for(let D=0;D<x;D++,m++)b(M,F,V[m],V[m+1],V[m+i],U[m],U[m+1],U[m+i]),b(M,F,V[m+i+1],V[m+1],V[m+i],U[m+i+1],U[m+1],U[m+i])}break;case"triangles":for(P=0,r=V.length;P<r;P+=3)b(M,F,V[P],V[P+1],V[P+2],U[P],U[P+1],U[P+2]);break;default:throw new Error("illegal figure")}}class u extends S{constructor(c){super(),this._coords=c[2],this._colors=c[3],this._figures=c[4],this._bounds=c[5],this._bbox=c[7],this._background=c[8],this.matrix=null}_createMeshCanvas(c,F,V){const i=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),x=Math.ceil(this._bounds[2])-i,m=Math.ceil(this._bounds[3])-f,D=Math.min(Math.ceil(Math.abs(x*c[0]*1.1)),3e3),L=Math.min(Math.ceil(Math.abs(m*c[1]*1.1)),3e3),Z=x/D,$=m/L,E={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-f,scaleX:1/Z,scaleY:1/$},O=D+2*2,G=L+2*2,H=V.getCanvas("mesh",O,G,!1),B=H.context,K=B.createImageData(D,L);if(F){const o=K.data;for(let t=0,s=o.length;t<s;t+=4)o[t]=F[0],o[t+1]=F[1],o[t+2]=F[2],o[t+3]=255}for(const o of this._figures)y(K,o,E);return B.putImageData(K,2,2),{canvas:H.canvas,offsetX:i-2*Z,offsetY:f-2*$,scaleX:Z,scaleY:$}}getPattern(c,F,V,U=!1){p(c,this._bbox);let P;if(U)P=e.Util.singularValueDecompose2dScale(c.mozCurrentTransform);else if(P=e.Util.singularValueDecompose2dScale(F.baseTransform),this.matrix){const i=e.Util.singularValueDecompose2dScale(this.matrix);P=[P[0]*i[0],P[1]*i[1]]}const r=this._createMeshCanvas(P,U?null:this._background,F.cachedCanvases);return U||(c.setTransform.apply(c,F.baseTransform),this.matrix&&c.transform.apply(c,this.matrix)),c.translate(r.offsetX,r.offsetY),c.scale(r.scaleX,r.scaleY),c.createPattern(r.canvas,"no-repeat")}}class g extends S{getPattern(){return"hotpink"}}function v(M,c){switch(M[0]){case"RadialAxial":return new T(M,c);case"Mesh":return new u(M);case"Dummy":return new g}throw new Error(`Unknown IR type: ${M[0]}`)}const k={COLORED:1,UNCOLORED:2};class _{static get MAX_PATTERN_SIZE(){return(0,e.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(c,F,V,U,P){this.operatorList=c[2],this.matrix=c[3]||[1,0,0,1,0,0],this.bbox=c[4],this.xstep=c[5],this.ystep=c[6],this.paintType=c[7],this.tilingType=c[8],this.color=F,this.ctx=V,this.canvasGraphicsFactory=U,this.baseTransform=P}createPatternCanvas(c){const F=this.operatorList,V=this.bbox,U=this.xstep,P=this.ystep,r=this.paintType,i=this.tilingType,f=this.color,x=this.canvasGraphicsFactory;(0,e.info)("TilingType: "+i);const m=V[0],D=V[1],L=V[2],Z=V[3],$=e.Util.singularValueDecompose2dScale(this.matrix),E=e.Util.singularValueDecompose2dScale(this.baseTransform),O=[$[0]*E[0],$[1]*E[1]],G=this.getSizeAndScale(U,this.ctx.canvas.width,O[0]),H=this.getSizeAndScale(P,this.ctx.canvas.height,O[1]),B=c.cachedCanvases.getCanvas("pattern",G.size,H.size,!0),K=B.context,w=x.createCanvasGraphics(K);w.groupLevel=c.groupLevel,this.setFillAndStrokeStyleToContext(w,r,f);let o=m,t=D,s=L,n=Z;return m<0&&(o=0,s+=Math.abs(m)),D<0&&(t=0,n+=Math.abs(D)),K.translate(-(G.scale*o),-(H.scale*t)),w.transform(G.scale,0,0,H.scale,0,0),this.clipBbox(w,o,t,s,n),w.baseTransform=w.ctx.mozCurrentTransform.slice(),w.executeOperatorList(F),w.endDrawing(),{canvas:B.canvas,scaleX:G.scale,scaleY:H.scale,offsetX:o,offsetY:t}}getSizeAndScale(c,F,V){c=Math.abs(c);const U=Math.max(_.MAX_PATTERN_SIZE,F);let P=Math.ceil(c*V);return P>=U?P=U:V=P/c,{scale:V,size:P}}clipBbox(c,F,V,U,P){const r=U-F,i=P-V;c.ctx.rect(F,V,r,i),c.clip(),c.endPath()}setFillAndStrokeStyleToContext(c,F,V){const U=c.ctx,P=c.current;switch(F){case k.COLORED:const r=this.ctx;U.fillStyle=r.fillStyle,U.strokeStyle=r.strokeStyle,P.fillColor=r.fillStyle,P.strokeColor=r.strokeStyle;break;case k.UNCOLORED:const i=e.Util.makeHexColor(V[0],V[1],V[2]);U.fillStyle=i,U.strokeStyle=i,P.fillColor=i,P.strokeColor=i;break;default:throw new e.FormatError(`Unsupported paint type: ${F}`)}}getPattern(c,F,V,U=!1){let P=V;U||(P=e.Util.transform(P,F.baseTransform),this.matrix&&(P=e.Util.transform(P,this.matrix)));const r=this.createPatternCanvas(F);let i=new DOMMatrix(P);i=i.translate(r.offsetX,r.offsetY),i=i.scale(1/r.scaleX,1/r.scaleY);const f=c.createPattern(r.canvas,"repeat");try{f.setTransform(i)}catch(x){(0,e.warn)(`TilingPattern.getPattern: "${x==null?void 0:x.message}".`)}return f}}h.TilingPattern=_},(Q,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.GlobalWorkerOptions=void 0;const d=Object.create(null);h.GlobalWorkerOptions=d,d.workerPort=d.workerPort===void 0?null:d.workerPort,d.workerSrc=d.workerSrc===void 0?"":d.workerSrc},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.MessageHandler=void 0;var e=d(2);const p={UNKNOWN:0,DATA:1,ERROR:2},S={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function T(y){if(!(y instanceof Error||typeof y=="object"&&y!==null))return(0,e.warn)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),y;switch(y.name){case"AbortException":return new e.AbortException(y.message);case"MissingPDFException":return new e.MissingPDFException(y.message);case"PasswordException":return new e.PasswordException(y.message,y.code);case"UnexpectedResponseException":return new e.UnexpectedResponseException(y.message,y.status);case"UnknownErrorException":return new e.UnknownErrorException(y.message,y.details);default:return new e.UnknownErrorException(y.message,y.toString())}}class b{constructor(u,g,v){this.sourceName=u,this.targetName=g,this.comObj=v,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=k=>{const _=k.data;if(_.targetName!==this.sourceName)return;if(_.stream){this._processStreamMessage(_);return}if(_.callback){const c=_.callbackId,F=this.callbackCapabilities[c];if(!F)throw new Error(`Cannot resolve callback ${c}`);if(delete this.callbackCapabilities[c],_.callback===p.DATA)F.resolve(_.data);else if(_.callback===p.ERROR)F.reject(T(_.reason));else throw new Error("Unexpected callback case");return}const M=this.actionHandler[_.action];if(!M)throw new Error(`Unknown action from worker: ${_.action}`);if(_.callbackId){const c=this.sourceName,F=_.sourceName;new Promise(function(V){V(M(_.data))}).then(function(V){v.postMessage({sourceName:c,targetName:F,callback:p.DATA,callbackId:_.callbackId,data:V})},function(V){v.postMessage({sourceName:c,targetName:F,callback:p.ERROR,callbackId:_.callbackId,reason:T(V)})});return}if(_.streamId){this._createStreamSink(_);return}M(_.data)},v.addEventListener("message",this._onComObjOnMessage)}on(u,g){const v=this.actionHandler;if(v[u])throw new Error(`There is already an actionName called "${u}"`);v[u]=g}send(u,g,v){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:u,data:g},v)}sendWithPromise(u,g,v){const k=this.callbackId++,_=(0,e.createPromiseCapability)();this.callbackCapabilities[k]=_;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:u,callbackId:k,data:g},v)}catch(M){_.reject(M)}return _.promise}sendWithStream(u,g,v,k){const _=this.streamId++,M=this.sourceName,c=this.targetName,F=this.comObj;return new ReadableStream({start:V=>{const U=(0,e.createPromiseCapability)();return this.streamControllers[_]={controller:V,startCall:U,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:M,targetName:c,action:u,streamId:_,data:g,desiredSize:V.desiredSize},k),U.promise},pull:V=>{const U=(0,e.createPromiseCapability)();return this.streamControllers[_].pullCall=U,F.postMessage({sourceName:M,targetName:c,stream:S.PULL,streamId:_,desiredSize:V.desiredSize}),U.promise},cancel:V=>{(0,e.assert)(V instanceof Error,"cancel must have a valid reason");const U=(0,e.createPromiseCapability)();return this.streamControllers[_].cancelCall=U,this.streamControllers[_].isClosed=!0,F.postMessage({sourceName:M,targetName:c,stream:S.CANCEL,streamId:_,reason:T(V)}),U.promise}},v)}_createStreamSink(u){const g=u.streamId,v=this.sourceName,k=u.sourceName,_=this.comObj,M=this,c=this.actionHandler[u.action],F={enqueue(V,U=1,P){if(this.isCancelled)return;const r=this.desiredSize;this.desiredSize-=U,r>0&&this.desiredSize<=0&&(this.sinkCapability=(0,e.createPromiseCapability)(),this.ready=this.sinkCapability.promise),M._postMessage({sourceName:v,targetName:k,stream:S.ENQUEUE,streamId:g,chunk:V},P)},close(){this.isCancelled||(this.isCancelled=!0,_.postMessage({sourceName:v,targetName:k,stream:S.CLOSE,streamId:g}),delete M.streamSinks[g])},error(V){(0,e.assert)(V instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,_.postMessage({sourceName:v,targetName:k,stream:S.ERROR,streamId:g,reason:T(V)}))},sinkCapability:(0,e.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:u.desiredSize,ready:null};F.sinkCapability.resolve(),F.ready=F.sinkCapability.promise,this.streamSinks[g]=F,new Promise(function(V){V(c(u.data,F))}).then(function(){_.postMessage({sourceName:v,targetName:k,stream:S.START_COMPLETE,streamId:g,success:!0})},function(V){_.postMessage({sourceName:v,targetName:k,stream:S.START_COMPLETE,streamId:g,reason:T(V)})})}_processStreamMessage(u){const g=u.streamId,v=this.sourceName,k=u.sourceName,_=this.comObj,M=this.streamControllers[g],c=this.streamSinks[g];switch(u.stream){case S.START_COMPLETE:u.success?M.startCall.resolve():M.startCall.reject(T(u.reason));break;case S.PULL_COMPLETE:u.success?M.pullCall.resolve():M.pullCall.reject(T(u.reason));break;case S.PULL:if(!c){_.postMessage({sourceName:v,targetName:k,stream:S.PULL_COMPLETE,streamId:g,success:!0});break}c.desiredSize<=0&&u.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=u.desiredSize,new Promise(function(F){F(c.onPull&&c.onPull())}).then(function(){_.postMessage({sourceName:v,targetName:k,stream:S.PULL_COMPLETE,streamId:g,success:!0})},function(F){_.postMessage({sourceName:v,targetName:k,stream:S.PULL_COMPLETE,streamId:g,reason:T(F)})});break;case S.ENQUEUE:if((0,e.assert)(M,"enqueue should have stream controller"),M.isClosed)break;M.controller.enqueue(u.chunk);break;case S.CLOSE:if((0,e.assert)(M,"close should have stream controller"),M.isClosed)break;M.isClosed=!0,M.controller.close(),this._deleteStreamController(M,g);break;case S.ERROR:(0,e.assert)(M,"error should have stream controller"),M.controller.error(T(u.reason)),this._deleteStreamController(M,g);break;case S.CANCEL_COMPLETE:u.success?M.cancelCall.resolve():M.cancelCall.reject(T(u.reason)),this._deleteStreamController(M,g);break;case S.CANCEL:if(!c)break;new Promise(function(F){F(c.onCancel&&c.onCancel(T(u.reason)))}).then(function(){_.postMessage({sourceName:v,targetName:k,stream:S.CANCEL_COMPLETE,streamId:g,success:!0})},function(F){_.postMessage({sourceName:v,targetName:k,stream:S.CANCEL_COMPLETE,streamId:g,reason:T(F)})}),c.sinkCapability.reject(T(u.reason)),c.isCancelled=!0,delete this.streamSinks[g];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(u,g){await Promise.allSettled([u.startCall&&u.startCall.promise,u.pullCall&&u.pullCall.promise,u.cancelCall&&u.cancelCall.promise]),delete this.streamControllers[g]}_postMessage(u,g){g&&this.postMessageTransfers?this.comObj.postMessage(u,g):this.comObj.postMessage(u)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}h.MessageHandler=b},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.Metadata=void 0;var e=d(2);class p{constructor({parsedData:T,rawData:b}){this._metadataMap=T,this._data=b}getRaw(){return this._data}get(T){return this._metadataMap.get(T)??null}getAll(){return(0,e.objectFromMap)(this._metadataMap)}has(T){return this._metadataMap.has(T)}}h.Metadata=p},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.OptionalContentConfig=void 0;var e=d(2);class p{constructor(b,y){this.visible=!0,this.name=b,this.intent=y}}class S{constructor(b){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,b!==null){this.name=b.name,this.creator=b.creator,this._order=b.order;for(const y of b.groups)this._groups.set(y.id,new p(y.name,y.intent));if(b.baseState==="OFF")for(const y of this._groups)y.visible=!1;for(const y of b.on)this._groups.get(y).visible=!0;for(const y of b.off)this._groups.get(y).visible=!1}}_evaluateVisibilityExpression(b){const y=b.length;if(y<2)return!0;const u=b[0];for(let g=1;g<y;g++){const v=b[g];let k;if(Array.isArray(v))k=this._evaluateVisibilityExpression(v);else if(this._groups.has(v))k=this._groups.get(v).visible;else return(0,e.warn)(`Optional content group not found: ${v}`),!0;switch(u){case"And":if(!k)return!1;break;case"Or":if(k)return!0;break;case"Not":return!k;default:return!0}}return u==="And"}isVisible(b){if(this._groups.size===0)return!0;if(!b)return(0,e.warn)("Optional content group not defined."),!0;if(b.type==="OCG")return this._groups.has(b.id)?this._groups.get(b.id).visible:((0,e.warn)(`Optional content group not found: ${b.id}`),!0);if(b.type==="OCMD"){if(b.expression)return this._evaluateVisibilityExpression(b.expression);if(!b.policy||b.policy==="AnyOn"){for(const y of b.ids){if(!this._groups.has(y))return(0,e.warn)(`Optional content group not found: ${y}`),!0;if(this._groups.get(y).visible)return!0}return!1}else if(b.policy==="AllOn"){for(const y of b.ids){if(!this._groups.has(y))return(0,e.warn)(`Optional content group not found: ${y}`),!0;if(!this._groups.get(y).visible)return!1}return!0}else if(b.policy==="AnyOff"){for(const y of b.ids){if(!this._groups.has(y))return(0,e.warn)(`Optional content group not found: ${y}`),!0;if(!this._groups.get(y).visible)return!0}return!1}else if(b.policy==="AllOff"){for(const y of b.ids){if(!this._groups.has(y))return(0,e.warn)(`Optional content group not found: ${y}`),!0;if(this._groups.get(y).visible)return!1}return!0}return(0,e.warn)(`Unknown optional content policy ${b.policy}.`),!0}return(0,e.warn)(`Unknown group type ${b.type}.`),!0}setVisibility(b,y=!0){if(!this._groups.has(b)){(0,e.warn)(`Optional content group not found: ${b}`);return}this._groups.get(b).visible=!!y}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,e.objectFromMap)(this._groups):null}getGroup(b){return this._groups.get(b)||null}}h.OptionalContentConfig=S},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFDataTransportStream=void 0;var e=d(2),p=d(1);class S{constructor(u,g){(0,e.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=u.progressiveDone||!1,this._contentDispositionFilename=u.contentDispositionFilename||null;const v=u.initialData;if((v==null?void 0:v.length)>0){const k=new Uint8Array(v).buffer;this._queuedChunks.push(k)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!u.disableStream,this._isRangeSupported=!u.disableRange,this._contentLength=u.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((k,_)=>{this._onReceiveData({begin:k,chunk:_})}),this._pdfDataRangeTransport.addProgressListener((k,_)=>{this._onProgress({loaded:k,total:_})}),this._pdfDataRangeTransport.addProgressiveReadListener(k=>{this._onReceiveData({chunk:k})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(u){const g=new Uint8Array(u.chunk).buffer;if(u.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(g):this._queuedChunks.push(g);else{const v=this._rangeReaders.some(function(k){return k._begin!==u.begin?!1:(k._enqueue(g),!0)});(0,e.assert)(v,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var u;return((u=this._fullRequestReader)==null?void 0:u._loaded)??0}_onProgress(u){if(u.total===void 0){const g=this._rangeReaders[0];g!=null&&g.onProgress&&g.onProgress({loaded:u.loaded})}else{const g=this._fullRequestReader;g!=null&&g.onProgress&&g.onProgress({loaded:u.loaded,total:u.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(u){const g=this._rangeReaders.indexOf(u);g>=0&&this._rangeReaders.splice(g,1)}getFullReader(){(0,e.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const u=this._queuedChunks;return this._queuedChunks=null,new T(this,u,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(u,g){if(g<=this._progressiveDataLength)return null;const v=new b(this,u,g);return this._pdfDataRangeTransport.requestDataRange(u,g),this._rangeReaders.push(v),v}cancelAllRequests(u){this._fullRequestReader&&this._fullRequestReader.cancel(u);for(const g of this._rangeReaders.slice(0))g.cancel(u);this._pdfDataRangeTransport.abort()}}h.PDFDataTransportStream=S;class T{constructor(u,g,v=!1,k=null){this._stream=u,this._done=v||!1,this._filename=(0,p.isPdfFile)(k)?k:null,this._queuedChunks=g||[],this._loaded=0;for(const _ of this._queuedChunks)this._loaded+=_.byteLength;this._requests=[],this._headersReady=Promise.resolve(),u._fullRequestReader=this,this.onProgress=null}_enqueue(u){this._done||(this._requests.length>0?this._requests.shift().resolve({value:u,done:!1}):this._queuedChunks.push(u),this._loaded+=u.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const u=(0,e.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class b{constructor(u,g,v){this._stream=u,this._begin=g,this._end=v,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(u){if(!this._done){if(this._requests.length===0)this._queuedChunk=u;else{this._requests.shift().resolve({value:u,done:!1});for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const u=(0,e.createPromiseCapability)();return this._requests.push(u),u.promise}cancel(u){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Q,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.XfaText=void 0;class d{static textContent(p){const S=[],T={items:S,styles:Object.create(null)};function b(y){var v;if(!y)return;let u=null;const g=y.name;if(g==="#text")u=y.value;else if(d.shouldBuildText(g))(v=y==null?void 0:y.attributes)!=null&&v.textContent?u=y.attributes.textContent:y.value&&(u=y.value);else return;if(u!==null&&S.push({str:u}),!!y.children)for(const k of y.children)b(k)}return b(p),T}static shouldBuildText(p){return!(p==="textarea"||p==="input"||p==="option"||p==="select")}}h.XfaText=d},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.AnnotationLayer=void 0;var e=d(2),p=d(1),S=d(9),T=d(19);const b=1e3,y=new WeakSet;class u{static create(t){switch(t.data.annotationType){case e.AnnotationType.LINK:return new v(t);case e.AnnotationType.TEXT:return new k(t);case e.AnnotationType.WIDGET:switch(t.data.fieldType){case"Tx":return new M(t);case"Btn":return t.data.radioButton?new F(t):t.data.checkBox?new c(t):new V(t);case"Ch":return new U(t)}return new _(t);case e.AnnotationType.POPUP:return new P(t);case e.AnnotationType.FREETEXT:return new i(t);case e.AnnotationType.LINE:return new f(t);case e.AnnotationType.SQUARE:return new x(t);case e.AnnotationType.CIRCLE:return new m(t);case e.AnnotationType.POLYLINE:return new D(t);case e.AnnotationType.CARET:return new Z(t);case e.AnnotationType.INK:return new $(t);case e.AnnotationType.POLYGON:return new L(t);case e.AnnotationType.HIGHLIGHT:return new E(t);case e.AnnotationType.UNDERLINE:return new O(t);case e.AnnotationType.SQUIGGLY:return new G(t);case e.AnnotationType.STRIKEOUT:return new H(t);case e.AnnotationType.STAMP:return new B(t);case e.AnnotationType.FILEATTACHMENT:return new K(t);default:return new g(t)}}}class g{constructor(t,{isRenderable:s=!1,ignoreBorder:n=!1,createQuadrilaterals:l=!1}={}){this.isRenderable=s,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this._mouseState=t.mouseState,s&&(this.container=this._createContainer(n)),l&&(this.quadrilaterals=this._createQuadrilaterals(n))}_createContainer(t=!1){const s=this.data,n=this.page,l=this.viewport,a=document.createElement("section");let A=s.rect[2]-s.rect[0],C=s.rect[3]-s.rect[1];a.setAttribute("data-annotation-id",s.id);const I=e.Util.normalizeRect([s.rect[0],n.view[3]-s.rect[1]+n.view[1],s.rect[2],n.view[3]-s.rect[3]+n.view[1]]);if(a.style.transform=`matrix(${l.transform.join(",")})`,a.style.transformOrigin=`${-I[0]}px ${-I[1]}px`,!t&&s.borderStyle.width>0){a.style.borderWidth=`${s.borderStyle.width}px`,s.borderStyle.style!==e.AnnotationBorderStyleType.UNDERLINE&&(A-=2*s.borderStyle.width,C-=2*s.borderStyle.width);const N=s.borderStyle.horizontalCornerRadius,R=s.borderStyle.verticalCornerRadius;if(N>0||R>0){const z=`${N}px / ${R}px`;a.style.borderRadius=z}switch(s.borderStyle.style){case e.AnnotationBorderStyleType.SOLID:a.style.borderStyle="solid";break;case e.AnnotationBorderStyleType.DASHED:a.style.borderStyle="dashed";break;case e.AnnotationBorderStyleType.BEVELED:(0,e.warn)("Unimplemented border style: beveled");break;case e.AnnotationBorderStyleType.INSET:(0,e.warn)("Unimplemented border style: inset");break;case e.AnnotationBorderStyleType.UNDERLINE:a.style.borderBottomStyle="solid";break}s.borderColor||s.color||null?a.style.borderColor=e.Util.makeHexColor(s.color[0]|0,s.color[1]|0,s.color[2]|0):a.style.borderWidth=0}return a.style.left=`${I[0]}px`,a.style.top=`${I[1]}px`,a.style.width=`${A}px`,a.style.height=`${C}px`,a}_createQuadrilaterals(t=!1){if(!this.data.quadPoints)return null;const s=[],n=this.data.rect;for(const l of this.data.quadPoints)this.data.rect=[l[2].x,l[2].y,l[1].x,l[1].y],s.push(this._createContainer(t));return this.data.rect=n,s}_createPopup(t,s){let n=this.container;this.quadrilaterals&&(t=t||this.quadrilaterals,n=this.quadrilaterals[0]),t||(t=document.createElement("div"),t.style.height=n.style.height,t.style.width=n.style.width,n.appendChild(t));const a=new r({container:n,trigger:t,color:s.color,titleObj:s.titleObj,modificationDate:s.modificationDate,contentsObj:s.contentsObj,hideWrapper:!0}).render();a.style.left=n.style.width,n.appendChild(a)}_renderQuadrilaterals(t){for(const s of this.quadrilaterals)s.className=t;return this.quadrilaterals}render(){(0,e.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,s=null){const n=[];if(this._fieldObjects){const l=this._fieldObjects[t];if(l)for(const{page:a,id:A,exportValues:C}of l){if(a===-1||A===s)continue;const I=typeof C=="string"?C:null,N=document.getElementById(A);if(N&&!y.has(N)){(0,e.warn)(`_getElementsByName - element not allowed: ${A}`);continue}n.push({id:A,exportValue:I,domElement:N})}return n}for(const l of document.getElementsByName(t)){const{id:a,exportValue:A}=l;a!==s&&y.has(l)&&n.push({id:a,exportValue:A,domElement:l})}return n}static get platform(){const t=typeof navigator<"u"?navigator.platform:"";return(0,e.shadow)(this,"platform",{isWin:t.includes("Win"),isMac:t.includes("Mac")})}}class v extends g{constructor(t){const s=!!(t.data.url||t.data.dest||t.data.action||t.data.isTooltipOnly||t.data.resetForm||t.data.actions&&(t.data.actions.Action||t.data.actions["Mouse Up"]||t.data.actions["Mouse Down"]));super(t,{isRenderable:s,createQuadrilaterals:!0})}render(){var l;const{data:t,linkService:s}=this,n=document.createElement("a");if(t.url)s.addLinkAttributes||(0,e.warn)("LinkAnnotationElement.render - missing `addLinkAttributes`-method on the `linkService`-instance."),(l=s.addLinkAttributes)==null||l.call(s,n,t.url,t.newWindow);else if(t.action)this._bindNamedAction(n,t.action);else if(t.dest)this._bindLink(n,t.dest);else{let a=!1;t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(a=!0,this._bindJSAction(n,t)),t.resetForm?this._bindResetFormAction(n,t.resetForm):a||this._bindLink(n,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((a,A)=>{const C=A===0?n:n.cloneNode();return a.appendChild(C),a}):(this.container.className="linkAnnotation",this.container.appendChild(n),this.container)}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&(t.className="internalLink")}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),t.className="internalLink"}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const l of Object.keys(s.actions)){const a=n.get(l);a&&(t[a]=()=>{var A;return(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:l}}),!1})}t.onclick||(t.onclick=()=>!1),t.className="internalLink"}_bindResetFormAction(t,s){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),t.className="internalLink",!this._fieldObjects){(0,e.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{var R;n&&n();const{fields:l,refs:a,include:A}=s,C=[];if(l.length!==0||a.length!==0){const q=new Set(a);for(const z of l){const Y=this._fieldObjects[z]||[];for(const{id:J}of Y)q.add(J)}for(const z of Object.values(this._fieldObjects))for(const Y of z)q.has(Y.id)===A&&C.push(Y)}else for(const q of Object.values(this._fieldObjects))C.push(...q);const I=this.annotationStorage,N=[];for(const q of C){const{id:z}=q;switch(N.push(z),q.type){case"text":{const J=q.defaultValue||"";I.setValue(z,{value:J,valueAsString:J});break}case"checkbox":case"radiobutton":{const J=q.defaultValue===q.exportValues;I.setValue(z,{value:J});break}case"combobox":case"listbox":{const J=q.defaultValue||"";I.setValue(z,{value:J});break}default:continue}const Y=document.getElementById(z);!Y||!y.has(Y)||Y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((R=this.linkService.eventBus)==null||R.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:N,name:"ResetForm"}})),!1}}}class k extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s})}render(){this.container.className="textAnnotation";const t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(t,this.data),this.container.appendChild(t),this.container}}class _ extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(t){const{isWin:s,isMac:n}=g.platform;return s&&t.ctrlKey||n&&t.metaKey}_setEventListener(t,s,n,l){s.includes("mouse")?t.addEventListener(s,a=>{var A;(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:l(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(s,a=>{var A;(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:a.target.checked}})})}_setEventListeners(t,s,n){var l;for(const[a,A]of s)(A==="Action"||(l=this.data.actions)!=null&&l[A])&&this._setEventListener(t,a,A,n)}_setBackgroundColor(t){const s=this.data.backgroundColor||null;t.style.backgroundColor=s===null?"transparent":e.Util.makeHexColor(s[0],s[1],s[2])}_dispatchEventFromSandbox(t,s){const n=(a,A,C)=>{const I=C.detail[a];C.target.style[A]=T.ColorConverters[`${I[0]}_HTML`](I.slice(1))},l={display:a=>{const A=a.detail.display%2===1;a.target.style.visibility=A?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:A,print:a.detail.display===0||a.detail.display===3})},print:a=>{this.annotationStorage.setValue(this.data.id,{print:a.detail.print})},hidden:a=>{a.target.style.visibility=a.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:a.detail.hidden})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.detail.readonly?a.target.setAttribute("readonly",""):a.target.removeAttribute("readonly")},required:a=>{a.detail.required?a.target.setAttribute("required",""):a.target.removeAttribute("required")},bgColor:a=>{n("bgColor","backgroundColor",a)},fillColor:a=>{n("fillColor","backgroundColor",a)},fgColor:a=>{n("fgColor","color",a)},textColor:a=>{n("textColor","color",a)},borderColor:a=>{n("borderColor","borderColor",a)},strokeColor:a=>{n("strokeColor","borderColor",a)}};for(const a of Object.keys(s.detail)){const A=t[a]||l[a];A&&A(s)}}}class M extends _{constructor(t){const s=t.renderForms||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:s})}setPropertyOnSiblings(t,s,n,l){const a=this.annotationStorage;for(const A of this._getElementsByName(t.name,t.id))A.domElement&&(A.domElement[s]=n),a.setValue(A.id,{[l]:n})}render(){var l;const t=this.annotationStorage,s=this.data.id;this.container.className="textWidgetAnnotation";let n=null;if(this.renderForms){const a=t.getValue(s,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),A=a.valueAsString||a.value||"",C={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=A):(n=document.createElement("input"),n.type="text",n.setAttribute("value",A)),y.add(n),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=b,C.userValue=A,n.setAttribute("id",s),n.addEventListener("input",N=>{t.setValue(s,{value:N.target.value}),this.setPropertyOnSiblings(n,"value",N.target.value,"value")}),n.addEventListener("resetform",N=>{const R=this.data.defaultFieldValue||"";n.value=C.userValue=R,delete C.formattedValue});let I=N=>{C.formattedValue&&(N.target.value=C.formattedValue),N.target.scrollLeft=0,C.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",R=>{C.userValue&&(R.target.value=C.userValue)}),n.addEventListener("updatefromsandbox",R=>{const q={value(z){C.userValue=z.detail.value||"",t.setValue(s,{value:C.userValue.toString()}),C.formattedValue||(z.target.value=C.userValue)},valueAsString(z){C.formattedValue=z.detail.valueAsString||"",z.target!==document.activeElement&&(z.target.value=C.formattedValue),t.setValue(s,{formattedValue:C.formattedValue})},selRange(z){const[Y,J]=z.detail.selRange;Y>=0&&J<z.target.value.length&&z.target.setSelectionRange(Y,J)}};this._dispatchEventFromSandbox(q,R)}),n.addEventListener("keydown",R=>{var z;C.beforeInputValue=R.target.value;let q=-1;R.key==="Escape"?q=0:R.key==="Enter"?q=2:R.key==="Tab"&&(q=3),q!==-1&&(C.userValue=R.target.value,(z=this.linkService.eventBus)==null||z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:R.target.value,willCommit:!0,commitKey:q,selStart:R.target.selectionStart,selEnd:R.target.selectionEnd}}))});const N=I;I=null,n.addEventListener("blur",R=>{var q;this._mouseState.isDown&&(C.userValue=R.target.value,(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:R.target.value,willCommit:!0,commitKey:1,selStart:R.target.selectionStart,selEnd:R.target.selectionEnd}})),N(R)}),n.addEventListener("mousedown",R=>{C.beforeInputValue=R.target.value,C.beforeInputSelectionRange=null}),n.addEventListener("keyup",R=>{R.target.selectionStart===R.target.selectionEnd&&(C.beforeInputSelectionRange=null)}),n.addEventListener("select",R=>{C.beforeInputSelectionRange=[R.target.selectionStart,R.target.selectionEnd]}),(l=this.data.actions)!=null&&l.Keystroke&&n.addEventListener("input",R=>{var Y;let q=-1,z=-1;C.beforeInputSelectionRange&&([q,z]=C.beforeInputSelectionRange),(Y=this.linkService.eventBus)==null||Y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:C.beforeInputValue,change:R.data,willCommit:!1,selStart:q,selEnd:z}})}),this._setEventListeners(n,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],R=>R.target.value)}if(I&&n.addEventListener("blur",I),this.data.maxLen!==null&&(n.maxLength=this.data.maxLen),this.data.comb){const R=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;n.classList.add("comb"),n.style.letterSpacing=`calc(${R}px - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";return this._setTextStyle(n),this._setBackgroundColor(n),this.container.appendChild(n),this.container}_setTextStyle(t){const s=["left","center","right"],{fontSize:n,fontColor:l}=this.data.defaultAppearanceData,a=t.style;n&&(a.fontSize=`${n}px`),a.color=e.Util.makeHexColor(l[0],l[1],l[2]),this.data.textAlignment!==null&&(a.textAlign=s[this.data.textAlignment])}}class c extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,s=this.data,n=s.id;let l=t.getValue(n,{value:s.exportValue===s.fieldValue}).value;typeof l=="string"&&(l=l!=="Off",t.setValue(n,{value:l})),this.container.className="buttonWidgetAnnotation checkBox";const a=document.createElement("input");return y.add(a),a.disabled=s.readOnly,a.type="checkbox",a.name=s.fieldName,l&&a.setAttribute("checked",!0),a.setAttribute("id",n),a.setAttribute("exportValue",s.exportValue),a.tabIndex=b,a.addEventListener("change",A=>{const{name:C,checked:I}=A.target;for(const N of this._getElementsByName(C,n)){const R=I&&N.exportValue===s.exportValue;N.domElement&&(N.domElement.checked=R),t.setValue(N.id,{value:R})}t.setValue(n,{value:I})}),a.addEventListener("resetform",A=>{const C=s.defaultFieldValue||"Off";A.target.checked=C===s.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",A=>{const C={value(I){I.target.checked=I.detail.value!=="Off",t.setValue(n,{value:I.target.checked})}};this._dispatchEventFromSandbox(C,A)}),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.checked)),this._setBackgroundColor(a),this.container.appendChild(a),this.container}}class F extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const t=this.annotationStorage,s=this.data,n=s.id;let l=t.getValue(n,{value:s.fieldValue===s.buttonValue}).value;typeof l=="string"&&(l=l!==s.buttonValue,t.setValue(n,{value:l}));const a=document.createElement("input");if(y.add(a),a.disabled=s.readOnly,a.type="radio",a.name=s.fieldName,l&&a.setAttribute("checked",!0),a.setAttribute("id",n),a.tabIndex=b,a.addEventListener("change",A=>{const{name:C,checked:I}=A.target;for(const N of this._getElementsByName(C,n))t.setValue(N.id,{value:!1});t.setValue(n,{value:I})}),a.addEventListener("resetform",A=>{const C=s.defaultFieldValue;A.target.checked=C!=null&&C===s.buttonValue}),this.enableScripting&&this.hasJSActions){const A=s.buttonValue;a.addEventListener("updatefromsandbox",C=>{const I={value:N=>{const R=A===N.detail.value;for(const q of this._getElementsByName(N.target.name)){const z=R&&q.id===n;q.domElement&&(q.domElement.checked=z),t.setValue(q.id,{value:z})}}};this._dispatchEventFromSandbox(I,C)}),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],C=>C.target.checked)}return this._setBackgroundColor(a),this.container.appendChild(a),this.container}}class V extends v{render(){const t=super.render();return t.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(t.title=this.data.alternativeText),t}}class U extends _{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const t=this.annotationStorage,s=this.data.id;t.getValue(s,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});let{fontSize:n}=this.data.defaultAppearanceData;n||(n=9);const l=`calc(${n}px * var(--zoom-factor))`,a=document.createElement("select");y.add(a),a.disabled=this.data.readOnly,a.name=this.data.fieldName,a.setAttribute("id",s),a.tabIndex=b,a.style.fontSize=`${n}px`,this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",I=>{const N=this.data.defaultFieldValue;for(const R of a.options)R.selected=R.value===N});for(const I of this.data.options){const N=document.createElement("option");N.textContent=I.displayValue,N.value=I.exportValue,this.data.combo&&(N.style.fontSize=l),this.data.fieldValue.includes(I.exportValue)&&N.setAttribute("selected",!0),a.appendChild(N)}const A=(I,N)=>{const R=N?"value":"textContent",q=I.target.options;return I.target.multiple?Array.prototype.filter.call(q,z=>z.selected).map(z=>z[R]):q.selectedIndex===-1?null:q[q.selectedIndex][R]},C=I=>{const N=I.target.options;return Array.prototype.map.call(N,R=>({displayValue:R.textContent,exportValue:R.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",I=>{const N={value(R){const q=R.detail.value,z=new Set(Array.isArray(q)?q:[q]);for(const Y of a.options)Y.selected=z.has(Y.value);t.setValue(s,{value:A(R,!0)})},multipleSelection(R){a.multiple=!0},remove(R){const q=a.options,z=R.detail.remove;q[z].selected=!1,a.remove(z),q.length>0&&Array.prototype.findIndex.call(q,J=>J.selected)===-1&&(q[0].selected=!0),t.setValue(s,{value:A(R,!0),items:C(R)})},clear(R){for(;a.length!==0;)a.remove(0);t.setValue(s,{value:null,items:[]})},insert(R){const{index:q,displayValue:z,exportValue:Y}=R.detail.insert,J=document.createElement("option");J.textContent=z,J.value=Y,a.insertBefore(J,a.children[q]),t.setValue(s,{value:A(R,!0),items:C(R)})},items(R){const{items:q}=R.detail;for(;a.length!==0;)a.remove(0);for(const z of q){const{displayValue:Y,exportValue:J}=z,it=document.createElement("option");it.textContent=Y,it.value=J,a.appendChild(it)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(s,{value:A(R,!0),items:C(R)})},indices(R){const q=new Set(R.detail.indices);for(const z of R.target.options)z.selected=q.has(z.index);t.setValue(s,{value:A(R,!0)})},editable(R){R.target.disabled=!R.detail.editable}};this._dispatchEventFromSandbox(N,I)}),a.addEventListener("input",I=>{var q;const N=A(I,!0),R=A(I,!1);t.setValue(s,{value:N}),(q=this.linkService.eventBus)==null||q.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:R,changeEx:N,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],I=>I.target.checked)):a.addEventListener("input",function(I){t.setValue(s,{value:A(I)})}),this._setBackgroundColor(a),this.container.appendChild(a),this.container}}class P extends g{constructor(t){var n,l;const s=!!((n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s})}render(){const t=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",t.includes(this.data.parentType))return this.container;const s=`[data-annotation-id="${this.data.parentId}"]`,n=this.layer.querySelectorAll(s);if(n.length===0)return this.container;const l=new r({container:this.container,trigger:Array.from(n),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj}),a=this.page,A=e.Util.normalizeRect([this.data.parentRect[0],a.view[3]-this.data.parentRect[1]+a.view[1],this.data.parentRect[2],a.view[3]-this.data.parentRect[3]+a.view[1]]),C=A[0]+this.data.parentRect[2]-this.data.parentRect[0],I=A[1];return this.container.style.transformOrigin=`${-C}px ${-I}px`,this.container.style.left=`${C}px`,this.container.style.top=`${I}px`,this.container.appendChild(l.render()),this.container}}class r{constructor(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.titleObj=t.titleObj,this.modificationDate=t.modificationDate,this.contentsObj=t.contentsObj,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}render(){const s=document.createElement("div");s.className="popupWrapper",this.hideElement=this.hideWrapper?s:this.container,this.hideElement.hidden=!0;const n=document.createElement("div");n.className="popup";const l=this.color;if(l){const I=.7*(255-l[0])+l[0],N=.7*(255-l[1])+l[1],R=.7*(255-l[2])+l[2];n.style.backgroundColor=e.Util.makeHexColor(I|0,N|0,R|0)}const a=document.createElement("h1");a.dir=this.titleObj.dir,a.textContent=this.titleObj.str,n.appendChild(a);const A=p.PDFDateString.toDateObject(this.modificationDate);if(A){const I=document.createElement("span");I.textContent="{{date}}, {{time}}",I.dataset.l10nId="annotation_date_string",I.dataset.l10nArgs=JSON.stringify({date:A.toLocaleDateString(),time:A.toLocaleTimeString()}),n.appendChild(I)}const C=this._formatContents(this.contentsObj);n.appendChild(C),Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const I of this.trigger)I.addEventListener("click",this._toggle.bind(this)),I.addEventListener("mouseover",this._show.bind(this,!1)),I.addEventListener("mouseout",this._hide.bind(this,!1));return n.addEventListener("click",this._hide.bind(this,!0)),s.appendChild(n),s}_formatContents({str:t,dir:s}){const n=document.createElement("p");n.dir=s;const l=t.split(/(?:\r\n?|\n)/);for(let a=0,A=l.length;a<A;++a){const C=l[a];n.appendChild(document.createTextNode(C)),a<A-1&&n.appendChild(document.createElement("br"))}return n}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(t=!1){t&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(t=!0){t&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class i extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class f extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const t=this.data,s=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1],l=this.svgFactory.create(s,n),a=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),l.appendChild(a),this.container.append(l),this._createPopup(a,t),this.container}}class x extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const t=this.data,s=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1],l=this.svgFactory.create(s,n),a=t.borderStyle.width,A=this.svgFactory.createElement("svg:rect");return A.setAttribute("x",a/2),A.setAttribute("y",a/2),A.setAttribute("width",s-a),A.setAttribute("height",n-a),A.setAttribute("stroke-width",a||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","none"),l.appendChild(A),this.container.append(l),this._createPopup(A,t),this.container}}class m extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const t=this.data,s=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1],l=this.svgFactory.create(s,n),a=t.borderStyle.width,A=this.svgFactory.createElement("svg:ellipse");return A.setAttribute("cx",s/2),A.setAttribute("cy",n/2),A.setAttribute("rx",s/2-a/2),A.setAttribute("ry",n/2-a/2),A.setAttribute("stroke-width",a||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","none"),l.appendChild(A),this.container.append(l),this._createPopup(A,t),this.container}}class D extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,s=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1],l=this.svgFactory.create(s,n);let a=[];for(const C of t.vertices){const I=C.x-t.rect[0],N=t.rect[3]-C.y;a.push(I+","+N)}a=a.join(" ");const A=this.svgFactory.createElement(this.svgElementName);return A.setAttribute("points",a),A.setAttribute("stroke-width",t.borderStyle.width||1),A.setAttribute("stroke","transparent"),A.setAttribute("fill","none"),l.appendChild(A),this.container.append(l),this._createPopup(A,t),this.container}}class L extends D{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Z extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class $ extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const t=this.data,s=t.rect[2]-t.rect[0],n=t.rect[3]-t.rect[1],l=this.svgFactory.create(s,n);for(const a of t.inkLists){let A=[];for(const I of a){const N=I.x-t.rect[0],R=t.rect[3]-I.y;A.push(`${N},${R}`)}A=A.join(" ");const C=this.svgFactory.createElement(this.svgElementName);C.setAttribute("points",A),C.setAttribute("stroke-width",t.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","none"),this._createPopup(C,t),l.appendChild(C)}return this.container.append(l),this.container}}class E extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class O extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class G extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class H extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class B extends g{constructor(t){var n,l;const s=!!(t.data.hasPopup||(n=t.data.titleObj)!=null&&n.str||(l=t.data.contentsObj)!=null&&l.str);super(t,{isRenderable:s,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class K extends g{constructor(t){var l;super(t,{isRenderable:!0});const{filename:s,content:n}=this.data.file;this.filename=(0,p.getFilenameFromUrl)(s),this.content=n,(l=this.linkService.eventBus)==null||l.dispatch("fileattachmentannotation",{source:this,id:(0,e.stringToPDFString)(s),filename:s,content:n})}render(){var s,n;this.container.className="fileAttachmentAnnotation";const t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((s=this.data.titleObj)!=null&&s.str||(n=this.data.contentsObj)!=null&&n.str)&&this._createPopup(t,this.data),this.container.appendChild(t),this.container}_download(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.container,this.content,this.filename)}}class w{static render(t){const s=[],n=[];for(const l of t.annotations)if(l){if(l.annotationType===e.AnnotationType.POPUP){n.push(l);continue}s.push(l)}n.length&&s.push(...n);for(const l of s){const a=u.create({data:l,layer:t.div,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new p.DOMSVGFactory,annotationStorage:t.annotationStorage||new S.AnnotationStorage,enableScripting:t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,mouseState:t.mouseState||{isDown:!1}});if(a.isRenderable){const A=a.render();if(l.hidden&&(A.style.visibility="hidden"),Array.isArray(A))for(const C of A)t.div.appendChild(C);else a instanceof P?t.div.prepend(A):t.div.appendChild(A)}}}static update(t){const s=`matrix(${t.viewport.transform.join(",")})`;for(const n of t.annotations){const l=t.div.querySelectorAll(`[data-annotation-id="${n.id}"]`);if(l)for(const a of l)a.style.transform=s}t.div.hidden=!1}}h.AnnotationLayer=w},(Q,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ColorConverters=void 0;function d(p){return Math.floor(Math.max(0,Math.min(1,p))*255).toString(16).padStart(2,"0")}class e{static CMYK_G([S,T,b,y]){return["G",1-Math.min(1,.3*S+.59*b+.11*T+y)]}static G_CMYK([S]){return["CMYK",0,0,0,1-S]}static G_RGB([S]){return["RGB",S,S,S]}static G_HTML([S]){const T=d(S);return`#${T}${T}${T}`}static RGB_G([S,T,b]){return["G",.3*S+.59*T+.11*b]}static RGB_HTML([S,T,b]){const y=d(S),u=d(T),g=d(b);return`#${y}${u}${g}`}static T_HTML(){return"#00000000"}static CMYK_RGB([S,T,b,y]){return["RGB",1-Math.min(1,S+y),1-Math.min(1,b+y),1-Math.min(1,T+y)]}static CMYK_HTML(S){return this.RGB_HTML(this.CMYK_RGB(S))}static RGB_CMYK([S,T,b]){const y=1-S,u=1-T,g=1-b,v=Math.min(y,u,g);return["CMYK",y,u,g,v]}}h.ColorConverters=e},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.renderTextLayer=V;var e=d(2);const p=1e5,S=30,T=.8,b=new Map,y=/^\s+$/g;function u(U,P){const r=b.get(U);if(r)return r;P.save(),P.font=`${S}px ${U}`;const i=P.measureText("");let f=i.fontBoundingBoxAscent,x=Math.abs(i.fontBoundingBoxDescent);if(f){P.restore();const D=f/(f+x);return b.set(U,D),D}P.strokeStyle="red",P.clearRect(0,0,S,S),P.strokeText("g",0,0);let m=P.getImageData(0,0,S,S).data;x=0;for(let D=m.length-1-3;D>=0;D-=4)if(m[D]>0){x=Math.ceil(D/4/S);break}P.clearRect(0,0,S,S),P.strokeText("A",0,S),m=P.getImageData(0,0,S,S).data,f=0;for(let D=0,L=m.length;D<L;D+=4)if(m[D]>0){f=S-Math.floor(D/4/S);break}if(P.restore(),f){const D=f/(f+x);return b.set(U,D),D}return b.set(U,T),T}function g(U,P,r,i){const f=document.createElement("span"),x=U._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:P.str!=="",hasEOL:P.hasEOL};U._textDivs.push(f);const m=e.Util.transform(U._viewport.transform,P.transform);let D=Math.atan2(m[1],m[0]);const L=r[P.fontName];L.vertical&&(D+=Math.PI/2);const Z=Math.hypot(m[2],m[3]),$=Z*u(L.fontFamily,i);let E,O;D===0?(E=m[4],O=m[5]-$):(E=m[4]+$*Math.sin(D),O=m[5]-$*Math.cos(D)),f.style.left=`${E}px`,f.style.top=`${O}px`,f.style.fontSize=`${Z}px`,f.style.fontFamily=L.fontFamily,f.setAttribute("role","presentation"),f.textContent=P.str,f.dir=P.dir,U._fontInspectorEnabled&&(f.dataset.fontName=P.fontName),D!==0&&(x.angle=D*(180/Math.PI));let G=!1;if(P.str.length>1||U._enhanceTextSelection&&y.test(P.str))G=!0;else if(P.transform[0]!==P.transform[3]){const H=Math.abs(P.transform[0]),B=Math.abs(P.transform[3]);H!==B&&Math.max(H,B)/Math.min(H,B)>1.5&&(G=!0)}if(G&&(L.vertical?x.canvasWidth=P.height*U._viewport.scale:x.canvasWidth=P.width*U._viewport.scale),U._textDivProperties.set(f,x),U._textContentStream&&U._layoutText(f),U._enhanceTextSelection&&x.hasText){let H=1,B=0;D!==0&&(H=Math.cos(D),B=Math.sin(D));const K=(L.vertical?P.height:P.width)*U._viewport.scale,w=Z;let o,t;D!==0?(o=[H,B,-B,H,E,O],t=e.Util.getAxialAlignedBoundingBox([0,0,K,w],o)):t=[E,O,E+K,O+w],U._bounds.push({left:t[0],top:t[1],right:t[2],bottom:t[3],div:f,size:[K,w],m:o})}}function v(U){if(U._canceled)return;const P=U._textDivs,r=U._capability,i=P.length;if(i>p){U._renderingDone=!0,r.resolve();return}if(!U._textContentStream)for(let f=0;f<i;f++)U._layoutText(P[f]);U._renderingDone=!0,r.resolve()}function k(U,P,r){let i=0;for(let f=0;f<r;f++){const x=U[P++];x>0&&(i=i?Math.min(x,i):x)}return i}function _(U){const P=U._bounds,r=U._viewport,i=M(r.width,r.height,P);for(let f=0;f<i.length;f++){const x=P[f].div,m=U._textDivProperties.get(x);if(m.angle===0){m.paddingLeft=P[f].left-i[f].left,m.paddingTop=P[f].top-i[f].top,m.paddingRight=i[f].right-P[f].right,m.paddingBottom=i[f].bottom-P[f].bottom,U._textDivProperties.set(x,m);continue}const D=i[f],L=P[f],Z=L.m,$=Z[0],E=Z[1],O=[[0,0],[0,L.size[1]],[L.size[0],0],L.size],G=new Float64Array(64);for(let B=0,K=O.length;B<K;B++){const w=e.Util.applyTransform(O[B],Z);G[B+0]=$&&(D.left-w[0])/$,G[B+4]=E&&(D.top-w[1])/E,G[B+8]=$&&(D.right-w[0])/$,G[B+12]=E&&(D.bottom-w[1])/E,G[B+16]=E&&(D.left-w[0])/-E,G[B+20]=$&&(D.top-w[1])/$,G[B+24]=E&&(D.right-w[0])/-E,G[B+28]=$&&(D.bottom-w[1])/$,G[B+32]=$&&(D.left-w[0])/-$,G[B+36]=E&&(D.top-w[1])/-E,G[B+40]=$&&(D.right-w[0])/-$,G[B+44]=E&&(D.bottom-w[1])/-E,G[B+48]=E&&(D.left-w[0])/E,G[B+52]=$&&(D.top-w[1])/-$,G[B+56]=E&&(D.right-w[0])/E,G[B+60]=$&&(D.bottom-w[1])/-$}const H=1+Math.min(Math.abs($),Math.abs(E));m.paddingLeft=k(G,32,16)/H,m.paddingTop=k(G,48,16)/H,m.paddingRight=k(G,0,16)/H,m.paddingBottom=k(G,16,16)/H,U._textDivProperties.set(x,m)}}function M(U,P,r){const i=r.map(function(x,m){return{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom,index:m,x1New:void 0,x2New:void 0}});c(U,i);const f=new Array(r.length);for(const x of i){const m=x.index;f[m]={left:x.x1New,top:0,right:x.x2New,bottom:0}}r.map(function(x,m){const D=f[m],L=i[m];L.x1=x.top,L.y1=U-D.right,L.x2=x.bottom,L.y2=U-D.left,L.index=m,L.x1New=void 0,L.x2New=void 0}),c(P,i);for(const x of i){const m=x.index;f[m].top=x.x1New,f[m].bottom=x.x2New}return f}function c(U,P){P.sort(function(f,x){return f.x1-x.x1||f.index-x.index});const i=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const f of P){let x=0;for(;x<i.length&&i[x].end<=f.y1;)x++;let m=i.length-1;for(;m>=0&&i[m].start>=f.y2;)m--;let D,L,Z,$,E=-1/0;for(Z=x;Z<=m;Z++){D=i[Z],L=D.boundary;let H;L.x2>f.x1?H=L.index>f.index?L.x1New:f.x1:L.x2New===void 0?H=(L.x2+f.x1)/2:H=L.x2New,H>E&&(E=H)}for(f.x1New=E,Z=x;Z<=m;Z++)D=i[Z],L=D.boundary,L.x2New===void 0?L.x2>f.x1?L.index>f.index&&(L.x2New=L.x2):L.x2New=E:L.x2New>E&&(L.x2New=Math.max(E,L.x2));const O=[];let G=null;for(Z=x;Z<=m;Z++){D=i[Z],L=D.boundary;const H=L.x2>f.x2?L:f;G===H?O[O.length-1].end=D.end:(O.push({start:D.start,end:D.end,boundary:H}),G=H)}for(i[x].start<f.y1&&(O[0].start=f.y1,O.unshift({start:i[x].start,end:f.y1,boundary:i[x].boundary})),f.y2<i[m].end&&(O[O.length-1].end=f.y2,O.push({start:f.y2,end:i[m].end,boundary:i[m].boundary})),Z=x;Z<=m;Z++){if(D=i[Z],L=D.boundary,L.x2New!==void 0)continue;let H=!1;for($=x-1;!H&&$>=0&&i[$].start>=L.y1;$--)H=i[$].boundary===L;for($=m+1;!H&&$<i.length&&i[$].end<=L.y2;$++)H=i[$].boundary===L;for($=0;!H&&$<O.length;$++)H=O[$].boundary===L;H||(L.x2New=E)}Array.prototype.splice.apply(i,[x,m-x+1].concat(O))}for(const f of i){const x=f.boundary;x.x2New===void 0&&(x.x2New=Math.max(U,x.x2))}}class F{constructor({textContent:P,textContentStream:r,container:i,viewport:f,textDivs:x,textContentItemsStr:m,enhanceTextSelection:D}){var L;this._textContent=P,this._textContentStream=r,this._container=i,this._document=i.ownerDocument,this._viewport=f,this._textDivs=x||[],this._textContentItemsStr=m||[],this._enhanceTextSelection=!!D,this._fontInspectorEnabled=!!((L=globalThis.FontInspector)!=null&&L.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,e.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new e.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(P,r){for(let i=0,f=P.length;i<f;i++){if(P[i].str===void 0){if(P[i].type==="beginMarkedContentProps"||P[i].type==="beginMarkedContent"){const x=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),P[i].id!==null&&this._container.setAttribute("id",`${P[i].id}`),x.appendChild(this._container)}else P[i].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(P[i].str),g(this,P[i],r,this._layoutTextCtx)}}_layoutText(P){const r=this._textDivProperties.get(P);let i="";if(r.canvasWidth!==0&&r.hasText){const{fontSize:f,fontFamily:x}=P.style;(f!==this._layoutTextLastFontSize||x!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${f} ${x}`,this._layoutTextLastFontSize=f,this._layoutTextLastFontFamily=x);const{width:m}=this._layoutTextCtx.measureText(P.textContent);if(m>0){const D=r.canvasWidth/m;this._enhanceTextSelection&&(r.scale=D),i=`scaleX(${D})`}}if(r.angle!==0&&(i=`rotate(${r.angle}deg) ${i}`),i.length>0&&(this._enhanceTextSelection&&(r.originalTransform=i),P.style.transform=i),r.hasText&&this._container.appendChild(P),r.hasEOL){const f=document.createElement("br");f.setAttribute("role","presentation"),this._container.appendChild(f)}}_render(P=0){const r=(0,e.createPromiseCapability)();let i=Object.create(null);const f=this._document.createElement("canvas");if(f.height=f.width=S,f.mozOpaque=!0,this._layoutTextCtx=f.getContext("2d",{alpha:!1}),this._textContent){const x=this._textContent.items,m=this._textContent.styles;this._processItems(x,m),r.resolve()}else if(this._textContentStream){const x=()=>{this._reader.read().then(({value:m,done:D})=>{if(D){r.resolve();return}Object.assign(i,m.styles),this._processItems(m.items,i),x()},r.reject)};this._reader=this._textContentStream.getReader(),x()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');r.promise.then(()=>{i=null,P?this._renderTimer=setTimeout(()=>{v(this),this._renderTimer=null},P):v(this)},this._capability.reject)}expandTextDivs(P=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(_(this),this._bounds=null);const r=[],i=[];for(let f=0,x=this._textDivs.length;f<x;f++){const m=this._textDivs[f],D=this._textDivProperties.get(m);D.hasText&&(P?(r.length=0,i.length=0,D.originalTransform&&r.push(D.originalTransform),D.paddingTop>0?(i.push(`${D.paddingTop}px`),r.push(`translateY(${-D.paddingTop}px)`)):i.push(0),D.paddingRight>0?i.push(`${D.paddingRight/D.scale}px`):i.push(0),D.paddingBottom>0?i.push(`${D.paddingBottom}px`):i.push(0),D.paddingLeft>0?(i.push(`${D.paddingLeft/D.scale}px`),r.push(`translateX(${-D.paddingLeft/D.scale}px)`)):i.push(0),m.style.padding=i.join(" "),r.length&&(m.style.transform=r.join(" "))):(m.style.padding=null,m.style.transform=D.originalTransform))}}}function V(U){const P=new F({textContent:U.textContent,textContentStream:U.textContentStream,container:U.container,viewport:U.viewport,textDivs:U.textDivs,textContentItemsStr:U.textContentItemsStr,enhanceTextSelection:U.enhanceTextSelection});return P._render(U.timeout),P}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.SVGGraphics=void 0;var e=d(2),p=d(1),S=d(4);let T=class{constructor(){(0,e.unreachable)("Not implemented: SVGGraphics")}};h.SVGGraphics=T;{let M=function(r){let i=[];const f=[];for(const x of r){if(x.fn==="save"){i.push({fnId:92,fn:"group",items:[]}),f.push(i),i=i[i.length-1].items;continue}x.fn==="restore"?i=f.pop():i.push(x)}return i},c=function(r){if(Number.isInteger(r))return r.toString();const i=r.toFixed(10);let f=i.length-1;if(i[f]!=="0")return i;do f--;while(i[f]==="0");return i.substring(0,i[f]==="."?f:f+1)},F=function(r){if(r[4]===0&&r[5]===0){if(r[1]===0&&r[2]===0)return r[0]===1&&r[3]===1?"":`scale(${c(r[0])} ${c(r[3])})`;if(r[0]===r[3]&&r[1]===-r[2]){const i=Math.acos(r[0])*180/Math.PI;return`rotate(${c(i)})`}}else if(r[0]===1&&r[1]===0&&r[2]===0&&r[3]===1)return`translate(${c(r[4])} ${c(r[5])})`;return`matrix(${c(r[0])} ${c(r[1])} ${c(r[2])} ${c(r[3])} ${c(r[4])} ${c(r[5])})`};const b={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},y="http://www.w3.org/XML/1998/namespace",u="http://www.w3.org/1999/xlink",g=["butt","round","square"],v=["miter","round","bevel"],k=function(){const r=new Uint8Array([137,80,78,71,13,10,26,10]),i=12,f=new Int32Array(256);for(let E=0;E<256;E++){let O=E;for(let G=0;G<8;G++)O&1?O=3988292384^O>>1&2147483647:O=O>>1&2147483647;f[E]=O}function x(E,O,G){let H=-1;for(let B=O;B<G;B++){const K=(H^E[B])&255,w=f[K];H=H>>>8^w}return H^-1}function m(E,O,G,H){let B=H;const K=O.length;G[B]=K>>24&255,G[B+1]=K>>16&255,G[B+2]=K>>8&255,G[B+3]=K&255,B+=4,G[B]=E.charCodeAt(0)&255,G[B+1]=E.charCodeAt(1)&255,G[B+2]=E.charCodeAt(2)&255,G[B+3]=E.charCodeAt(3)&255,B+=4,G.set(O,B),B+=O.length;const w=x(G,H+4,B);G[B]=w>>24&255,G[B+1]=w>>16&255,G[B+2]=w>>8&255,G[B+3]=w&255}function D(E,O,G){let H=1,B=0;for(let K=O;K<G;++K)H=(H+(E[K]&255))%65521,B=(B+H)%65521;return B<<16|H}function L(E){if(!S.isNodeJS)return Z(E);try{let O;parseInt(process.versions.node)>=8?O=E:O=Buffer.from(E);const G=require$$5.deflateSync(O,{level:9});return G instanceof Uint8Array?G:new Uint8Array(G)}catch(O){(0,e.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+O)}return Z(E)}function Z(E){let O=E.length;const G=65535,H=Math.ceil(O/G),B=new Uint8Array(2+O+H*5+4);let K=0;B[K++]=120,B[K++]=156;let w=0;for(;O>G;)B[K++]=0,B[K++]=255,B[K++]=255,B[K++]=0,B[K++]=0,B.set(E.subarray(w,w+G),K),K+=G,w+=G,O-=G;B[K++]=1,B[K++]=O&255,B[K++]=O>>8&255,B[K++]=~O&65535&255,B[K++]=(~O&65535)>>8&255,B.set(E.subarray(w),K),K+=E.length-w;const o=D(E,0,E.length);return B[K++]=o>>24&255,B[K++]=o>>16&255,B[K++]=o>>8&255,B[K++]=o&255,B}function $(E,O,G,H){const B=E.width,K=E.height;let w,o,t;const s=E.data;switch(O){case e.ImageKind.GRAYSCALE_1BPP:o=0,w=1,t=B+7>>3;break;case e.ImageKind.RGB_24BPP:o=2,w=8,t=B*3;break;case e.ImageKind.RGBA_32BPP:o=6,w=8,t=B*4;break;default:throw new Error("invalid format")}const n=new Uint8Array((1+t)*K);let l=0,a=0;for(let q=0;q<K;++q)n[l++]=0,n.set(s.subarray(a,a+t),l),a+=t,l+=t;if(O===e.ImageKind.GRAYSCALE_1BPP&&H){l=0;for(let q=0;q<K;q++){l++;for(let z=0;z<t;z++)n[l++]^=255}}const A=new Uint8Array([B>>24&255,B>>16&255,B>>8&255,B&255,K>>24&255,K>>16&255,K>>8&255,K&255,w,o,0,0,0]),C=L(n),I=r.length+i*3+A.length+C.length,N=new Uint8Array(I);let R=0;return N.set(r,R),R+=r.length,m("IHDR",A,N,R),R+=i+A.length,m("IDATA",C,N,R),R+=i+C.length,m("IEND",new Uint8Array(0),N,R),(0,e.createObjectURL)(N,"image/png",G)}return function(O,G,H){const B=O.kind===void 0?e.ImageKind.GRAYSCALE_1BPP:O.kind;return $(O,B,G,H)}}();class _{constructor(){this.fontSizeScale=1,this.fontWeight=b.fontWeight,this.fontSize=0,this.textMatrix=e.IDENTITY_MATRIX,this.fontMatrix=e.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=e.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=b.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(i,f){this.x=i,this.y=f}}let V=0,U=0,P=0;h.SVGGraphics=T=class{constructor(r,i,f=!1){this.svgFactory=new p.DOMSVGFactory,this.current=new _,this.transformMatrix=e.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=r,this.objs=i,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!f,this._operatorIdMapping=[];for(const x in e.OPS)this._operatorIdMapping[e.OPS[x]]=x}save(){this.transformStack.push(this.transformMatrix);const r=this.current;this.extraStack.push(r),this.current=r.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(r){this.save(),this.executeOpTree(r),this.restore()}loadDependencies(r){const i=r.fnArray,f=r.argsArray;for(let x=0,m=i.length;x<m;x++)if(i[x]===e.OPS.dependency)for(const D of f[x]){const L=D.startsWith("g_")?this.commonObjs:this.objs,Z=new Promise($=>{L.get(D,$)});this.current.dependencies.push(Z)}return Promise.all(this.current.dependencies)}transform(r,i,f,x,m,D){const L=[r,i,f,x,m,D];this.transformMatrix=e.Util.transform(this.transformMatrix,L),this.tgrp=null}getSVG(r,i){this.viewport=i;const f=this._initialize(i);return this.loadDependencies(r).then(()=>(this.transformMatrix=e.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(r)),f))}convertOpList(r){const i=this._operatorIdMapping,f=r.argsArray,x=r.fnArray,m=[];for(let D=0,L=x.length;D<L;D++){const Z=x[D];m.push({fnId:Z,fn:i[Z],args:f[D]})}return M(m)}executeOpTree(r){for(const i of r){const f=i.fn,x=i.fnId,m=i.args;switch(x|0){case e.OPS.beginText:this.beginText();break;case e.OPS.dependency:break;case e.OPS.setLeading:this.setLeading(m);break;case e.OPS.setLeadingMoveText:this.setLeadingMoveText(m[0],m[1]);break;case e.OPS.setFont:this.setFont(m);break;case e.OPS.showText:this.showText(m[0]);break;case e.OPS.showSpacedText:this.showText(m[0]);break;case e.OPS.endText:this.endText();break;case e.OPS.moveText:this.moveText(m[0],m[1]);break;case e.OPS.setCharSpacing:this.setCharSpacing(m[0]);break;case e.OPS.setWordSpacing:this.setWordSpacing(m[0]);break;case e.OPS.setHScale:this.setHScale(m[0]);break;case e.OPS.setTextMatrix:this.setTextMatrix(m[0],m[1],m[2],m[3],m[4],m[5]);break;case e.OPS.setTextRise:this.setTextRise(m[0]);break;case e.OPS.setTextRenderingMode:this.setTextRenderingMode(m[0]);break;case e.OPS.setLineWidth:this.setLineWidth(m[0]);break;case e.OPS.setLineJoin:this.setLineJoin(m[0]);break;case e.OPS.setLineCap:this.setLineCap(m[0]);break;case e.OPS.setMiterLimit:this.setMiterLimit(m[0]);break;case e.OPS.setFillRGBColor:this.setFillRGBColor(m[0],m[1],m[2]);break;case e.OPS.setStrokeRGBColor:this.setStrokeRGBColor(m[0],m[1],m[2]);break;case e.OPS.setStrokeColorN:this.setStrokeColorN(m);break;case e.OPS.setFillColorN:this.setFillColorN(m);break;case e.OPS.shadingFill:this.shadingFill(m[0]);break;case e.OPS.setDash:this.setDash(m[0],m[1]);break;case e.OPS.setRenderingIntent:this.setRenderingIntent(m[0]);break;case e.OPS.setFlatness:this.setFlatness(m[0]);break;case e.OPS.setGState:this.setGState(m[0]);break;case e.OPS.fill:this.fill();break;case e.OPS.eoFill:this.eoFill();break;case e.OPS.stroke:this.stroke();break;case e.OPS.fillStroke:this.fillStroke();break;case e.OPS.eoFillStroke:this.eoFillStroke();break;case e.OPS.clip:this.clip("nonzero");break;case e.OPS.eoClip:this.clip("evenodd");break;case e.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case e.OPS.paintImageXObject:this.paintImageXObject(m[0]);break;case e.OPS.paintInlineImageXObject:this.paintInlineImageXObject(m[0]);break;case e.OPS.paintImageMaskXObject:this.paintImageMaskXObject(m[0]);break;case e.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(m[0],m[1]);break;case e.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case e.OPS.closePath:this.closePath();break;case e.OPS.closeStroke:this.closeStroke();break;case e.OPS.closeFillStroke:this.closeFillStroke();break;case e.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case e.OPS.nextLine:this.nextLine();break;case e.OPS.transform:this.transform(m[0],m[1],m[2],m[3],m[4],m[5]);break;case e.OPS.constructPath:this.constructPath(m[0],m[1]);break;case e.OPS.endPath:this.endPath();break;case 92:this.group(i.items);break;default:(0,e.warn)(`Unimplemented operator ${f}`);break}}}setWordSpacing(r){this.current.wordSpacing=r}setCharSpacing(r){this.current.charSpacing=r}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(r,i,f,x,m,D){const L=this.current;L.textMatrix=L.lineMatrix=[r,i,f,x,m,D],L.textMatrixScale=Math.hypot(r,i),L.x=L.lineX=0,L.y=L.lineY=0,L.xcoords=[],L.ycoords=[],L.tspan=this.svgFactory.createElement("svg:tspan"),L.tspan.setAttributeNS(null,"font-family",L.fontFamily),L.tspan.setAttributeNS(null,"font-size",`${c(L.fontSize)}px`),L.tspan.setAttributeNS(null,"y",c(-L.y)),L.txtElement=this.svgFactory.createElement("svg:text"),L.txtElement.appendChild(L.tspan)}beginText(){const r=this.current;r.x=r.lineX=0,r.y=r.lineY=0,r.textMatrix=e.IDENTITY_MATRIX,r.lineMatrix=e.IDENTITY_MATRIX,r.textMatrixScale=1,r.tspan=this.svgFactory.createElement("svg:tspan"),r.txtElement=this.svgFactory.createElement("svg:text"),r.txtgrp=this.svgFactory.createElement("svg:g"),r.xcoords=[],r.ycoords=[]}moveText(r,i){const f=this.current;f.x=f.lineX+=r,f.y=f.lineY+=i,f.xcoords=[],f.ycoords=[],f.tspan=this.svgFactory.createElement("svg:tspan"),f.tspan.setAttributeNS(null,"font-family",f.fontFamily),f.tspan.setAttributeNS(null,"font-size",`${c(f.fontSize)}px`),f.tspan.setAttributeNS(null,"y",c(-f.y))}showText(r){const i=this.current,f=i.font,x=i.fontSize;if(x===0)return;const m=i.fontSizeScale,D=i.charSpacing,L=i.wordSpacing,Z=i.fontDirection,$=i.textHScale*Z,E=f.vertical,O=E?1:-1,G=f.defaultVMetrics,H=x*i.fontMatrix[0];let B=0;for(const o of r){if(o===null){B+=Z*L;continue}else if((0,e.isNum)(o)){B+=O*o*x/1e3;continue}const t=(o.isSpace?L:0)+D,s=o.fontChar;let n,l,a=o.width;if(E){let C;const I=o.vmetric||G;C=o.vmetric?I[1]:a*.5,C=-C*H;const N=I[2]*H;a=I?-I[0]:a,n=C/m,l=(B+N)/m}else n=B/m,l=0;(o.isInFont||f.missingFile)&&(i.xcoords.push(i.x+n),E&&i.ycoords.push(-i.y+l),i.tspan.textContent+=s);let A;E?A=a*H-t*Z:A=a*H+t*Z,B+=A}i.tspan.setAttributeNS(null,"x",i.xcoords.map(c).join(" ")),E?i.tspan.setAttributeNS(null,"y",i.ycoords.map(c).join(" ")):i.tspan.setAttributeNS(null,"y",c(-i.y)),E?i.y-=B:i.x+=B*$,i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${c(i.fontSize)}px`),i.fontStyle!==b.fontStyle&&i.tspan.setAttributeNS(null,"font-style",i.fontStyle),i.fontWeight!==b.fontWeight&&i.tspan.setAttributeNS(null,"font-weight",i.fontWeight);const K=i.textRenderingMode&e.TextRenderingMode.FILL_STROKE_MASK;if(K===e.TextRenderingMode.FILL||K===e.TextRenderingMode.FILL_STROKE?(i.fillColor!==b.fillColor&&i.tspan.setAttributeNS(null,"fill",i.fillColor),i.fillAlpha<1&&i.tspan.setAttributeNS(null,"fill-opacity",i.fillAlpha)):i.textRenderingMode===e.TextRenderingMode.ADD_TO_PATH?i.tspan.setAttributeNS(null,"fill","transparent"):i.tspan.setAttributeNS(null,"fill","none"),K===e.TextRenderingMode.STROKE||K===e.TextRenderingMode.FILL_STROKE){const o=1/(i.textMatrixScale||1);this._setStrokeAttributes(i.tspan,o)}let w=i.textMatrix;i.textRise!==0&&(w=w.slice(),w[5]+=i.textRise),i.txtElement.setAttributeNS(null,"transform",`${F(w)} scale(${c($)}, -1)`),i.txtElement.setAttributeNS(y,"xml:space","preserve"),i.txtElement.appendChild(i.tspan),i.txtgrp.appendChild(i.txtElement),this._ensureTransformGroup().appendChild(i.txtElement)}setLeadingMoveText(r,i){this.setLeading(-i),this.moveText(r,i)}addFontStyle(r){if(!r.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const i=(0,e.createObjectURL)(r.data,r.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${r.loadedName}"; src: url(${i}); }
`}setFont(r){const i=this.current,f=this.commonObjs.get(r[0]);let x=r[1];i.font=f,this.embedFonts&&!f.missingFile&&!this.embeddedFonts[f.loadedName]&&(this.addFontStyle(f),this.embeddedFonts[f.loadedName]=f),i.fontMatrix=f.fontMatrix||e.FONT_IDENTITY_MATRIX;let m="normal";f.black?m="900":f.bold&&(m="bold");const D=f.italic?"italic":"normal";x<0?(x=-x,i.fontDirection=-1):i.fontDirection=1,i.fontSize=x,i.fontFamily=f.loadedName,i.fontWeight=m,i.fontStyle=D,i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"y",c(-i.y)),i.xcoords=[],i.ycoords=[]}endText(){var i;const r=this.current;r.textRenderingMode&e.TextRenderingMode.ADD_TO_PATH_FLAG&&((i=r.txtElement)!=null&&i.hasChildNodes())&&(r.element=r.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(r){r>0&&(this.current.lineWidth=r)}setLineCap(r){this.current.lineCap=g[r]}setLineJoin(r){this.current.lineJoin=v[r]}setMiterLimit(r){this.current.miterLimit=r}setStrokeAlpha(r){this.current.strokeAlpha=r}setStrokeRGBColor(r,i,f){this.current.strokeColor=e.Util.makeHexColor(r,i,f)}setFillAlpha(r){this.current.fillAlpha=r}setFillRGBColor(r,i,f){this.current.fillColor=e.Util.makeHexColor(r,i,f),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(r){this.current.strokeColor=this._makeColorN_Pattern(r)}setFillColorN(r){this.current.fillColor=this._makeColorN_Pattern(r)}shadingFill(r){const i=this.viewport.width,f=this.viewport.height,x=e.Util.inverseTransform(this.transformMatrix),m=e.Util.applyTransform([0,0],x),D=e.Util.applyTransform([0,f],x),L=e.Util.applyTransform([i,0],x),Z=e.Util.applyTransform([i,f],x),$=Math.min(m[0],D[0],L[0],Z[0]),E=Math.min(m[1],D[1],L[1],Z[1]),O=Math.max(m[0],D[0],L[0],Z[0]),G=Math.max(m[1],D[1],L[1],Z[1]),H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x",$),H.setAttributeNS(null,"y",E),H.setAttributeNS(null,"width",O-$),H.setAttributeNS(null,"height",G-E),H.setAttributeNS(null,"fill",this._makeShadingPattern(r)),this.current.fillAlpha<1&&H.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(H)}_makeColorN_Pattern(r){return r[0]==="TilingPattern"?this._makeTilingPattern(r):this._makeShadingPattern(r)}_makeTilingPattern(r){const i=r[1],f=r[2],x=r[3]||e.IDENTITY_MATRIX,[m,D,L,Z]=r[4],$=r[5],E=r[6],O=r[7],G=`shading${P++}`,[H,B,K,w]=e.Util.normalizeRect([...e.Util.applyTransform([m,D],x),...e.Util.applyTransform([L,Z],x)]),[o,t]=e.Util.singularValueDecompose2dScale(x),s=$*o,n=E*t,l=this.svgFactory.createElement("svg:pattern");l.setAttributeNS(null,"id",G),l.setAttributeNS(null,"patternUnits","userSpaceOnUse"),l.setAttributeNS(null,"width",s),l.setAttributeNS(null,"height",n),l.setAttributeNS(null,"x",`${H}`),l.setAttributeNS(null,"y",`${B}`);const a=this.svg,A=this.transformMatrix,C=this.current.fillColor,I=this.current.strokeColor,N=this.svgFactory.create(K-H,w-B);if(this.svg=N,this.transformMatrix=x,O===2){const R=e.Util.makeHexColor(...i);this.current.fillColor=R,this.current.strokeColor=R}return this.executeOpTree(this.convertOpList(f)),this.svg=a,this.transformMatrix=A,this.current.fillColor=C,this.current.strokeColor=I,l.appendChild(N.childNodes[0]),this.defs.appendChild(l),`url(#${G})`}_makeShadingPattern(r){switch(r[0]){case"RadialAxial":const i=`shading${P++}`,f=r[3];let x;switch(r[1]){case"axial":const m=r[4],D=r[5];x=this.svgFactory.createElement("svg:linearGradient"),x.setAttributeNS(null,"id",i),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"x1",m[0]),x.setAttributeNS(null,"y1",m[1]),x.setAttributeNS(null,"x2",D[0]),x.setAttributeNS(null,"y2",D[1]);break;case"radial":const L=r[4],Z=r[5],$=r[6],E=r[7];x=this.svgFactory.createElement("svg:radialGradient"),x.setAttributeNS(null,"id",i),x.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),x.setAttributeNS(null,"cx",Z[0]),x.setAttributeNS(null,"cy",Z[1]),x.setAttributeNS(null,"r",E),x.setAttributeNS(null,"fx",L[0]),x.setAttributeNS(null,"fy",L[1]),x.setAttributeNS(null,"fr",$);break;default:throw new Error(`Unknown RadialAxial type: ${r[1]}`)}for(const m of f){const D=this.svgFactory.createElement("svg:stop");D.setAttributeNS(null,"offset",m[0]),D.setAttributeNS(null,"stop-color",m[1]),x.appendChild(D)}return this.defs.appendChild(x),`url(#${i})`;case"Mesh":return(0,e.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${r[0]}`)}}setDash(r,i){this.current.dashArray=r,this.current.dashPhase=i}constructPath(r,i){const f=this.current;let x=f.x,m=f.y,D=[],L=0;for(const Z of r)switch(Z|0){case e.OPS.rectangle:x=i[L++],m=i[L++];const $=i[L++],E=i[L++],O=x+$,G=m+E;D.push("M",c(x),c(m),"L",c(O),c(m),"L",c(O),c(G),"L",c(x),c(G),"Z");break;case e.OPS.moveTo:x=i[L++],m=i[L++],D.push("M",c(x),c(m));break;case e.OPS.lineTo:x=i[L++],m=i[L++],D.push("L",c(x),c(m));break;case e.OPS.curveTo:x=i[L+4],m=i[L+5],D.push("C",c(i[L]),c(i[L+1]),c(i[L+2]),c(i[L+3]),c(x),c(m)),L+=6;break;case e.OPS.curveTo2:D.push("C",c(x),c(m),c(i[L]),c(i[L+1]),c(i[L+2]),c(i[L+3])),x=i[L+2],m=i[L+3],L+=4;break;case e.OPS.curveTo3:x=i[L+2],m=i[L+3],D.push("C",c(i[L]),c(i[L+1]),c(x),c(m),c(x),c(m)),L+=4;break;case e.OPS.closePath:D.push("Z");break}D=D.join(" "),f.path&&r.length>0&&r[0]!==e.OPS.rectangle&&r[0]!==e.OPS.moveTo?D=f.path.getAttributeNS(null,"d")+D:(f.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(f.path)),f.path.setAttributeNS(null,"d",D),f.path.setAttributeNS(null,"fill","none"),f.element=f.path,f.setCurrentPoint(x,m)}endPath(){const r=this.current;if(r.path=null,!this.pendingClip)return;if(!r.element){this.pendingClip=null;return}const i=`clippath${V++}`,f=this.svgFactory.createElement("svg:clipPath");f.setAttributeNS(null,"id",i),f.setAttributeNS(null,"transform",F(this.transformMatrix));const x=r.element.cloneNode(!0);if(this.pendingClip==="evenodd"?x.setAttributeNS(null,"clip-rule","evenodd"):x.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,f.appendChild(x),this.defs.appendChild(f),r.activeClipUrl){r.clipGroup=null;for(const m of this.extraStack)m.clipGroup=null;f.setAttributeNS(null,"clip-path",r.activeClipUrl)}r.activeClipUrl=`url(#${i})`,this.tgrp=null}clip(r){this.pendingClip=r}closePath(){const r=this.current;if(r.path){const i=`${r.path.getAttributeNS(null,"d")}Z`;r.path.setAttributeNS(null,"d",i)}}setLeading(r){this.current.leading=-r}setTextRise(r){this.current.textRise=r}setTextRenderingMode(r){this.current.textRenderingMode=r}setHScale(r){this.current.textHScale=r/100}setRenderingIntent(r){}setFlatness(r){}setGState(r){for(const[i,f]of r)switch(i){case"LW":this.setLineWidth(f);break;case"LC":this.setLineCap(f);break;case"LJ":this.setLineJoin(f);break;case"ML":this.setMiterLimit(f);break;case"D":this.setDash(f[0],f[1]);break;case"RI":this.setRenderingIntent(f);break;case"FL":this.setFlatness(f);break;case"Font":this.setFont(f);break;case"CA":this.setStrokeAlpha(f);break;case"ca":this.setFillAlpha(f);break;default:(0,e.warn)(`Unimplemented graphic state operator ${i}`);break}}fill(){const r=this.current;r.element&&(r.element.setAttributeNS(null,"fill",r.fillColor),r.element.setAttributeNS(null,"fill-opacity",r.fillAlpha),this.endPath())}stroke(){const r=this.current;r.element&&(this._setStrokeAttributes(r.element),r.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(r,i=1){const f=this.current;let x=f.dashArray;i!==1&&x.length>0&&(x=x.map(function(m){return i*m})),r.setAttributeNS(null,"stroke",f.strokeColor),r.setAttributeNS(null,"stroke-opacity",f.strokeAlpha),r.setAttributeNS(null,"stroke-miterlimit",c(f.miterLimit)),r.setAttributeNS(null,"stroke-linecap",f.lineCap),r.setAttributeNS(null,"stroke-linejoin",f.lineJoin),r.setAttributeNS(null,"stroke-width",c(i*f.lineWidth)+"px"),r.setAttributeNS(null,"stroke-dasharray",x.map(c).join(" ")),r.setAttributeNS(null,"stroke-dashoffset",c(i*f.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width","1px"),r.setAttributeNS(null,"height","1px"),r.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(r)}paintImageXObject(r){const i=r.startsWith("g_")?this.commonObjs.get(r):this.objs.get(r);if(!i){(0,e.warn)(`Dependent image with object ID ${r} is not ready yet`);return}this.paintInlineImageXObject(i)}paintInlineImageXObject(r,i){const f=r.width,x=r.height,m=k(r,this.forceDataSchema,!!i),D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",c(f)),D.setAttributeNS(null,"height",c(x)),this.current.element=D,this.clip("nonzero");const L=this.svgFactory.createElement("svg:image");L.setAttributeNS(u,"xlink:href",m),L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y",c(-x)),L.setAttributeNS(null,"width",c(f)+"px"),L.setAttributeNS(null,"height",c(x)+"px"),L.setAttributeNS(null,"transform",`scale(${c(1/f)} ${c(-1/x)})`),i?i.appendChild(L):this._ensureTransformGroup().appendChild(L)}paintImageMaskXObject(r){const i=this.current,f=r.width,x=r.height,m=i.fillColor;i.maskId=`mask${U++}`;const D=this.svgFactory.createElement("svg:mask");D.setAttributeNS(null,"id",i.maskId);const L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y","0"),L.setAttributeNS(null,"width",c(f)),L.setAttributeNS(null,"height",c(x)),L.setAttributeNS(null,"fill",m),L.setAttributeNS(null,"mask",`url(#${i.maskId})`),this.defs.appendChild(D),this._ensureTransformGroup().appendChild(L),this.paintInlineImageXObject(r,D)}paintFormXObjectBegin(r,i){if(Array.isArray(r)&&r.length===6&&this.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i){const f=i[2]-i[0],x=i[3]-i[1],m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x",i[0]),m.setAttributeNS(null,"y",i[1]),m.setAttributeNS(null,"width",c(f)),m.setAttributeNS(null,"height",c(x)),this.current.element=m,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(r){const i=this.svgFactory.create(r.width,r.height),f=this.svgFactory.createElement("svg:defs");i.appendChild(f),this.defs=f;const x=this.svgFactory.createElement("svg:g");return x.setAttributeNS(null,"transform",F(r.transform)),i.appendChild(x),this.svg=x,i}_ensureClipGroup(){if(!this.current.clipGroup){const r=this.svgFactory.createElement("svg:g");r.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(r),this.current.clipGroup=r}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",F(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.XfaLayer=void 0;var e=d(2),p=d(17);class S{static setupStorage(b,y,u,g,v){const k=g.getValue(y,{value:null});switch(u.name){case"textarea":if(k.value!==null&&(b.textContent=k.value),v==="print")break;b.addEventListener("input",_=>{g.setValue(y,{value:_.target.value})});break;case"input":if(u.attributes.type==="radio"||u.attributes.type==="checkbox"){if(k.value===u.attributes.xfaOn?b.setAttribute("checked",!0):k.value===u.attributes.xfaOff&&b.removeAttribute("checked"),v==="print")break;b.addEventListener("change",_=>{g.setValue(y,{value:_.target.checked?_.target.getAttribute("xfaOn"):_.target.getAttribute("xfaOff")})})}else{if(k.value!==null&&b.setAttribute("value",k.value),v==="print")break;b.addEventListener("input",_=>{g.setValue(y,{value:_.target.value})})}break;case"select":if(k.value!==null)for(const _ of u.children)_.attributes.value===k.value&&(_.attributes.selected=!0);b.addEventListener("input",_=>{const M=_.target.options,c=M.selectedIndex===-1?"":M[M.selectedIndex].value;g.setValue(y,{value:c})});break}}static setAttributes({html:b,element:y,storage:u=null,intent:g,linkService:v}){var M;const{attributes:k}=y,_=b instanceof HTMLAnchorElement;k.type==="radio"&&(k.name=`${k.name}-${g}`);for(const[c,F]of Object.entries(k))if(!(F==null||c==="dataId"))if(c!=="style")if(c==="textContent")b.textContent=F;else if(c==="class")b.setAttribute(c,F.join(" "));else{if(_&&(c==="href"||c==="newWindow"))continue;b.setAttribute(c,F)}else Object.assign(b.style,F);_&&(v.addLinkAttributes||(0,e.warn)("XfaLayer.setAttribute - missing `addLinkAttributes`-method on the `linkService`-instance."),(M=v.addLinkAttributes)==null||M.call(v,b,k.href,k.newWindow)),u&&k.dataId&&this.setupStorage(b,k.dataId,y,u)}static render(b){var V;const y=b.annotationStorage,u=b.linkService,g=b.xfa,v=b.intent||"display",k=document.createElement(g.name);g.attributes&&this.setAttributes({html:k,element:g,intent:v,linkService:u});const _=[[g,-1,k]],M=b.div;M.appendChild(k);const c=`matrix(${b.viewport.transform.join(",")})`;M.style.transform=c,M.setAttribute("class","xfaLayer xfaFont");const F=[];for(;_.length>0;){const[U,P,r]=_[_.length-1];if(P+1===U.children.length){_.pop();continue}const i=U.children[++_[_.length-1][1]];if(i===null)continue;const{name:f}=i;if(f==="#text"){const m=document.createTextNode(i.value);F.push(m),r.appendChild(m);continue}let x;if((V=i==null?void 0:i.attributes)!=null&&V.xmlns?x=document.createElementNS(i.attributes.xmlns,f):x=document.createElement(f),r.appendChild(x),i.attributes&&this.setAttributes({html:x,element:i,storage:y,intent:v,linkService:u}),i.children&&i.children.length>0)_.push([i,-1,x]);else if(i.value){const m=document.createTextNode(i.value);p.XfaText.shouldBuildText(f)&&F.push(m),x.appendChild(m)}}for(const U of M.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))U.setAttribute("readOnly",!0);return{textDivs:F}}static update(b){const y=`matrix(${b.viewport.transform.join(",")})`;b.div.style.transform=y,b.div.hidden=!1}}h.XfaLayer=S},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFNodeStream=void 0;var e=d(2),p=d(24);const S=require$$5,T=require$$5,b=require$$5,y=require$$5,u=/^file:\/\/\/[a-zA-Z]:\//;function g(P){const r=y.parse(P);return r.protocol==="file:"||r.host?r:/^[a-z]:[/\\]/i.test(P)?y.parse(`file:///${P}`):(r.host||(r.protocol="file:"),r)}class v{constructor(r){this.source=r,this.url=g(r.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&r.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var r;return((r=this._fullRequestReader)==null?void 0:r._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new V(this):new c(this),this._fullRequestReader}getRangeReader(r,i){if(i<=this._progressiveDataLength)return null;const f=this.isFsUrl?new U(this,r,i):new F(this,r,i);return this._rangeRequestReaders.push(f),f}cancelAllRequests(r){this._fullRequestReader&&this._fullRequestReader.cancel(r);for(const i of this._rangeRequestReaders.slice(0))i.cancel(r)}}h.PDFNodeStream=v;class k{constructor(r){this._url=r.url,this._done=!1,this._storedError=null,this.onProgress=null;const i=r.source;this._contentLength=i.length,this._loaded=0,this._filename=null,this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)(),this._headersCapability=(0,e.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const r=this._readableStream.read();return r===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=r.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(r).buffer,done:!1})}cancel(r){if(!this._readableStream){this._error(r);return}this._readableStream.destroy(r)}_error(r){this._storedError=r,this._readCapability.resolve()}_setReadableStream(r){this._readableStream=r,r.on("readable",()=>{this._readCapability.resolve()}),r.on("end",()=>{r.destroy(),this._done=!0,this._readCapability.resolve()}),r.on("error",i=>{this._error(i)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new e.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _{constructor(r){this._url=r.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,e.createPromiseCapability)();const i=r.source;this._isStreamingSupported=!i.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const r=this._readableStream.read();return r===null?(this._readCapability=(0,e.createPromiseCapability)(),this.read()):(this._loaded+=r.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(r).buffer,done:!1})}cancel(r){if(!this._readableStream){this._error(r);return}this._readableStream.destroy(r)}_error(r){this._storedError=r,this._readCapability.resolve()}_setReadableStream(r){this._readableStream=r,r.on("readable",()=>{this._readCapability.resolve()}),r.on("end",()=>{r.destroy(),this._done=!0,this._readCapability.resolve()}),r.on("error",i=>{this._error(i)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function M(P,r){return{protocol:P.protocol,auth:P.auth,host:P.hostname,port:P.port,path:P.path,method:"GET",headers:r}}class c extends k{constructor(r){super(r);const i=f=>{if(f.statusCode===404){const L=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=L,this._headersCapability.reject(L);return}this._headersCapability.resolve(),this._setReadableStream(f);const x=L=>this._readableStream.headers[L.toLowerCase()],{allowRangeRequests:m,suggestedLength:D}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:r.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=D||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(x)};this._request=null,this._url.protocol==="http:"?this._request=T.request(M(this._url,r.httpHeaders),i):this._request=b.request(M(this._url,r.httpHeaders),i),this._request.on("error",f=>{this._storedError=f,this._headersCapability.reject(f)}),this._request.end()}}class F extends _{constructor(r,i,f){super(r),this._httpHeaders={};for(const m in r.httpHeaders){const D=r.httpHeaders[m];typeof D>"u"||(this._httpHeaders[m]=D)}this._httpHeaders.Range=`bytes=${i}-${f-1}`;const x=m=>{if(m.statusCode===404){const D=new e.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=D;return}this._setReadableStream(m)};this._request=null,this._url.protocol==="http:"?this._request=T.request(M(this._url,this._httpHeaders),x):this._request=b.request(M(this._url,this._httpHeaders),x),this._request.on("error",m=>{this._storedError=m}),this._request.end()}}class V extends k{constructor(r){super(r);let i=decodeURIComponent(this._url.path);u.test(this._url.href)&&(i=i.replace(/^\//,"")),S.lstat(i,(f,x)=>{if(f){f.code==="ENOENT"&&(f=new e.MissingPDFException(`Missing PDF "${i}".`)),this._storedError=f,this._headersCapability.reject(f);return}this._contentLength=x.size,this._setReadableStream(S.createReadStream(i)),this._headersCapability.resolve()})}}class U extends _{constructor(r,i,f){super(r);let x=decodeURIComponent(this._url.path);u.test(this._url.href)&&(x=x.replace(/^\//,"")),this._setReadableStream(S.createReadStream(x,{start:i,end:f-1}))}}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.createResponseStatusError=y,h.extractFilenameFromHeader=b,h.validateRangeRequestCapabilities=T,h.validateResponseStatus=u;var e=d(2),p=d(25),S=d(1);function T({getResponseHeader:g,isHttp:v,rangeChunkSize:k,disableRange:_}){(0,e.assert)(k>0,"Range chunk size must be larger than zero");const M={allowRangeRequests:!1,suggestedLength:void 0},c=parseInt(g("Content-Length"),10);return!Number.isInteger(c)||(M.suggestedLength=c,c<=2*k)||_||!v||g("Accept-Ranges")!=="bytes"||(g("Content-Encoding")||"identity")!=="identity"||(M.allowRangeRequests=!0),M}function b(g){const v=g("Content-Disposition");if(v){let k=(0,p.getFilenameFromContentDispositionHeader)(v);if(k.includes("%"))try{k=decodeURIComponent(k)}catch{}if((0,S.isPdfFile)(k))return k}return null}function y(g,v){return g===404||g===0&&v.startsWith("file:")?new e.MissingPDFException('Missing PDF "'+v+'".'):new e.UnexpectedResponseException(`Unexpected server response (${g}) while retrieving PDF "${v}".`,g)}function u(g){return g===200||g===206}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getFilenameFromContentDispositionHeader=p;var e=d(2);function p(S){let T=!0,b=y("filename\\*","i").exec(S);if(b){b=b[1];let c=k(b);return c=unescape(c),c=_(c),c=M(c),g(c)}if(b=v(S),b){const c=M(b);return g(c)}if(b=y("filename","i").exec(S),b){b=b[1];let c=k(b);return c=M(c),g(c)}function y(c,F){return new RegExp("(?:^|;)\\s*"+c+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',F)}function u(c,F){if(c){if(!/^[\x00-\xFF]+$/.test(F))return F;try{const V=new TextDecoder(c,{fatal:!0}),U=(0,e.stringToBytes)(F);F=V.decode(U),T=!1}catch{if(/^utf-?8$/i.test(c))try{F=decodeURIComponent(escape(F)),T=!1}catch{}}}return F}function g(c){return T&&/[\x80-\xff]/.test(c)&&(c=u("utf-8",c),T&&(c=u("iso-8859-1",c))),c}function v(c){const F=[];let V;const U=y("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(V=U.exec(c))!==null;){let[,r,i,f]=V;if(r=parseInt(r,10),r in F){if(r===0)break;continue}F[r]=[i,f]}const P=[];for(let r=0;r<F.length&&r in F;++r){let[i,f]=F[r];f=k(f),i&&(f=unescape(f),r===0&&(f=_(f))),P.push(f)}return P.join("")}function k(c){if(c.startsWith('"')){const F=c.slice(1).split('\\"');for(let V=0;V<F.length;++V){const U=F[V].indexOf('"');U!==-1&&(F[V]=F[V].slice(0,U),F.length=V+1),F[V]=F[V].replace(/\\(.)/g,"$1")}c=F.join('"')}return c}function _(c){const F=c.indexOf("'");if(F===-1)return c;const V=c.slice(0,F),P=c.slice(F+1).replace(/^[^']*'/,"");return u(V,P)}function M(c){return!c.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(c)?c:c.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(F,V,U,P){if(U==="q"||U==="Q")return P=P.replace(/_/g," "),P=P.replace(/=([0-9a-fA-F]{2})/g,function(r,i){return String.fromCharCode(parseInt(i,16))}),u(V,P);try{P=atob(P)}catch{}return u(V,P)})}return""}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFNetworkStream=void 0;var e=d(2),p=d(24);const S=200,T=206;function b(k){const _=k.response;return typeof _!="string"?_:(0,e.stringToBytes)(_).buffer}class y{constructor(_,M={}){this.url=_,this.isHttp=/^https?:/i.test(_),this.httpHeaders=this.isHttp&&M.httpHeaders||Object.create(null),this.withCredentials=M.withCredentials||!1,this.getXhr=M.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(_,M,c){const F={begin:_,end:M};for(const V in c)F[V]=c[V];return this.request(F)}requestFull(_){return this.request(_)}request(_){const M=this.getXhr(),c=this.currXhrId++,F=this.pendingRequests[c]={xhr:M};M.open("GET",this.url),M.withCredentials=this.withCredentials;for(const V in this.httpHeaders){const U=this.httpHeaders[V];typeof U>"u"||M.setRequestHeader(V,U)}return this.isHttp&&"begin"in _&&"end"in _?(M.setRequestHeader("Range",`bytes=${_.begin}-${_.end-1}`),F.expectedStatus=T):F.expectedStatus=S,M.responseType="arraybuffer",_.onError&&(M.onerror=function(V){_.onError(M.status)}),M.onreadystatechange=this.onStateChange.bind(this,c),M.onprogress=this.onProgress.bind(this,c),F.onHeadersReceived=_.onHeadersReceived,F.onDone=_.onDone,F.onError=_.onError,F.onProgress=_.onProgress,M.send(null),c}onProgress(_,M){var F;const c=this.pendingRequests[_];c&&((F=c.onProgress)==null||F.call(c,M))}onStateChange(_,M){var r,i,f;const c=this.pendingRequests[_];if(!c)return;const F=c.xhr;if(F.readyState>=2&&c.onHeadersReceived&&(c.onHeadersReceived(),delete c.onHeadersReceived),F.readyState!==4||!(_ in this.pendingRequests))return;if(delete this.pendingRequests[_],F.status===0&&this.isHttp){(r=c.onError)==null||r.call(c,F.status);return}const V=F.status||S;if(!(V===S&&c.expectedStatus===T)&&V!==c.expectedStatus){(i=c.onError)==null||i.call(c,F.status);return}const P=b(F);if(V===T){const x=F.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(x);c.onDone({begin:parseInt(m[1],10),chunk:P})}else P?c.onDone({begin:0,chunk:P}):(f=c.onError)==null||f.call(c,F.status)}getRequestXhr(_){return this.pendingRequests[_].xhr}isPendingRequest(_){return _ in this.pendingRequests}abortRequest(_){const M=this.pendingRequests[_].xhr;delete this.pendingRequests[_],M.abort()}}class u{constructor(_){this._source=_,this._manager=new y(_.url,{httpHeaders:_.httpHeaders,withCredentials:_.withCredentials}),this._rangeChunkSize=_.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(_){const M=this._rangeRequestReaders.indexOf(_);M>=0&&this._rangeRequestReaders.splice(M,1)}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader}getRangeReader(_,M){const c=new v(this._manager,_,M);return c.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(c),c}cancelAllRequests(_){var M;(M=this._fullRequestReader)==null||M.cancel(_);for(const c of this._rangeRequestReaders.slice(0))c.cancel(_)}}h.PDFNetworkStream=u;class g{constructor(_,M){this._manager=_;const c={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=M.url,this._fullRequestId=_.requestFull(c),this._headersReceivedCapability=(0,e.createPromiseCapability)(),this._disableRange=M.disableRange||!1,this._contentLength=M.length,this._rangeChunkSize=M.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const _=this._fullRequestId,M=this._manager.getRequestXhr(_),c=U=>M.getResponseHeader(U),{allowRangeRequests:F,suggestedLength:V}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});F&&(this._isRangeSupported=!0),this._contentLength=V||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(c),this._isRangeSupported&&this._manager.abortRequest(_),this._headersReceivedCapability.resolve()}_onDone(_){if(_&&(this._requests.length>0?this._requests.shift().resolve({value:_.chunk,done:!1}):this._cachedChunks.push(_.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(_){this._storedError=(0,p.createResponseStatusError)(_,this._url),this._headersReceivedCapability.reject(this._storedError);for(const M of this._requests)M.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(_){var M;(M=this.onProgress)==null||M.call(this,{loaded:_.loaded,total:_.lengthComputable?_.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const _=(0,e.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0,this._headersReceivedCapability.reject(_);for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class v{constructor(_,M,c){this._manager=_;const F={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=_.url,this._requestId=_.requestRange(M,c,F),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var _;(_=this.onClosed)==null||_.call(this,this)}_onDone(_){const M=_.chunk;this._requests.length>0?this._requests.shift().resolve({value:M,done:!1}):this._queuedChunk=M,this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(_){this._storedError=(0,p.createResponseStatusError)(_,this._url);for(const M of this._requests)M.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(_){var M;this.isStreamingSupported||(M=this.onProgress)==null||M.call(this,{loaded:_.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const M=this._queuedChunk;return this._queuedChunk=null,{value:M,done:!1}}if(this._done)return{value:void 0,done:!0};const _=(0,e.createPromiseCapability)();return this._requests.push(_),_.promise}cancel(_){this._done=!0;for(const M of this._requests)M.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Q,h,d)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PDFFetchStream=void 0;var e=d(2),p=d(24);function S(g,v,k){return{method:"GET",headers:g,signal:k==null?void 0:k.signal,mode:"cors",credentials:v?"include":"same-origin",redirect:"follow"}}function T(g){const v=new Headers;for(const k in g){const _=g[k];typeof _>"u"||v.append(k,_)}return v}class b{constructor(v){this.source=v,this.isHttp=/^https?:/i.test(v.url),this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var v;return((v=this._fullRequestReader)==null?void 0:v._loaded)??0}getFullReader(){return(0,e.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new y(this),this._fullRequestReader}getRangeReader(v,k){if(k<=this._progressiveDataLength)return null;const _=new u(this,v,k);return this._rangeRequestReaders.push(_),_}cancelAllRequests(v){this._fullRequestReader&&this._fullRequestReader.cancel(v);for(const k of this._rangeRequestReaders.slice(0))k.cancel(v)}}h.PDFFetchStream=b;class y{constructor(v){this._stream=v,this._reader=null,this._loaded=0,this._filename=null;const k=v.source;this._withCredentials=k.withCredentials||!1,this._contentLength=k.length,this._headersCapability=(0,e.createPromiseCapability)(),this._disableRange=k.disableRange||!1,this._rangeChunkSize=k.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!k.disableStream,this._isRangeSupported=!k.disableRange,this._headers=T(this._stream.httpHeaders);const _=k.url;fetch(_,S(this._headers,this._withCredentials,this._abortController)).then(M=>{if(!(0,p.validateResponseStatus)(M.status))throw(0,p.createResponseStatusError)(M.status,_);this._reader=M.body.getReader(),this._headersCapability.resolve();const c=U=>M.headers.get(U),{allowRangeRequests:F,suggestedLength:V}=(0,p.validateRangeRequestCapabilities)({getResponseHeader:c,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=F,this._contentLength=V||this._contentLength,this._filename=(0,p.extractFilenameFromHeader)(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new e.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:v,done:k}=await this._reader.read();return k?{value:v,done:k}:(this._loaded+=v.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){this._reader&&this._reader.cancel(v),this._abortController&&this._abortController.abort()}}class u{constructor(v,k,_){this._stream=v,this._reader=null,this._loaded=0;const M=v.source;this._withCredentials=M.withCredentials||!1,this._readCapability=(0,e.createPromiseCapability)(),this._isStreamingSupported=!M.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=T(this._stream.httpHeaders),this._headers.append("Range",`bytes=${k}-${_-1}`);const c=M.url;fetch(c,S(this._headers,this._withCredentials,this._abortController)).then(F=>{if(!(0,p.validateResponseStatus)(F.status))throw(0,p.createResponseStatusError)(F.status,c);this._readCapability.resolve(),this._reader=F.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:v,done:k}=await this._reader.read();return k?{value:v,done:k}:(this._loaded+=v.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){this._reader&&this._reader.cancel(v),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Q){var h=__webpack_module_cache__[Q];if(h!==void 0)return h.exports;var d=__webpack_module_cache__[Q]={exports:{}};return __webpack_modules__[Q](d,d.exports,__w_pdfjs_require__),d.exports}var __webpack_exports__={};return(()=>{var Q=__webpack_exports__;Object.defineProperty(Q,"__esModule",{value:!0}),Object.defineProperty(Q,"addLinkAttributes",{enumerable:!0,get:function(){return h.addLinkAttributes}}),Object.defineProperty(Q,"getFilenameFromUrl",{enumerable:!0,get:function(){return h.getFilenameFromUrl}}),Object.defineProperty(Q,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return h.getPdfFilenameFromUrl}}),Object.defineProperty(Q,"getXfaPageViewport",{enumerable:!0,get:function(){return h.getXfaPageViewport}}),Object.defineProperty(Q,"isPdfFile",{enumerable:!0,get:function(){return h.isPdfFile}}),Object.defineProperty(Q,"LinkTarget",{enumerable:!0,get:function(){return h.LinkTarget}}),Object.defineProperty(Q,"loadScript",{enumerable:!0,get:function(){return h.loadScript}}),Object.defineProperty(Q,"PDFDateString",{enumerable:!0,get:function(){return h.PDFDateString}}),Object.defineProperty(Q,"PixelsPerInch",{enumerable:!0,get:function(){return h.PixelsPerInch}}),Object.defineProperty(Q,"RenderingCancelledException",{enumerable:!0,get:function(){return h.RenderingCancelledException}}),Object.defineProperty(Q,"AnnotationMode",{enumerable:!0,get:function(){return d.AnnotationMode}}),Object.defineProperty(Q,"CMapCompressionType",{enumerable:!0,get:function(){return d.CMapCompressionType}}),Object.defineProperty(Q,"createObjectURL",{enumerable:!0,get:function(){return d.createObjectURL}}),Object.defineProperty(Q,"createPromiseCapability",{enumerable:!0,get:function(){return d.createPromiseCapability}}),Object.defineProperty(Q,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return d.createValidAbsoluteUrl}}),Object.defineProperty(Q,"InvalidPDFException",{enumerable:!0,get:function(){return d.InvalidPDFException}}),Object.defineProperty(Q,"MissingPDFException",{enumerable:!0,get:function(){return d.MissingPDFException}}),Object.defineProperty(Q,"OPS",{enumerable:!0,get:function(){return d.OPS}}),Object.defineProperty(Q,"PasswordResponses",{enumerable:!0,get:function(){return d.PasswordResponses}}),Object.defineProperty(Q,"PermissionFlag",{enumerable:!0,get:function(){return d.PermissionFlag}}),Object.defineProperty(Q,"removeNullCharacters",{enumerable:!0,get:function(){return d.removeNullCharacters}}),Object.defineProperty(Q,"shadow",{enumerable:!0,get:function(){return d.shadow}}),Object.defineProperty(Q,"UnexpectedResponseException",{enumerable:!0,get:function(){return d.UnexpectedResponseException}}),Object.defineProperty(Q,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return d.UNSUPPORTED_FEATURES}}),Object.defineProperty(Q,"Util",{enumerable:!0,get:function(){return d.Util}}),Object.defineProperty(Q,"VerbosityLevel",{enumerable:!0,get:function(){return d.VerbosityLevel}}),Object.defineProperty(Q,"build",{enumerable:!0,get:function(){return e.build}}),Object.defineProperty(Q,"getDocument",{enumerable:!0,get:function(){return e.getDocument}}),Object.defineProperty(Q,"LoopbackPort",{enumerable:!0,get:function(){return e.LoopbackPort}}),Object.defineProperty(Q,"PDFDataRangeTransport",{enumerable:!0,get:function(){return e.PDFDataRangeTransport}}),Object.defineProperty(Q,"PDFWorker",{enumerable:!0,get:function(){return e.PDFWorker}}),Object.defineProperty(Q,"version",{enumerable:!0,get:function(){return e.version}}),Object.defineProperty(Q,"AnnotationLayer",{enumerable:!0,get:function(){return p.AnnotationLayer}}),Object.defineProperty(Q,"GlobalWorkerOptions",{enumerable:!0,get:function(){return S.GlobalWorkerOptions}}),Object.defineProperty(Q,"renderTextLayer",{enumerable:!0,get:function(){return b.renderTextLayer}}),Object.defineProperty(Q,"SVGGraphics",{enumerable:!0,get:function(){return y.SVGGraphics}}),Object.defineProperty(Q,"XfaLayer",{enumerable:!0,get:function(){return u.XfaLayer}});var h=__w_pdfjs_require__(1),d=__w_pdfjs_require__(2),e=__w_pdfjs_require__(6),p=__w_pdfjs_require__(18),S=__w_pdfjs_require__(12),T=__w_pdfjs_require__(4),b=__w_pdfjs_require__(20),y=__w_pdfjs_require__(21),u=__w_pdfjs_require__(22);if(T.isNodeJS){const{PDFNodeStream:g}=__w_pdfjs_require__(23);(0,e.setPDFNetworkStreamFactory)(v=>new g(v))}else{const{PDFNetworkStream:g}=__w_pdfjs_require__(26),{PDFFetchStream:v}=__w_pdfjs_require__(27);(0,e.setPDFNetworkStreamFactory)(k=>(0,h.isValidFetchUrl)(k.url)?new v(k):new g(k))}})(),__webpack_exports__})()})})(pdf);export{pdfExports as p};
