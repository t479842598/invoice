import{ai as O,aT as V,aF as $,by as ee,H as _,bD as d,aX as c,o as r,W as o,a,b9 as k,c as b,aV as f,bi as h,F as S,U as i,bF as x,bv as y}from"./_@vue-5ba92de9.js";import{d as E}from"./form-design-8c117009.js";import"./index-823f4b27.js";import"./__vendor-5e6ac033.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";import"./_jquery-3a83ed9f.js";const le={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},ae=a("th",{style:{width:"60px"}},"控件id",-1),te={class:"roadui_formfont"},ue=a("th",null,"绑定字段",-1),oe={class:"roadui_note1"},de={style:{"margin-left":"12px"}},ne=a("th",null,"默认值",-1),re=a("th",null,"宽度",-1),ie={style:{"margin-right":"12px"}},se=a("th",null,"选项来源",-1),ce={style:{"margin-left":"12px"}},me=a("th",null,"字典项",-1),ve=a("th",null,"字符串",-1),pe=a("th",null,"SQL",-1),ge=a("th",null,"URL",-1),be={colspan:"2"},Ve={style:{"margin-right":"12px"}},_e={style:{"margin-top":"12px"}},fe={class:"roadui_formtable",style:{width:"98%",margin:"0 auto"}},he=a("th",{style:{width:"50px"}},"事件",-1),Se=a("th",null,"脚本",-1),Fe={__name:"selects",props:{query:{type:String,default:()=>""}},setup(J){const n=O("utils"),B=O("ElSelectdict"),j=O("ElCodemirror"),Q=J,H=n.query("editorname",Q.query),g=window.parent.CKEDITOR.instances[H],A=g.formAttributeJSON,e=V({}),m=V({}),w=V(""),I=V([]),K=E.defaultValueOptions(),D=V([]),F=V([]),T=V(null),M=E.dataSourceOptions(),P=E.dictValueFieldOptions();$(()=>{A&&n.getConnTableFields(A.dbConn,A.dbTable).then(u=>{I.value=u}),R()}),ee(()=>e.value.dataSource,u=>{u=="sql"&&n.getConns().then(t=>{F.value=t})});const W=u=>{n.length(u)!==0&&(e.value.defaultValue+=u[u.length-1])},X=u=>{if(u.length>0&&n.isDef(g)){D.value=[];let t=g.document.getElementsByTag("input");for(let v=0;v<t.count();v++){let p=t.getItem(v).getAttribute("data-id");if(p==e.value.id)continue;let s=t.getItem(v).getAttribute("data-label");D.value.push({value:p,label:n.length(s)>0?s+" ("+p+")":p})}}},R=u=>{e.value={id:"",label:"",field:"",width:"",defaultValue:"",placeholder:"",selectParent:"",dataSource:"",dataSourceDict:"",dataSourceDictValueField:"",search:!1,allowClear:!1,multiple:!1,dataSourceString:"",dataSourceSqlConn:"",dataSourceSql:"",dataSourceUrl:"",linkageId:"",linkageDataSource:"",linkageText:""},m.value={},u||(u=g.currentSelectEditorElement),u&&(e.value.id=u.getAttribute("data-id"),e.value.label=u.getAttribute("data-label"),e.value.field=u.getAttribute("data-bindfiled"),e.value.defaultValue=n.decodeURI(u.getAttribute("data-defaultvalue")),e.value.width=u.getAttribute("data-width"),e.value.placeholder=u.getAttribute("data-placeholder"),e.value.dataSource=u.getAttribute("data-datasource"),e.value.dataSourceDict=u.getAttribute("data-datasourcedict"),e.value.dataSourceDictValueField=u.getAttribute("data-datasourcedictvaluefield"),e.value.dataSourceString=n.decodeURI(u.getAttribute("data-datasourcestring")),e.value.dataSourceSqlConn=u.getAttribute("data-datasourcesqlconn"),e.value.dataSourceSql=n.decodeURI(u.getAttribute("data-datasourcesql")),e.value.dataSourceUrl=n.decodeURI(u.getAttribute("data-datasourceurl")),e.value.search=u.getAttribute("data-search")=="true",e.value.allowClear=u.getAttribute("data-allowclear")=="true",e.value.multiple=u.getAttribute("data-multiple")=="true",e.value.linkageId=u.getAttribute("data-linkageid"),e.value.linkageDataSource=u.getAttribute("data-linkagedatasource"),e.value.linkageText=n.decodeURI(u.getAttribute("data-linkagetext")),T.value.initTitle(e.value.dataSourceDict),m.value=n.getArrayObj(g.formEventsJSON,e.value.id,"id"),n.isUndef(m.value)?(m.value={id:e.value.id,events:[{name:"change",script:""}]},g.formEventsJSON.push(m.value)):n.length(m.value.events)===0&&(m.value={id:e.value.id,events:[{name:"change",script:""}]}),w.value=m.value.events[0].name),g.currentSelectEditorElementJson=e.value,g.initFunction_select=R};return(u,t)=>{const v=c("el-option"),p=c("el-select"),s=c("el-input"),z=c("el-cascader"),C=c("el-checkbox"),U=c("el-radio"),L=c("el-radio-group"),G=c("el-collapse-item"),Y=c("el-collapse"),N=c("el-tab-pane"),Z=c("el-tabs");return r(),_(Z,null,{default:d(()=>[o(N,{name:"0",label:"属性",style:{height:"100%"}},{default:d(()=>[a("table",le,[a("tr",null,[ae,a("td",te,k(e.value.id),1)]),a("tr",null,[ue,a("td",null,[o(p,{modelValue:e.value.field,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.field=l),filterable:"",style:{width:"260px"},clearable:""},{default:d(()=>[(r(!0),b(S,null,f(I.value,l=>(r(),_(v,{key:l.name,value:l.name,label:l.name+(h(n).length(l.comment)>0?" - "+l.comment:"")},{default:d(()=>[a("span",null,k(l.name),1),a("span",oe,k(h(n).length(l.comment)>0?" - "+l.comment:""),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),a("span",de,[i(" 标签"),o(s,{modelValue:e.value.label,"onUpdate:modelValue":t[1]||(t[1]=l=>e.value.label=l),placeholder:"控件label",style:{width:"280px","margin-left":"12px"},clearable:""},null,8,["modelValue"])])])]),a("tr",null,[ne,a("td",null,[o(z,{placeholder:"选择默认值",options:h(K),props:{expandTrigger:"hover",checkStrictly:!1},clearable:"",onChange:W,style:{width:"260px","margin-right":"18px"}},null,8,["options"]),o(s,{modelValue:e.value.defaultValue,"onUpdate:modelValue":t[2]||(t[2]=l=>e.value.defaultValue=l),style:{width:"318px"},clearable:""},null,8,["modelValue"])])]),a("tr",null,[re,a("td",null,[o(s,{modelValue:e.value.width,"onUpdate:modelValue":t[3]||(t[3]=l=>e.value.width=l),placeholder:"px或%",style:{width:"100px","margin-right":"12px"},clearable:""},null,8,["modelValue"]),a("span",ie,[i("背景文字"),o(s,{modelValue:e.value.placeholder,"onUpdate:modelValue":t[4]||(t[4]=l=>e.value.placeholder=l),placeholder:"placeholder",style:{width:"200px","margin-left":"12px"},clearable:""},null,8,["modelValue"])]),o(C,{modelValue:e.value.search,"onUpdate:modelValue":t[5]||(t[5]=l=>e.value.search=l)},{default:d(()=>[i("搜索")]),_:1},8,["modelValue"]),o(C,{modelValue:e.value.allowClear,"onUpdate:modelValue":t[6]||(t[6]=l=>e.value.allowClear=l)},{default:d(()=>[i("清空")]),_:1},8,["modelValue"]),o(C,{modelValue:e.value.multiple,"onUpdate:modelValue":t[7]||(t[7]=l=>e.value.multiple=l)},{default:d(()=>[i("多选")]),_:1},8,["modelValue"])])]),a("tr",null,[se,a("td",null,[o(L,{modelValue:e.value.dataSource,"onUpdate:modelValue":t[8]||(t[8]=l=>e.value.dataSource=l),style:{"vertical-align":"middle"}},{default:d(()=>[(r(!0),b(S,null,f(h(M),l=>(r(),_(U,{key:l.value,label:l.value},{default:d(()=>[i(k(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),x(a("span",ce,[i(" 数据连接 "),o(p,{modelValue:e.value.dataSourceSqlConn,"onUpdate:modelValue":t[9]||(t[9]=l=>e.value.dataSourceSqlConn=l),placeholder:"选择执行SQL的数据连接",clearable:"",style:{width:"200px",margin:"0 12px","vertical-align":"middle"}},{default:d(()=>[(r(!0),b(S,null,f(F.value,(l,q)=>(r(),_(v,{key:"conn_"+q,value:l.id,label:l.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])],512),[[y,e.value.dataSource=="sql"]])])]),x(a("tr",null,[me,a("td",null,[o(h(B),{modelValue:e.value.dataSourceDict,"onUpdate:modelValue":t[10]||(t[10]=l=>e.value.dataSourceDict=l),ref_key:"dataSourceDictRef",ref:T,style:{width:"380px","margin-right":"12px"},clearable:""},null,8,["modelValue"]),i(" 值字段 "),o(p,{modelValue:e.value.dataSourceDictValueField,"onUpdate:modelValue":t[11]||(t[11]=l=>e.value.dataSourceDictValueField=l),style:{width:"127px","margin-left":"12px"},clearable:""},{default:d(()=>[(r(!0),b(S,null,f(h(P),l=>(r(),_(v,{key:l.value,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])],512),[[y,e.value.dataSource=="dict"]]),x(a("tr",null,[ve,a("td",null,[o(s,{type:"textarea",rows:3,modelValue:e.value.dataSourceString,"onUpdate:modelValue":t[12]||(t[12]=l=>e.value.dataSourceString=l),clearable:"",placeholder:"格式：选项1值,选项1标题;选项2值,选项2标题...（字符串不能有单引号)"},null,8,["modelValue"])])],512),[[y,e.value.dataSource=="string"]]),x(a("tr",null,[pe,a("td",null,[o(s,{type:"textarea",rows:3,modelValue:e.value.dataSourceSql,"onUpdate:modelValue":t[13]||(t[13]=l=>e.value.dataSourceSql=l),clearable:"",placeholder:"查询返回两个字段，选项值和选项标题。如果只返回一个字段，则选项值和选项标题一样。"},null,8,["modelValue"])])],512),[[y,e.value.dataSource=="sql"]]),x(a("tr",null,[ge,a("td",null,[o(s,{type:"textarea",rows:3,modelValue:e.value.dataSourceUrl,"onUpdate:modelValue":t[14]||(t[14]=l=>e.value.dataSourceUrl=l),clearable:"",placeholder:"post一个url地址，地址返回[{value:'值',label:'标题'},...]格式json字符串。"},null,8,["modelValue"])])],512),[[y,e.value.dataSource=="url"]]),a("tr",null,[a("td",be,[o(Y,{onChange:X},{default:d(()=>[o(G,{title:"联动"},{default:d(()=>[a("div",null,[a("div",null,[a("span",Ve,[i(" 控件id "),o(p,{modelValue:e.value.linkageId,"onUpdate:modelValue":t[15]||(t[15]=l=>e.value.linkageId=l),style:{width:"250px","margin-left":"12px"},clearable:""},{default:d(()=>[(r(!0),b(S,null,f(D.value,l=>(r(),_(v,{key:l.value,value:l.value,label:l.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),a("span",null,[i(" 选项来源 "),o(L,{modelValue:e.value.linkageDataSource,"onUpdate:modelValue":t[16]||(t[16]=l=>e.value.linkageDataSource=l),style:{"vertical-align":"middle","margin-left":"12px"}},{default:d(()=>[o(U,{label:"dict"},{default:d(()=>[i("数据字典下级")]),_:1}),o(U,{label:"sql"},{default:d(()=>[i("SQL")]),_:1}),o(U,{label:"url"},{default:d(()=>[i("URL")]),_:1})]),_:1},8,["modelValue"])])]),a("div",_e,[o(s,{type:"textarea",modelValue:e.value.linkageText,"onUpdate:modelValue":t[17]||(t[17]=l=>e.value.linkageText=l),placeholder:"加载下级SQL/URL",rows:2,clearable:""},null,8,["modelValue"])])])]),_:1})]),_:1})])])])]),_:1}),o(N,{name:"1",label:"事件",style:{height:"100%"}},{default:d(()=>[a("table",fe,[a("tr",null,[he,a("td",null,[o(p,{modelValue:w.value,"onUpdate:modelValue":t[18]||(t[18]=l=>w.value=l)},{default:d(()=>[(r(!0),b(S,null,f(m.value.events,l=>(r(),_(v,{key:l.name,value:l.name,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])])]),a("tr",null,[Se,a("td",null,[(r(!0),b(S,null,f(m.value.events,l=>x((r(),b("div",{style:{width:"620px"},key:"script_"+l.name},[o(h(j),{modelValue:l.script,"onUpdate:modelValue":q=>l.script=q,height:"360px"},null,8,["modelValue","onUpdate:modelValue"])])),[[y,w.value==l.name]])),128))])])])]),_:1})]),_:1})}}};export{Fe as default};
