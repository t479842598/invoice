import{u as O}from"./NumMoneyToChinese-d97b4b18.js";import"./__vendor-5e6ac033.js";import{_ as U}from"./index-823f4b27.js";import{ai as f,aT as s,aF as G,bm as A,by as J,c as b,a as e,W as n,bD as l,b9 as i,U as y,bF as X,H as I,bi as Y,aX as d,aY as K,o as _,F as Z,aV as $,P as ee,aP as te,aM as oe}from"./_@vue-5ba92de9.js";import"./_@element-plus-ad4c9002.js";import"./_crypto-js-0812dcff.js";import"./_element-plus-8c7ce171.js";import"./_@popperjs-c75af06c.js";import"./_pdfjs-dist-c04561eb.js";import"./_@microsoft-43c4e133.js";import"./_vue-codemirror-50da885a.js";const u=c=>(te("data-v-bfa3e2ce"),c=c(),oe(),c),ae={class:"main-page"},ie={class:"top"},le={style:{position:"absolute",left:"0px",top:"0"}},se={class:"image-slot"},ne={class:"top-div"},re={key:0,style:{"font-size":"28px"}},de={key:1,style:{"font-size":"28px"}},ce=u(()=>e("div",{style:{border:"1.1px solid #AD7353","margin-top":"8px"}},null,-1)),pe=u(()=>e("div",{style:{border:"1.1px solid #AD7353","margin-top":"3px"}},null,-1)),ge={class:"top-div-1"},_e={class:"top-title"},ue={class:"top-title"},he={border:"1",cellpadding:"1",cellspacing:"1",style:{"line-height":"50px","border-color":"#AD7353","border-width":"1.3px",color:"#AD7353",width:"100%","margin-bottom":"0","font-family":"'STSong'","font-weight":"600"},class:"table maintable"},me={style:{height:"80px !important"}},fe=u(()=>e("td",{class:"vertical-text",style:{"font-weight":"bolder",width:"30px !important"}}," 购买方信息",-1)),xe={colspan:"3",width:"257",style:{padding:"15px 10px 0px 10px"}},ve={style:{"font-size":"12px",color:"#585859"}},be={style:{"font-size":"12px",color:"#585859"}},ye=u(()=>e("td",{class:"vertical-text",style:{"font-weight":"bolder",width:"30px !important"}}," 销售方信息",-1)),we={colspan:"3",width:"243",style:{padding:"15px 10px 0px 10px"}},Te={style:{"font-size":"12px",color:"#585859"}},Ne={style:{"font-size":"12px",color:"#585859"}},Se={border:"",style:{width:"100%",height:"30px","font-family":"'STSong'","font-weight":"600",border:"0px solid #AD7353 !important","border-spacing":"0","border-top":"0px",color:"#AD7353"}},Pe=u(()=>e("td",{style:{width:"30%","text-align":"center","font-family":"'STSong'","font-weight":"600","font-size":"12px"}}," 价税合计（大写） ",-1)),De={style:{"font-family":"'STSong'","font-weight":"600",display:"flex","align-items":"center","justify-content":"space-between","min-width":"400px"}},Ae={style:{width:"calc(100% - 200px)","text-align":"left",height:"30px","font-size":"14px",color:"#585859","line-height":"30px","margin-left":"30px"}},Ie={style:{"line-height":"30px","margin-right":"50px"}},ze={style:{"font-size":"14px",color:"#585859"}},Fe={border:"",style:{width:"100%",height:"160px","font-family":"'STSong'","font-weight":"600",border:"0px solid #AD7353 !important","border-spacing":"0","border-top":"0px",color:"#AD7353","font-size":"12px"}},Ce=u(()=>e("td",{style:{width:"30px","writing-mode":"vertical-rl","vertical-align":"middle","text-align":"center"}},"备注",-1)),ke={style:{padding:"12px","vertical-align":"top"}},Re={style:{"font-size":"12px",color:"#585859"}},Me={__name:"viewPage",props:{id:{},idModifiers:{},type:{},typeModifiers:{}},emits:["update:id","update:type"],setup(c,{expose:z}){const F=f("ajax"),C=f("utils"),k=f("qs");f("config"),f("index_refreshtab");const S=s({prop:"goodsLineNo",order:"ascending"}),P=s(C.getPager(S.value));s(!1);const w=s(!1),R=s([]),M=s("");localStorage.getItem("sobInfo")!=""&&(M.value=JSON.parse(localStorage.getItem("sobInfo"))),G(()=>{V()});const j=A(c,"id"),T=A(c,"type"),t=s({}),B=s([{prop:"goodsName",label:"项目名称",align:"left",width:"200"},{prop:"goodsSpecification",label:"规格型号",align:"left",width:"150"},{prop:"goodsUnit",label:"单位",align:"center"},{prop:"goodsQuantity",label:"数量",align:"right"},{prop:"goodsPrice",label:"单价",align:"right"},{prop:"notaxamount",label:"金额",align:"right"},{prop:"goodsTaxRate",label:"税率/征收率",align:"center"},{prop:"goodsTotalTax",label:"税额",align:"right",width:"110"}]);function Q(){}const V=async()=>{w.value=!0;try{const o=await F.post("/Invoice/Get",k.stringify({ids:j.value}));Array.isArray(o.data.invoicemain)&&o.data.invoicemain.length>0&&(t.value=o.data.invoicemain[0]),Array.isArray(o.data.invoicedetails)&&o.data.invoicedetails.length>0&&(N.value=o.data.invoicedetails)}catch{}finally{w.value=!1}},W=o=>{R.value=o},N=s([]);function D({row:o,column:x,rowIndex:h,columnIndex:m}){return{color:"#AD7353",fontFamily:"STSong",textAlign:"center",fontWeight:600,height:"30px",fontSize:"14px",padding:"0"}}J(()=>N.value,o=>{let x=0,h=0,m=0;o.forEach(a=>{if(x+=Number(a.goodsTotalPrice),h+=Number(a.goodsTotalTax),a.goodsQuantity==""||a.goodsQuantity==null)a.goodsPrice=0;else{let v=(Number(a.goodsTotalPrice)/Number(a.goodsQuantity)).toFixed(8);a.goodsPrice=isNaN(v)?0:v}const p=1+Number(a.goodsTaxRate/100);var g=(Number(a.goodsTotalPrice)/Number(p)).toFixed(2);a.goodsTotalTax=(Number(a.goodsTotalPrice)-g).toFixed(2),a.notaxamount=Number(g),m+=Number(g)}),t.value.invoiceTotalPriceTax=Number(x.toFixed(2)),t.value.invoiceTotalTax=Number(h.toFixed(2)),t.value.invoiceTotalPrice=Number(m.toFixed(2))},{deep:!0});function q({row:o}){if(o.goodsTotalPrice===0)return{backgroundColor:"yellow"}}return z({open:Q,headerCellStyle:D}),(o,x)=>{const h=d("Picture"),m=d("el-icon"),a=d("el-image"),p=d("el-form-item"),g=d("el-form"),v=d("el-table-column"),E=d("el-table"),H=K("loading");return _(),b("div",ae,[e("div",ie,[e("div",le,[n(a,{style:{width:"120px",height:"120px"},src:t.value.base64Image,fit:"scale-down"},{error:l(()=>[e("div",se,[n(m,null,{default:l(()=>[n(h)]),_:1})])]),_:1},8,["src"])]),e("div",ne,[T.value=="普通发票"||T.value=="专用发票"?(_(),b("div",re,"电子发票（"+i(T.value)+"）",1)):(_(),b("div",de,"电子发票（普通发票）")),ce,pe]),e("div",ge,[e("div",_e,[y("发票号码："),e("span",null,i(t.value.invoiceNo),1)]),e("div",ue,[y("开票日期："),e("span",null,i(t.value.invoiceDate),1)])])]),e("table",he,[e("tbody",null,[e("tr",me,[fe,e("td",xe,[n(g,{model:t.value},{default:l(()=>[n(p,{label:"名称:",style:{position:"relative"}},{default:l(()=>[e("span",ve,i(t.value.buyerName),1)]),_:1}),n(p,{label:"统一社会信用代码/纳税人识别:"},{default:l(()=>[e("span",be,i(t.value.buyerTaxNo),1)]),_:1})]),_:1},8,["model"])]),ye,e("td",we,[n(g,{model:t.value,ref:"ruleFormRef"},{default:l(()=>[n(p,{label:"名称:"},{default:l(()=>[e("span",Te,i(t.value.sellerName),1)]),_:1}),n(p,{label:"统一社会信用代码/纳税人识别:"},{default:l(()=>[e("span",Ne,i(t.value.sellerTaxNo),1)]),_:1})]),_:1},8,["model"])])])])]),X((_(),I(E,{class:"eltable show_table",data:N.value,size:"small",stripe:P.value.tableStripe,"highlight-current-row":P.value.tableHighlightCurrentRow,style:{width:"100%",color:"#000"},"header-cell-style":D,"default-sort":S.value,onSelectionChange:W,"row-style":q},{default:l(()=>[(_(!0),b(Z,null,$(B.value,r=>(_(),I(v,{prop:r.prop,fit:"","show-overflow-tooltip":"","min-width":r.minWidth,label:r.label,align:r.align,width:r.width},ee({_:2},[r.prop==="goodsTaxRate"?{name:"default",fn:l(L=>[y(i(L.row[r.prop])+"%",1)]),key:"0"}:void 0]),1032,["prop","min-width","label","align","width"]))),256))]),_:1},8,["data","stripe","highlight-current-row","default-sort"])),[[H,w.value]]),e("table",Se,[e("tr",null,[Pe,e("td",De,[e("div",Ae,i(Y(O)(t.value.invoiceTotalPriceTax)),1),e("div",Ie,[y(" (小写) "),e("span",ze,"￥"+i(t.value.invoiceTotalPriceTax),1)])])])]),e("table",Fe,[e("tr",null,[Ce,e("td",ke,[e("span",Re,i(t.value.remarks),1)])])])])}}},Ge=U(Me,[["__scopeId","data-v-bfa3e2ce"]]);export{Ge as default};
