import{p as H,_ as te}from"./_splitpanes-c98d9122.js";import le from"./organize-9caca561.js";import oe from"./user-c44ea212.js";import ne from"./workgroup-fec90b9b.js";import ie from"./setmenu-40e42702.js";import de from"./showmenu-ae8d740d.js";import{ai as $,aT as s,b5 as se,H as f,bD as n,bi as b,aN as T,aX as r,o as d,W as l,a as w,c as m,U as N,I as x,b9 as z,aZ as re}from"./_@vue-5ba92de9.js";import"./_vuedraggable-a473ce37.js";import"./__vendor-5e6ac033.js";import"./sign-893b3743.js";const ue={key:0},ce={key:1},pe={class:"roadui_treenode"},fe={key:3,class:"roadui_note",style:{"margin-left":"3px"}},_e={key:4,class:"roadui_note",style:{"margin-left":"3px"}},me={class:"roadui_treenode"},ge={key:3,class:"roadui_note",style:{"margin-left":"3px"}},he={key:4,class:"roadui_note",style:{"margin-left":"3px"}},ve={key:1},Ie={__name:"index",setup(ye){const g=$("ajax"),i=$("utils"),D=$("qs"),R=s("");localStorage.getItem("sobInfo")!=""&&(R.value=JSON.parse(localStorage.getItem("sobInfo")));const c=se(null),_=s("");s(!1);const V=s(null),L=s([]),h=s(""),u=s(!1),C=s([]),B={children:"children",label:"title",isLeaf:"isLeaf"},v=s("0"),G=(e,a)=>{if(e.level===0||u.value)g.post("/Organize/GetTree?srcorgid="+R.value.id,D.stringify({selecttype:"unit,dept,station,user,workgroup",keyword:h.value})).then(t=>{if(u.value&&i.length(h.value)>0){const k={id:i.emptyLong+"",parentId:"0",title:t.data.length===0?"未搜索到与“"+h.value+"”相关的结果":"搜索“"+h.value+"”的结果",type:"-1",checkable:!1,disableCheckbox:!0,selectable:!1,isLeaf:t.data.length===0,children:t.data};L.value=[k],u.value=!1,C.value=[i.emptyLong+""]}else L.value=t.data,u.value=!1,t.data.length>0&&(C.value=[t.data[0].id])}).catch(()=>{});else{if(i.isUndef(e.data))return;if(i.length(e.data.children)>0){a(e.data.children);return}g.post("/Organize/GetTreeChilds?parentid="+e.data.id).then(t=>{a(t.data)}).catch(()=>{})}},J=(e,a)=>{i.length(e)!==0&&g.post("/Organize/GetTreeChilds?parentid="+e).then(t=>{V.value.updateKeyChildren(e,t.data),i.length(a)>0&&C.value.push(a)}).catch(()=>{})},K=e=>{O(e,"")},Q=e=>V.value.getNode(e),O=(e,a)=>{switch(e.type+""){case"-1":c.value=null,_.value=a;break;case"-2":c.value=de,_.value=a;break;case"0":c.value=ie,_.value=a;break;case"1":case"2":case"3":c.value=le,_.value=i.length(a)===0?"?organizeid="+e.id+"&organizetype="+e.type:a;break;case"4":case"5":c.value=oe,_.value=i.length(a)===0?"?userid="+e.id+"&organizeid="+e.parentId+"&organizetype="+e.type:a;break;case"6":c.value=ne,_.value=i.length(a)===0?"?workgroupid="+e.id:a;break}},X=e=>{v.value=e.index},y=s(""),S=s(null),I=s([]),W=s([]),U=(e,a)=>{if(e.level===0||u.value)g.post("/Workgroup/GetTree",D.stringify({selecttype:"unit,dept,station,user,workgroup",keyword:y.value})).then(t=>{if(u.value&&i.length(y.value)>0){const k={id:i.emptyLong+"",parentId:"0",title:t.data.length===0?"未搜索到与“"+y.value+"”相关的结果":"搜索“"+y.value+"”的结果",type:"-1",checkable:!1,disableCheckbox:!0,selectable:!1,isLeaf:t.data.length===0,children:t.data};I.value=[k],u.value=!1,W.value=[i.emptyLong+""]}else I.value=t.data,u.value=!1,t.data.length>0&&(W.value=[t.data[0].id])}).catch(()=>{});else{if(i.isUndef(e.data))return;if(i.length(e.data.children)>0){a(e.data.children);return}g.post("/Workgroup/GetChildTree?workgroupid="+e.data.id).then(t=>{a(t.data)}).catch(()=>{})}},Z=e=>{g.post("/Workgroup/GetChildTree?workgroupid="+e).then(a=>{S.value.updateKeyChildren(e,a.data)}).catch(()=>{})};return T("openPage",O),T("updateTreeNode",J),T("updateWgTreeNode",Z),T("getTreeNode",Q),T("showType",v),(e,a)=>{const t=r("el-input"),k=r("el-button"),A=r("OfficeBuilding"),p=r("el-icon"),M=r("folder"),P=r("user"),Y=r("document"),j=r("el-tree"),E=r("el-tab-pane"),q=r("Collection"),F=r("Folder"),ee=r("el-tabs"),ae=r("el-empty");return d(),f(b(te),{class:"default-theme",style:{height:"inherit"}},{default:n(()=>[l(b(H),{size:28,"min-size":"28","max-size":"50",style:{overflow:"auto",background:"#fff"}},{default:n(()=>[w("div",null,[v.value==0?(d(),m("div",ue,[l(t,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o),clearable:"",style:{width:"200px","margin-right":"12px","vertical-align":"middle"},placeholder:"输入关键字搜索"},null,8,["modelValue"]),l(k,{type:"primary",style:{"vertical-align":"middle"},onClick:a[1]||(a[1]=o=>{u.value=!0,G({level:0})})},{default:n(()=>[N("搜索")]),_:1})])):x("",!0),v.value==1?(d(),m("div",ce,[l(t,{modelValue:y.value,"onUpdate:modelValue":a[2]||(a[2]=o=>y.value=o),clearable:"",style:{width:"200px","margin-right":"12px","vertical-align":"middle"},placeholder:"输入关键字搜索"},null,8,["modelValue"]),l(k,{type:"primary",style:{"vertical-align":"middle"},onClick:a[3]||(a[3]=o=>{u.value=!0,U({level:0})})},{default:n(()=>[N("搜索")]),_:1})])):x("",!0)]),l(ee,{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=o=>v.value=o),onTabClick:X,style:{height:"calc(100% - 45px)"}},{default:n(()=>[l(E,{label:"组织架构",name:"0",style:{height:"100%"}},{label:n(()=>[l(p,{class:"roadui_main_tabsvg"},{default:n(()=>[l(A)]),_:1}),N("组织架构 ")]),default:n(()=>[l(j,{data:L.value,props:B,"node-key":"id",load:G,lazy:"",ref_key:"orgTreeRef",ref:V,"highlight-current":"","default-expanded-keys":C.value,style:{"padding-right":"14px",height:"100%",overflow:"auto"},"expand-on-click-node":!1,onNodeClick:K},{default:n(o=>[w("div",pe,[o.node.isLeaf?o.data.type===4||o.data.type===5?(d(),f(p,{key:1,class:"roadui_main_tabico"},{default:n(()=>[l(P)]),_:1})):(d(),f(p,{key:2,class:"roadui_main_tabico"},{default:n(()=>[l(Y)]),_:1})):(d(),f(p,{key:0,class:"roadui_main_tabico"},{default:n(()=>[l(M)]),_:1})),w("span",null,z(o.node.label),1),o.data.status===1?(d(),m("span",fe,"[冻结]")):x("",!0),o.data.type===5?(d(),m("span",_e,z(b(i).replaceWildcard("{<partTime>}")),1)):x("",!0)])]),_:1},8,["data","default-expanded-keys"])]),_:1}),l(E,{label:"工作组",name:"1",style:{height:"100%"}},{label:n(()=>[l(p,{class:"roadui_main_tabsvg"},{default:n(()=>[l(q)]),_:1}),N("工作组 ")]),default:n(()=>[l(j,{data:I.value,props:B,"node-key":"id",load:U,lazy:"",ref_key:"wgTreeRef",ref:S,"highlight-current":"","default-expanded-keys":W.value,style:{"padding-right":"14px",height:"100%",overflow:"auto"},"expand-on-click-node":!1,onNodeClick:K},{default:n(o=>[w("div",me,[o.node.isLeaf?o.data.type===4||o.data.type===5?(d(),f(p,{key:1,class:"roadui_main_tabico"},{default:n(()=>[l(P)]),_:1})):(d(),f(p,{key:2,class:"roadui_main_tabico"},{default:n(()=>[l(F)]),_:1})):(d(),f(p,{key:0,class:"roadui_main_tabico"},{default:n(()=>[l(F)]),_:1})),w("span",null,z(o.node.label),1),o.data.status===1?(d(),m("span",ge,"[冻结]")):x("",!0),o.data.type===5?(d(),m("span",he,z(b(i).replaceWildcard("{<partTime>}")),1)):x("",!0)])]),_:1},8,["data","default-expanded-keys"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(b(H),{size:72,style:{background:"#fff",overflow:"auto","padding-left":"5px"}},{default:n(()=>[b(i).isDef(c.value)?(d(),f(re(c.value),{key:0,query:_.value},null,8,["query"])):(d(),m("div",ve,[l(ae,{description:"请在左边选择要操作的组织"})]))]),_:1})]),_:1})}}};export{Ie as default};
